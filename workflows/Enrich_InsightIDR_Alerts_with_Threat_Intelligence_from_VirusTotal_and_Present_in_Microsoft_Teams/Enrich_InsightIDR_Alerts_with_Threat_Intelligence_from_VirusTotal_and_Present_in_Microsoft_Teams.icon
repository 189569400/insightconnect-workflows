{
  "kom": {
    "komandVersion": "1.101.0-0-g85eb0",
    "komFileVersion": "2.0.0",
    "exportedAt": "2022-04-12T14:48:47.055908644Z",
    "workflowVersions": [
      {
        "name": "Enrich InsightIDR Alerts with Threat Intelligence from VirusTotal and Present in Microsoft Teams",
        "type": "runnable",
        "version": "",
        "description": "# Description\n\nThis workflow enriches indicators of compromise with threat intelligence from VirusTotal using the IDR Alert Trigger and sends information to the Microsoft Teams channel.\n\n# Key Features\n\n* Perform a domain, hash, URL and IP address lookup automatically from any IDR alert\n* Send the report to the Microsoft Teams channel\n\n# Requirements\n\n* InsightIDR License\n* InsightConnect License\n* VirusTotal API Key\n* [Microsoft Teams](https://insightconnect.help.rapid7.com/docs/microsoft-teams)\n\n# Documentation\n\n## Setup\n\nImport the workflow from the Rapid7 Extension Library and proceed through the Import Workflow wizard in InsightConnect. Import plugins, create or select connections, and rename the workflow as a part of the Import Workflow wizard as necessary.\n\nThis workflow leverages InsightConnect's Parameters feature. This feature allows variables used multiple times throughout a workflow to be entered once and then referenced throughout the workflow.\n\nThere are two parameters you will need to configure in order to complete setup of your workflow:\n\n* Team Name: The Microsoft Teams team name in your environment where the workflow should be triggered and respond\n* Channel Name: The Microsoft Teams channel name in your environment where the workflow should be triggered and respond (the channel should exist in the aforementioned team)\n\nTo begin, select \"Parameters\" either from the Workflow Control Panel or from the Builder to begin configuration.\n\nAfter configuring the parameters, activate the workflow and create an alert trigger in InsightIDR by following these steps:\n\n1. Open the Automation tab in InsightIDR\n2. Navigate to the Alert Triggers tab\n3. Click Create Alert Trigger\n4. Select Custom InsightConnect Workflows from the Action Category dropdown menu\n5. Select this workflow\n6. Select one or more alerts\n7. Click Add Alert Trigger\n\n### Usage\n\nThe workflow will run automatically any time the selected alert(s) open a new investigation in InsightIDR. Lookup results for each indicator will be posted on the provided channel.\n\n## Technical Details\n\nPlugins utilized by workflow:\n\n|Plugin|Version|Count|\n|----|----|--------|\n|VirusTotal|8.1.0|4|\n|HashIt|2.0.4|1|\n|Math|1.2.1|4|\n|Microsoft Teams|3.1.5|9|\n\n## Troubleshooting\n\n_There is no troubleshooting information at this time_\n\n# Version History\n\n* 1.0.0 - Initial workflow\n\n# Links\n\n## References\n\n* [VirusTotal](https://virustotal.com)\n* [Microsoft Teams](https://teams.microsoft.com)",
        "graph": {
          "edges": {
            "059803b0-ac6e-42aa-bed2-e8fa2ddf2c60": {
              "id": "059803b0-ac6e-42aa-bed2-e8fa2ddf2c60",
              "name": "",
              "description": "",
              "parentNodeId": "41ab1e00-636e-4702-80b5-4fff15161893",
              "fromNodeId": "e629fe72-b425-480e-8e98-ea481d7438ee",
              "toNodeId": "dc234514-a1c1-449c-8544-13f5b5dcd32a"
            },
            "156320c0-65ed-4045-b8cd-dec203a4d17f": {
              "id": "156320c0-65ed-4045-b8cd-dec203a4d17f",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "6098ca26-515f-4a15-94a3-2b587292d6b4",
              "toNodeId": "0c074692-5c2b-4e44-97cc-43f906525e57"
            },
            "167f0e68-eaeb-4ec1-8225-7d20c530f76d": {
              "id": "167f0e68-eaeb-4ec1-8225-7d20c530f76d",
              "name": "",
              "description": "",
              "parentNodeId": "6098ca26-515f-4a15-94a3-2b587292d6b4",
              "fromNodeId": "e96d520e-38ed-4265-85a3-eede6419ea69",
              "toNodeId": "89137b7a-a8c6-4b33-9d80-ef354cc9973b"
            },
            "168d6d82-3327-4884-b316-c7d1c1bc9f02": {
              "id": "168d6d82-3327-4884-b316-c7d1c1bc9f02",
              "name": "",
              "description": "",
              "parentNodeId": "41ab1e00-636e-4702-80b5-4fff15161893",
              "fromNodeId": "7782ed10-999d-42b3-9348-d9b96099b67a",
              "toNodeId": "aab694b7-7859-42c0-97c6-783c681371b6"
            },
            "1b79ab23-32f1-4ab7-a2e5-6ed855f638d6": {
              "id": "1b79ab23-32f1-4ab7-a2e5-6ed855f638d6",
              "name": "",
              "description": "",
              "parentNodeId": "24ea0051-2329-4d9b-a230-6aed47c9a85b",
              "fromNodeId": "e218194b-b97b-4628-9025-8ffeccec8d63",
              "toNodeId": "36cc3723-5878-4174-9eec-7e04b1885816"
            },
            "223e9c5a-313f-4379-897e-5c6e1c88af75": {
              "id": "223e9c5a-313f-4379-897e-5c6e1c88af75",
              "name": "",
              "description": "",
              "parentNodeId": "7847be03-2237-4036-b118-810ed591bcda",
              "fromNodeId": "e63da188-ac02-40c3-aca0-a98793b094a0",
              "toNodeId": "14326edd-892f-4f04-8e29-a1a1a1d123c6"
            },
            "237f40d2-e748-44f2-8279-420e2148c2bf": {
              "id": "237f40d2-e748-44f2-8279-420e2148c2bf",
              "name": "",
              "description": "",
              "parentNodeId": "0c074692-5c2b-4e44-97cc-43f906525e57",
              "fromNodeId": "41ab1e00-636e-4702-80b5-4fff15161893",
              "toNodeId": ""
            },
            "2b4c22ec-73af-4399-8a23-6048a1e8c97f": {
              "id": "2b4c22ec-73af-4399-8a23-6048a1e8c97f",
              "name": "No",
              "description": "",
              "parentNodeId": "6098ca26-515f-4a15-94a3-2b587292d6b4",
              "fromNodeId": "d37f3dc7-b16f-43ac-872e-33d6d8c354e5",
              "toNodeId": "761abdab-762a-4558-b9f7-7cd42518bebd"
            },
            "2fcc1c0f-3648-4f40-8502-3e7da42b19f4": {
              "id": "2fcc1c0f-3648-4f40-8502-3e7da42b19f4",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "ba8bae4b-ae24-47c9-b635-3ebb9b6a934a",
              "toNodeId": "1ab58d1b-4a47-4373-9168-b213f11268c6"
            },
            "3a78850c-908b-4df9-93ae-7fffb4f96596": {
              "id": "3a78850c-908b-4df9-93ae-7fffb4f96596",
              "name": "",
              "description": "",
              "parentNodeId": "24ea0051-2329-4d9b-a230-6aed47c9a85b",
              "fromNodeId": "36cc3723-5878-4174-9eec-7e04b1885816",
              "toNodeId": "f8a3f205-93c8-4bdb-bbd9-86c9573d0fe6"
            },
            "3c464fa5-2049-402f-b759-1010ba2592f4": {
              "id": "3c464fa5-2049-402f-b759-1010ba2592f4",
              "name": "",
              "description": "",
              "parentNodeId": "24ea0051-2329-4d9b-a230-6aed47c9a85b",
              "fromNodeId": "77e243b3-0fe6-42a4-8181-ed9f2ea6cd2a",
              "toNodeId": "e988c51e-cac0-4670-80b2-0ad9fe7e42ad"
            },
            "40d2f589-a84b-498c-aa21-1552f4429164": {
              "id": "40d2f589-a84b-498c-aa21-1552f4429164",
              "name": "",
              "description": "",
              "parentNodeId": "24ea0051-2329-4d9b-a230-6aed47c9a85b",
              "fromNodeId": "8c4d0f0c-7c1f-49e2-a428-3017029e2327",
              "toNodeId": "ce760c8c-1172-42fb-b721-008c77fb2327"
            },
            "462d94dd-4028-4e72-8eed-243947092a73": {
              "id": "462d94dd-4028-4e72-8eed-243947092a73",
              "name": "",
              "description": "",
              "parentNodeId": "6098ca26-515f-4a15-94a3-2b587292d6b4",
              "fromNodeId": "b9fe9505-1ef2-4855-9887-f548af14fd19",
              "toNodeId": ""
            },
            "4d561572-42ed-4718-8c84-0d6f0814ae3a": {
              "id": "4d561572-42ed-4718-8c84-0d6f0814ae3a",
              "name": "",
              "description": "",
              "parentNodeId": "24ea0051-2329-4d9b-a230-6aed47c9a85b",
              "fromNodeId": "24ea0051-2329-4d9b-a230-6aed47c9a85b",
              "toNodeId": "8c4d0f0c-7c1f-49e2-a428-3017029e2327"
            },
            "54758277-f133-45ec-9259-406a8f906c14": {
              "id": "54758277-f133-45ec-9259-406a8f906c14",
              "name": "No",
              "description": "",
              "parentNodeId": "41ab1e00-636e-4702-80b5-4fff15161893",
              "fromNodeId": "dc234514-a1c1-449c-8544-13f5b5dcd32a",
              "toNodeId": "616f86c5-f811-43d4-80a9-55746f816f63"
            },
            "56386b2a-a62b-4168-be23-39ecbfeed326": {
              "id": "56386b2a-a62b-4168-be23-39ecbfeed326",
              "name": "",
              "description": "",
              "parentNodeId": "41ab1e00-636e-4702-80b5-4fff15161893",
              "fromNodeId": "aab694b7-7859-42c0-97c6-783c681371b6",
              "toNodeId": ""
            },
            "57734d40-4fd1-45ff-a86e-bab602c7a4e9": {
              "id": "57734d40-4fd1-45ff-a86e-bab602c7a4e9",
              "name": "",
              "description": "",
              "parentNodeId": "6098ca26-515f-4a15-94a3-2b587292d6b4",
              "fromNodeId": "6098ca26-515f-4a15-94a3-2b587292d6b4",
              "toNodeId": "08fd10ab-d304-4b0c-9611-6427bc595c9a"
            },
            "5c36bc3d-2cec-4ff6-ac68-335ce045b2ce": {
              "id": "5c36bc3d-2cec-4ff6-ac68-335ce045b2ce",
              "name": "No",
              "description": "",
              "parentNodeId": "24ea0051-2329-4d9b-a230-6aed47c9a85b",
              "fromNodeId": "ce760c8c-1172-42fb-b721-008c77fb2327",
              "toNodeId": "77e243b3-0fe6-42a4-8181-ed9f2ea6cd2a"
            },
            "5cd96d52-afe8-48c7-8999-5e4c84919153": {
              "id": "5cd96d52-afe8-48c7-8999-5e4c84919153",
              "name": "Yes",
              "description": "",
              "parentNodeId": "6098ca26-515f-4a15-94a3-2b587292d6b4",
              "fromNodeId": "d37f3dc7-b16f-43ac-872e-33d6d8c354e5",
              "toNodeId": "6542b420-735c-4fa4-ae53-872c46e983fb"
            },
            "603ff529-96ad-40dd-a0a4-c32b8b8073a2": {
              "id": "603ff529-96ad-40dd-a0a4-c32b8b8073a2",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "126c83e4-bdf1-40ba-9980-279e2174cc3d",
              "toNodeId": "7847be03-2237-4036-b118-810ed591bcda"
            },
            "67941f3a-e99c-4568-9696-efcacfe829bc": {
              "id": "67941f3a-e99c-4568-9696-efcacfe829bc",
              "name": "No",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "1ab58d1b-4a47-4373-9168-b213f11268c6",
              "toNodeId": "8c8e5c9a-c89b-427e-81ce-1618320d87ce"
            },
            "6ee5e176-f972-44ae-9a2e-c87bd47f483c": {
              "id": "6ee5e176-f972-44ae-9a2e-c87bd47f483c",
              "name": "",
              "description": "",
              "parentNodeId": "6098ca26-515f-4a15-94a3-2b587292d6b4",
              "fromNodeId": "6542b420-735c-4fa4-ae53-872c46e983fb",
              "toNodeId": "e96d520e-38ed-4265-85a3-eede6419ea69"
            },
            "78305728-b283-4edf-bdb7-7da4080edf4e": {
              "id": "78305728-b283-4edf-bdb7-7da4080edf4e",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "0c074692-5c2b-4e44-97cc-43f906525e57",
              "toNodeId": "24ea0051-2329-4d9b-a230-6aed47c9a85b"
            },
            "78953dc8-7262-45e9-81c2-88b6b2f19d60": {
              "id": "78953dc8-7262-45e9-81c2-88b6b2f19d60",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "7847be03-2237-4036-b118-810ed591bcda",
              "toNodeId": "6098ca26-515f-4a15-94a3-2b587292d6b4"
            },
            "8347291e-5a56-468d-8e95-d033fbcf1ee4": {
              "id": "8347291e-5a56-468d-8e95-d033fbcf1ee4",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "f6c5881d-3b2e-4217-b531-80dca5efef74",
              "toNodeId": "126c83e4-bdf1-40ba-9980-279e2174cc3d"
            },
            "896f195a-32dd-49f5-9044-4f4f9e5cbd25": {
              "id": "896f195a-32dd-49f5-9044-4f4f9e5cbd25",
              "name": "",
              "description": "",
              "parentNodeId": "7847be03-2237-4036-b118-810ed591bcda",
              "fromNodeId": "efedb489-0e07-4a9e-99c6-395a7d5f0090",
              "toNodeId": ""
            },
            "89ba2f1a-49b9-45a4-9dce-daa9342c716e": {
              "id": "89ba2f1a-49b9-45a4-9dce-daa9342c716e",
              "name": "",
              "description": "",
              "parentNodeId": "7847be03-2237-4036-b118-810ed591bcda",
              "fromNodeId": "2c4cdbb2-2dd1-4a03-b57a-b6e1dca72790",
              "toNodeId": "efedb489-0e07-4a9e-99c6-395a7d5f0090"
            },
            "8b769f2f-7575-4911-88b8-f76eb1f9e48e": {
              "id": "8b769f2f-7575-4911-88b8-f76eb1f9e48e",
              "name": "",
              "description": "",
              "parentNodeId": "41ab1e00-636e-4702-80b5-4fff15161893",
              "fromNodeId": "153857af-a78a-41bd-a1c2-b08957248379",
              "toNodeId": ""
            },
            "9226e914-a879-4c5d-9869-c381ea1cc26b": {
              "id": "9226e914-a879-4c5d-9869-c381ea1cc26b",
              "name": "",
              "description": "",
              "parentNodeId": "7847be03-2237-4036-b118-810ed591bcda",
              "fromNodeId": "e74274ce-7292-49ce-8e45-cdfa7d4e5752",
              "toNodeId": "0cb21508-40c5-4dc0-bb68-7ef943d61dfd"
            },
            "96c038f9-ce8e-436b-931f-313b8773cf0c": {
              "id": "96c038f9-ce8e-436b-931f-313b8773cf0c",
              "name": "Yes",
              "description": "",
              "parentNodeId": "7847be03-2237-4036-b118-810ed591bcda",
              "fromNodeId": "0cb21508-40c5-4dc0-bb68-7ef943d61dfd",
              "toNodeId": "e63da188-ac02-40c3-aca0-a98793b094a0"
            },
            "9b11e6ea-cae5-4133-92c7-6b462f7b66e1": {
              "id": "9b11e6ea-cae5-4133-92c7-6b462f7b66e1",
              "name": "Yes",
              "description": "",
              "parentNodeId": "24ea0051-2329-4d9b-a230-6aed47c9a85b",
              "fromNodeId": "ce760c8c-1172-42fb-b721-008c77fb2327",
              "toNodeId": "e218194b-b97b-4628-9025-8ffeccec8d63"
            },
            "9caee343-eb49-4584-8ae6-f042e1e43dba": {
              "id": "9caee343-eb49-4584-8ae6-f042e1e43dba",
              "name": "",
              "description": "",
              "parentNodeId": "0c074692-5c2b-4e44-97cc-43f906525e57",
              "fromNodeId": "0c074692-5c2b-4e44-97cc-43f906525e57",
              "toNodeId": "41ab1e00-636e-4702-80b5-4fff15161893"
            },
            "b27e96bd-bc32-426f-b310-12c20b67a6a0": {
              "id": "b27e96bd-bc32-426f-b310-12c20b67a6a0",
              "name": "",
              "description": "",
              "parentNodeId": "7847be03-2237-4036-b118-810ed591bcda",
              "fromNodeId": "14326edd-892f-4f04-8e29-a1a1a1d123c6",
              "toNodeId": "ced04333-2cd7-450d-be1e-9d176c168644"
            },
            "b2fbd4b7-9f99-43ac-8145-f484c854c23b": {
              "id": "b2fbd4b7-9f99-43ac-8145-f484c854c23b",
              "name": "No",
              "description": "",
              "parentNodeId": "7847be03-2237-4036-b118-810ed591bcda",
              "fromNodeId": "0cb21508-40c5-4dc0-bb68-7ef943d61dfd",
              "toNodeId": "2c4cdbb2-2dd1-4a03-b57a-b6e1dca72790"
            },
            "bc0aa5bf-5930-4d63-a607-4c43f0e30c09": {
              "id": "bc0aa5bf-5930-4d63-a607-4c43f0e30c09",
              "name": "",
              "description": "",
              "parentNodeId": "24ea0051-2329-4d9b-a230-6aed47c9a85b",
              "fromNodeId": "e988c51e-cac0-4670-80b2-0ad9fe7e42ad",
              "toNodeId": ""
            },
            "bf202912-aadb-40b5-afd1-f16af7282757": {
              "id": "bf202912-aadb-40b5-afd1-f16af7282757",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "8c8e5c9a-c89b-427e-81ce-1618320d87ce",
              "toNodeId": ""
            },
            "bf906141-b932-45ff-baea-8f0a98a81abe": {
              "id": "bf906141-b932-45ff-baea-8f0a98a81abe",
              "name": "",
              "description": "",
              "parentNodeId": "24ea0051-2329-4d9b-a230-6aed47c9a85b",
              "fromNodeId": "13ba3e21-ea09-4dfd-b385-e2edfe0684e9",
              "toNodeId": ""
            },
            "c506b26f-b99a-493f-a44a-7f97cb175e3a": {
              "id": "c506b26f-b99a-493f-a44a-7f97cb175e3a",
              "name": "",
              "description": "",
              "parentNodeId": "24ea0051-2329-4d9b-a230-6aed47c9a85b",
              "fromNodeId": "f8a3f205-93c8-4bdb-bbd9-86c9573d0fe6",
              "toNodeId": "13ba3e21-ea09-4dfd-b385-e2edfe0684e9"
            },
            "c65d9509-2b66-43d4-a9f6-d908061abe0a": {
              "id": "c65d9509-2b66-43d4-a9f6-d908061abe0a",
              "name": "Yes",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "1ab58d1b-4a47-4373-9168-b213f11268c6",
              "toNodeId": "f6c5881d-3b2e-4217-b531-80dca5efef74"
            },
            "c741c60c-1d87-4ccf-bbeb-bd3b699d23eb": {
              "id": "c741c60c-1d87-4ccf-bbeb-bd3b699d23eb",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "24ea0051-2329-4d9b-a230-6aed47c9a85b",
              "toNodeId": ""
            },
            "cdbb2e40-0ff7-4139-b551-6b95d59f1ea1": {
              "id": "cdbb2e40-0ff7-4139-b551-6b95d59f1ea1",
              "name": "",
              "description": "",
              "parentNodeId": "7847be03-2237-4036-b118-810ed591bcda",
              "fromNodeId": "7847be03-2237-4036-b118-810ed591bcda",
              "toNodeId": "e74274ce-7292-49ce-8e45-cdfa7d4e5752"
            },
            "cdfd55af-a982-4cad-8cf0-e6355fa2505c": {
              "id": "cdfd55af-a982-4cad-8cf0-e6355fa2505c",
              "name": "Yes",
              "description": "",
              "parentNodeId": "41ab1e00-636e-4702-80b5-4fff15161893",
              "fromNodeId": "dc234514-a1c1-449c-8544-13f5b5dcd32a",
              "toNodeId": "1f893118-34f1-4147-9297-16da8aec11c2"
            },
            "d4049510-f202-4390-aea9-b36f978d6eec": {
              "id": "d4049510-f202-4390-aea9-b36f978d6eec",
              "name": "",
              "description": "",
              "parentNodeId": "6098ca26-515f-4a15-94a3-2b587292d6b4",
              "fromNodeId": "89137b7a-a8c6-4b33-9d80-ef354cc9973b",
              "toNodeId": ""
            },
            "e0b3d9e0-5fb6-4f3b-9e65-5e34c7ffbc7d": {
              "id": "e0b3d9e0-5fb6-4f3b-9e65-5e34c7ffbc7d",
              "name": "",
              "description": "",
              "parentNodeId": "41ab1e00-636e-4702-80b5-4fff15161893",
              "fromNodeId": "1f893118-34f1-4147-9297-16da8aec11c2",
              "toNodeId": "7782ed10-999d-42b3-9348-d9b96099b67a"
            },
            "e2769cb3-88e9-473a-a775-672ad5ac7ebd": {
              "id": "e2769cb3-88e9-473a-a775-672ad5ac7ebd",
              "name": "",
              "description": "",
              "parentNodeId": "7847be03-2237-4036-b118-810ed591bcda",
              "fromNodeId": "ced04333-2cd7-450d-be1e-9d176c168644",
              "toNodeId": ""
            },
            "e65893c3-a290-4edd-8ed3-3c4f8ab37ea5": {
              "id": "e65893c3-a290-4edd-8ed3-3c4f8ab37ea5",
              "name": "",
              "description": "",
              "parentNodeId": "41ab1e00-636e-4702-80b5-4fff15161893",
              "fromNodeId": "616f86c5-f811-43d4-80a9-55746f816f63",
              "toNodeId": "153857af-a78a-41bd-a1c2-b08957248379"
            },
            "e9e803c9-0fdb-46d9-ab30-5d0b277a1f94": {
              "id": "e9e803c9-0fdb-46d9-ab30-5d0b277a1f94",
              "name": "",
              "description": "",
              "parentNodeId": "41ab1e00-636e-4702-80b5-4fff15161893",
              "fromNodeId": "41ab1e00-636e-4702-80b5-4fff15161893",
              "toNodeId": "e629fe72-b425-480e-8e98-ea481d7438ee"
            },
            "eb7a02cd-01fc-466e-b7cb-8a112d78fd7f": {
              "id": "eb7a02cd-01fc-466e-b7cb-8a112d78fd7f",
              "name": "",
              "description": "",
              "parentNodeId": "6098ca26-515f-4a15-94a3-2b587292d6b4",
              "fromNodeId": "761abdab-762a-4558-b9f7-7cd42518bebd",
              "toNodeId": "b9fe9505-1ef2-4855-9887-f548af14fd19"
            },
            "fd9b182f-bef7-4c6d-8ccf-a3200eb534c2": {
              "id": "fd9b182f-bef7-4c6d-8ccf-a3200eb534c2",
              "name": "",
              "description": "",
              "parentNodeId": "6098ca26-515f-4a15-94a3-2b587292d6b4",
              "fromNodeId": "08fd10ab-d304-4b0c-9611-6427bc595c9a",
              "toNodeId": "d37f3dc7-b16f-43ac-872e-33d6d8c354e5"
            }
          },
          "nodes": {
            "08fd10ab-d304-4b0c-9611-6427bc595c9a": {
              "id": "08fd10ab-d304-4b0c-9611-6427bc595c9a",
              "parentNodeId": "6098ca26-515f-4a15-94a3-2b587292d6b4"
            },
            "0c074692-5c2b-4e44-97cc-43f906525e57": {
              "id": "0c074692-5c2b-4e44-97cc-43f906525e57",
              "parentNodeId": ""
            },
            "0cb21508-40c5-4dc0-bb68-7ef943d61dfd": {
              "id": "0cb21508-40c5-4dc0-bb68-7ef943d61dfd",
              "parentNodeId": "7847be03-2237-4036-b118-810ed591bcda"
            },
            "126c83e4-bdf1-40ba-9980-279e2174cc3d": {
              "id": "126c83e4-bdf1-40ba-9980-279e2174cc3d",
              "parentNodeId": ""
            },
            "13ba3e21-ea09-4dfd-b385-e2edfe0684e9": {
              "id": "13ba3e21-ea09-4dfd-b385-e2edfe0684e9",
              "parentNodeId": "24ea0051-2329-4d9b-a230-6aed47c9a85b"
            },
            "14326edd-892f-4f04-8e29-a1a1a1d123c6": {
              "id": "14326edd-892f-4f04-8e29-a1a1a1d123c6",
              "parentNodeId": "7847be03-2237-4036-b118-810ed591bcda"
            },
            "153857af-a78a-41bd-a1c2-b08957248379": {
              "id": "153857af-a78a-41bd-a1c2-b08957248379",
              "parentNodeId": "41ab1e00-636e-4702-80b5-4fff15161893"
            },
            "1ab58d1b-4a47-4373-9168-b213f11268c6": {
              "id": "1ab58d1b-4a47-4373-9168-b213f11268c6",
              "parentNodeId": ""
            },
            "1f893118-34f1-4147-9297-16da8aec11c2": {
              "id": "1f893118-34f1-4147-9297-16da8aec11c2",
              "parentNodeId": "41ab1e00-636e-4702-80b5-4fff15161893"
            },
            "24ea0051-2329-4d9b-a230-6aed47c9a85b": {
              "id": "24ea0051-2329-4d9b-a230-6aed47c9a85b",
              "parentNodeId": ""
            },
            "2c4cdbb2-2dd1-4a03-b57a-b6e1dca72790": {
              "id": "2c4cdbb2-2dd1-4a03-b57a-b6e1dca72790",
              "parentNodeId": "7847be03-2237-4036-b118-810ed591bcda"
            },
            "36cc3723-5878-4174-9eec-7e04b1885816": {
              "id": "36cc3723-5878-4174-9eec-7e04b1885816",
              "parentNodeId": "24ea0051-2329-4d9b-a230-6aed47c9a85b"
            },
            "41ab1e00-636e-4702-80b5-4fff15161893": {
              "id": "41ab1e00-636e-4702-80b5-4fff15161893",
              "parentNodeId": "0c074692-5c2b-4e44-97cc-43f906525e57"
            },
            "6098ca26-515f-4a15-94a3-2b587292d6b4": {
              "id": "6098ca26-515f-4a15-94a3-2b587292d6b4",
              "parentNodeId": ""
            },
            "616f86c5-f811-43d4-80a9-55746f816f63": {
              "id": "616f86c5-f811-43d4-80a9-55746f816f63",
              "parentNodeId": "41ab1e00-636e-4702-80b5-4fff15161893"
            },
            "6542b420-735c-4fa4-ae53-872c46e983fb": {
              "id": "6542b420-735c-4fa4-ae53-872c46e983fb",
              "parentNodeId": "6098ca26-515f-4a15-94a3-2b587292d6b4"
            },
            "761abdab-762a-4558-b9f7-7cd42518bebd": {
              "id": "761abdab-762a-4558-b9f7-7cd42518bebd",
              "parentNodeId": "6098ca26-515f-4a15-94a3-2b587292d6b4"
            },
            "7782ed10-999d-42b3-9348-d9b96099b67a": {
              "id": "7782ed10-999d-42b3-9348-d9b96099b67a",
              "parentNodeId": "41ab1e00-636e-4702-80b5-4fff15161893"
            },
            "77e243b3-0fe6-42a4-8181-ed9f2ea6cd2a": {
              "id": "77e243b3-0fe6-42a4-8181-ed9f2ea6cd2a",
              "parentNodeId": "24ea0051-2329-4d9b-a230-6aed47c9a85b"
            },
            "7847be03-2237-4036-b118-810ed591bcda": {
              "id": "7847be03-2237-4036-b118-810ed591bcda",
              "parentNodeId": ""
            },
            "89137b7a-a8c6-4b33-9d80-ef354cc9973b": {
              "id": "89137b7a-a8c6-4b33-9d80-ef354cc9973b",
              "parentNodeId": "6098ca26-515f-4a15-94a3-2b587292d6b4"
            },
            "8c4d0f0c-7c1f-49e2-a428-3017029e2327": {
              "id": "8c4d0f0c-7c1f-49e2-a428-3017029e2327",
              "parentNodeId": "24ea0051-2329-4d9b-a230-6aed47c9a85b"
            },
            "8c8e5c9a-c89b-427e-81ce-1618320d87ce": {
              "id": "8c8e5c9a-c89b-427e-81ce-1618320d87ce",
              "parentNodeId": ""
            },
            "aab694b7-7859-42c0-97c6-783c681371b6": {
              "id": "aab694b7-7859-42c0-97c6-783c681371b6",
              "parentNodeId": "41ab1e00-636e-4702-80b5-4fff15161893"
            },
            "b9fe9505-1ef2-4855-9887-f548af14fd19": {
              "id": "b9fe9505-1ef2-4855-9887-f548af14fd19",
              "parentNodeId": "6098ca26-515f-4a15-94a3-2b587292d6b4"
            },
            "ba8bae4b-ae24-47c9-b635-3ebb9b6a934a": {
              "id": "ba8bae4b-ae24-47c9-b635-3ebb9b6a934a",
              "parentNodeId": ""
            },
            "ce760c8c-1172-42fb-b721-008c77fb2327": {
              "id": "ce760c8c-1172-42fb-b721-008c77fb2327",
              "parentNodeId": "24ea0051-2329-4d9b-a230-6aed47c9a85b"
            },
            "ced04333-2cd7-450d-be1e-9d176c168644": {
              "id": "ced04333-2cd7-450d-be1e-9d176c168644",
              "parentNodeId": "7847be03-2237-4036-b118-810ed591bcda"
            },
            "d37f3dc7-b16f-43ac-872e-33d6d8c354e5": {
              "id": "d37f3dc7-b16f-43ac-872e-33d6d8c354e5",
              "parentNodeId": "6098ca26-515f-4a15-94a3-2b587292d6b4"
            },
            "dc234514-a1c1-449c-8544-13f5b5dcd32a": {
              "id": "dc234514-a1c1-449c-8544-13f5b5dcd32a",
              "parentNodeId": "41ab1e00-636e-4702-80b5-4fff15161893"
            },
            "e218194b-b97b-4628-9025-8ffeccec8d63": {
              "id": "e218194b-b97b-4628-9025-8ffeccec8d63",
              "parentNodeId": "24ea0051-2329-4d9b-a230-6aed47c9a85b"
            },
            "e629fe72-b425-480e-8e98-ea481d7438ee": {
              "id": "e629fe72-b425-480e-8e98-ea481d7438ee",
              "parentNodeId": "41ab1e00-636e-4702-80b5-4fff15161893"
            },
            "e63da188-ac02-40c3-aca0-a98793b094a0": {
              "id": "e63da188-ac02-40c3-aca0-a98793b094a0",
              "parentNodeId": "7847be03-2237-4036-b118-810ed591bcda"
            },
            "e74274ce-7292-49ce-8e45-cdfa7d4e5752": {
              "id": "e74274ce-7292-49ce-8e45-cdfa7d4e5752",
              "parentNodeId": "7847be03-2237-4036-b118-810ed591bcda"
            },
            "e96d520e-38ed-4265-85a3-eede6419ea69": {
              "id": "e96d520e-38ed-4265-85a3-eede6419ea69",
              "parentNodeId": "6098ca26-515f-4a15-94a3-2b587292d6b4"
            },
            "e988c51e-cac0-4670-80b2-0ad9fe7e42ad": {
              "id": "e988c51e-cac0-4670-80b2-0ad9fe7e42ad",
              "parentNodeId": "24ea0051-2329-4d9b-a230-6aed47c9a85b"
            },
            "efedb489-0e07-4a9e-99c6-395a7d5f0090": {
              "id": "efedb489-0e07-4a9e-99c6-395a7d5f0090",
              "parentNodeId": "7847be03-2237-4036-b118-810ed591bcda"
            },
            "f6c5881d-3b2e-4217-b531-80dca5efef74": {
              "id": "f6c5881d-3b2e-4217-b531-80dca5efef74",
              "parentNodeId": ""
            },
            "f8a3f205-93c8-4bdb-bbd9-86c9573d0fe6": {
              "id": "f8a3f205-93c8-4bdb-bbd9-86c9573d0fe6",
              "parentNodeId": "24ea0051-2329-4d9b-a230-6aed47c9a85b"
            }
          }
        },
        "steps": {
          "08fd10ab-d304-4b0c-9611-6427bc595c9a": {
            "nodeId": "08fd10ab-d304-4b0c-9611-6427bc595c9a",
            "name": "Lookup IP",
            "type": "action",
            "plugin": {
              "name": "VirusTotal",
              "slugVendor": "rapid7",
              "slugName": "virustotal",
              "slugVersion": "8.1.0",
              "imageData": "https://us.cdn-assets.connect.insight.rapid7.com/icons/rapid7/virustotal/8.1.0/icon.png"
            },
            "identifier": "ip_address_report",
            "continueOnFailure": false,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "address": "{{[6098ca26-515f-4a15-94a3-2b587292d6b4].[$item].[ip]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "address": {
                  "description": "IP address",
                  "order": 1,
                  "title": "IP Address",
                  "type": "string"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "definitions": {
                "authority_key_identifier": {
                  "properties": {
                    "keyid": {
                      "description": "Key hexdump",
                      "order": 1,
                      "title": "Key ID",
                      "type": "string"
                    },
                    "serial_number": {
                      "description": "Serial number hexdump",
                      "order": 2,
                      "title": "Serial Number",
                      "type": "string"
                    }
                  },
                  "title": "Authority Key Identifier",
                  "type": "object"
                },
                "cert_signature": {
                  "properties": {
                    "signature": {
                      "description": "Signature hexdump",
                      "order": 1,
                      "title": "Signature",
                      "type": "string"
                    },
                    "signature_algorithm": {
                      "description": "Used algorithm",
                      "order": 2,
                      "title": "Signature Algorithm",
                      "type": "string"
                    }
                  },
                  "title": "Cert Signature",
                  "type": "object"
                },
                "dsa": {
                  "properties": {
                    "g": {
                      "description": "G component hexdump",
                      "order": 3,
                      "title": "G",
                      "type": "string"
                    },
                    "p": {
                      "description": "P component hexdump",
                      "order": 1,
                      "title": "P",
                      "type": "string"
                    },
                    "pub": {
                      "description": "Public key hexdump",
                      "order": 4,
                      "title": "Public",
                      "type": "string"
                    },
                    "q": {
                      "description": "Q component hexdump",
                      "order": 2,
                      "title": "Q",
                      "type": "string"
                    }
                  },
                  "title": "Dsa",
                  "type": "object"
                },
                "ec": {
                  "properties": {
                    "oid": {
                      "description": "Curve name",
                      "order": 1,
                      "title": "OID",
                      "type": "string"
                    },
                    "pub": {
                      "description": "Public key hexdump",
                      "order": 2,
                      "title": "Public",
                      "type": "string"
                    }
                  },
                  "title": "Ec",
                  "type": "object"
                },
                "ip_report": {
                  "properties": {
                    "as_owner": {
                      "description": "Owner of the Autonomous System to which the IP belongs",
                      "order": 1,
                      "title": "As Owner",
                      "type": "string"
                    },
                    "asn": {
                      "description": "Autonomous System Number to which the IP belongs",
                      "order": 2,
                      "title": "ASN",
                      "type": "integer"
                    },
                    "continent": {
                      "description": "Continent where the IP is placed (ISO-3166 continent code)",
                      "order": 3,
                      "title": "Continent",
                      "type": "string"
                    },
                    "country": {
                      "description": "Country where the IP is placed (ISO-3166 country code)",
                      "order": 4,
                      "title": "Country",
                      "type": "string"
                    },
                    "last_analysis_results": {
                      "description": "Result from URL scanners. Object with scanner name as key and an object with notes/result from that scanner as value",
                      "items": {
                        "$ref": "#/definitions/last_analysis_result"
                      },
                      "order": 5,
                      "title": "Last Analysis Results",
                      "type": "array"
                    },
                    "last_analysis_stats": {
                      "$ref": "#/definitions/last_analysis_stats",
                      "description": "Number of different results from this scans",
                      "order": 6,
                      "title": "Last Analysis Statistics"
                    },
                    "last_https_certificate": {
                      "$ref": "#/definitions/ssl_certificate",
                      "description": "SSL Certificate object retrieved last time the domain was analyzed",
                      "order": 7,
                      "title": "Last HTTPS Certificate"
                    },
                    "last_https_certificate_date": {
                      "description": "Date when the certificate was retrieved by VirusTotal (UTC timestamp)",
                      "order": 8,
                      "title": "Last HTTPS Certificate Date",
                      "type": "integer"
                    },
                    "last_modification_date": {
                      "description": "Date when any of the IP's information was last updated (UTC timestamp)",
                      "order": 9,
                      "title": "Last Modification Date",
                      "type": "integer"
                    },
                    "network": {
                      "description": "IPv4 network range to which the IP belongs",
                      "order": 10,
                      "title": "Network",
                      "type": "string"
                    },
                    "regional_internet_registry": {
                      "description": "RIR (one of the current RIRs: AFRINIC, ARIN, APNIC, LACNIC or RIPE NCC)",
                      "order": 11,
                      "title": "Regional Internet Registry",
                      "type": "string"
                    },
                    "reputation": {
                      "description": "IP's score calculated from the votes of the VirusTotal's community",
                      "order": 12,
                      "title": "Reputation",
                      "type": "integer"
                    },
                    "tags": {
                      "description": "Identificative attributes",
                      "items": {
                        "type": "string"
                      },
                      "order": 13,
                      "title": "Tags",
                      "type": "array"
                    },
                    "total_votes": {
                      "$ref": "#/definitions/total_votes",
                      "description": "Unweighted number of total votes from the community, divided in harmless and malicious",
                      "order": 14,
                      "title": "Total Votes"
                    },
                    "whois": {
                      "description": "WHOIS information as returned from the pertinent WHOIS server",
                      "order": 15,
                      "title": "WHOIS",
                      "type": "string"
                    },
                    "whois_date": {
                      "description": "Date of the last update of the WHOIS record in VirusTotal",
                      "order": 16,
                      "title": "WHOIS Date",
                      "type": "integer"
                    }
                  },
                  "title": "Ip Report",
                  "type": "object"
                },
                "last_analysis_result": {
                  "properties": {
                    "category": {
                      "description": "Category",
                      "order": 2,
                      "title": "Category",
                      "type": "string"
                    },
                    "engine_name": {
                      "description": "Engine name",
                      "order": 1,
                      "title": "Engine Name",
                      "type": "string"
                    },
                    "engine_update": {
                      "description": "Engine's last update date",
                      "order": 3,
                      "title": "Engine Update",
                      "type": "string"
                    },
                    "engine_version": {
                      "description": "Engine's version",
                      "order": 4,
                      "title": "Engine Version",
                      "type": "string"
                    },
                    "method": {
                      "description": "Detection method",
                      "order": 5,
                      "title": "Method",
                      "type": "string"
                    },
                    "result": {
                      "description": "Result",
                      "order": 6,
                      "title": "Result",
                      "type": "string"
                    }
                  },
                  "title": "Last Analysis Result",
                  "type": "object"
                },
                "last_analysis_stats": {
                  "properties": {
                    "harmless": {
                      "description": "Number of reports indicating harmless",
                      "order": 1,
                      "title": "Harmless",
                      "type": "integer"
                    },
                    "malicious": {
                      "description": "Number of reports indicating malicious",
                      "order": 2,
                      "title": "Malicious",
                      "type": "integer"
                    },
                    "suspicious": {
                      "description": "Number of reports indicating suspicious",
                      "order": 3,
                      "title": "Suspicious",
                      "type": "integer"
                    },
                    "timeout": {
                      "description": "Number of reports indicating timeout",
                      "order": 4,
                      "title": "Timeout",
                      "type": "integer"
                    },
                    "undetected": {
                      "description": "Number of reports indicating undetected",
                      "order": 5,
                      "title": "Undetected",
                      "type": "integer"
                    }
                  },
                  "title": "Last Analysis Stats",
                  "type": "object"
                },
                "public_key": {
                  "properties": {
                    "algorithm": {
                      "description": "Indicates the algorithm used to generate the certificate",
                      "order": 1,
                      "title": "Algorithm",
                      "type": "string"
                    },
                    "dsa": {
                      "$ref": "#/definitions/dsa",
                      "description": "DSA public key information",
                      "order": 3,
                      "title": "DSA"
                    },
                    "ec": {
                      "$ref": "#/definitions/ec",
                      "description": "EC public key information",
                      "order": 4,
                      "title": "EC"
                    },
                    "rsa": {
                      "$ref": "#/definitions/rsa",
                      "description": "RSA public key information",
                      "order": 2,
                      "title": "RSA"
                    }
                  },
                  "title": "Public Key",
                  "type": "object"
                },
                "rsa": {
                  "properties": {
                    "exponent": {
                      "description": "Key exponent hexdump",
                      "order": 3,
                      "title": "Exponent",
                      "type": "string"
                    },
                    "key_size": {
                      "description": "Key size",
                      "order": 1,
                      "title": "Key Size",
                      "type": "integer"
                    },
                    "modulus": {
                      "description": "Key modulus hexdump",
                      "order": 2,
                      "title": "Modulus",
                      "type": "string"
                    }
                  },
                  "title": "Rsa",
                  "type": "object"
                },
                "ssl_certificate": {
                  "properties": {
                    "cert_signature": {
                      "$ref": "#/definitions/cert_signature",
                      "description": "Dictionary containing certificate's signature and algorithm",
                      "order": 1,
                      "title": "Certificate Signature"
                    },
                    "extensions": {
                      "$ref": "#/definitions/ssl_extensions",
                      "description": "Dictionary containing all certificate's extensions",
                      "order": 2,
                      "title": "Extensions"
                    },
                    "first_seen_date": {
                      "description": "Date the certificate was first retrieved by VirusTotal",
                      "order": 3,
                      "title": "First Seen Date",
                      "type": "integer"
                    },
                    "issuer": {
                      "$ref": "#/definitions/ssl_data",
                      "description": "Dictionary containing the certificate's issuer data",
                      "order": 4,
                      "title": "Issuer"
                    },
                    "public_key": {
                      "$ref": "#/definitions/public_key",
                      "description": "Subject public key info",
                      "order": 5,
                      "title": "Public Key"
                    },
                    "serial_number": {
                      "description": "Certificate's serial number hexdump",
                      "order": 6,
                      "title": "Serial Number",
                      "type": "string"
                    },
                    "signature_algorithm": {
                      "description": "Algorithm used for the signature",
                      "order": 7,
                      "title": "Signature Algorithm",
                      "type": "string"
                    },
                    "size": {
                      "description": "Certificate content length",
                      "order": 8,
                      "title": "Size",
                      "type": "integer"
                    },
                    "subject": {
                      "$ref": "#/definitions/ssl_data",
                      "description": "Dictionary containing the certificate's subject data",
                      "order": 9,
                      "title": "Subject"
                    },
                    "thumbprint": {
                      "description": "Certificate's content SHA1 hash",
                      "order": 10,
                      "title": "Thumbprint",
                      "type": "string"
                    },
                    "thumbprint_sha256": {
                      "description": "Certificate's content SHA256 hash",
                      "order": 11,
                      "title": "Thumbprint SHA256",
                      "type": "string"
                    },
                    "validity": {
                      "$ref": "#/definitions/validity",
                      "description": "Defines certificate's validity period",
                      "order": 12,
                      "title": "Validity"
                    },
                    "version": {
                      "description": "Certificate version",
                      "order": 13,
                      "title": "Version",
                      "type": "string"
                    }
                  },
                  "title": "Ssl Certificate",
                  "type": "object"
                },
                "ssl_data": {
                  "properties": {
                    "C": {
                      "description": "Country name",
                      "order": 1,
                      "title": "Country Name",
                      "type": "string"
                    },
                    "CN": {
                      "description": "Common name",
                      "order": 2,
                      "title": "Common Name",
                      "type": "string"
                    },
                    "L": {
                      "description": "Locality",
                      "order": 3,
                      "title": "Locality",
                      "type": "string"
                    },
                    "O": {
                      "description": "Organization",
                      "order": 4,
                      "title": "Organization",
                      "type": "string"
                    },
                    "OU": {
                      "description": "Organizational unit",
                      "order": 5,
                      "title": "Organizational Unit",
                      "type": "string"
                    },
                    "ST": {
                      "description": "State or province name",
                      "order": 6,
                      "title": "State or Province Name",
                      "type": "string"
                    }
                  },
                  "title": "Ssl Data",
                  "type": "object"
                },
                "ssl_extensions": {
                  "properties": {
                    "authority_key_identifier": {
                      "$ref": "#/definitions/authority_key_identifier",
                      "description": "Identifies the public key to be used to verify the signature on this certificate or CRL",
                      "order": 3,
                      "title": "Authority Key Identifier"
                    },
                    "ca": {
                      "description": "Whether the subject acts as a CA or not",
                      "order": 1,
                      "title": "CA",
                      "type": "boolean"
                    },
                    "ca_information_access": {
                      "description": "Authority information access locations are URLs that are added to a certificate in its authority information access extension",
                      "order": 5,
                      "title": "CA Information Access",
                      "type": "object"
                    },
                    "cert_template_name_dc": {
                      "description": "BMP data value DomainController, see MS Q291010",
                      "order": 10,
                      "title": "Certificate Template Name DC",
                      "type": "string"
                    },
                    "certificate_policies": {
                      "description": "Different certificate policies will relate to different applications which may use the certified key",
                      "items": {
                        "type": "string"
                      },
                      "order": 8,
                      "title": "Certificate Policies",
                      "type": "array"
                    },
                    "crl_distribution_points": {
                      "description": "Identifies the CRL distribution points to which a certificate user should refer to ascertain if the certificate has been revoked",
                      "items": {
                        "type": "string"
                      },
                      "order": 6,
                      "title": "CRL Distribution Points",
                      "type": "array"
                    },
                    "key_usage": {
                      "description": "Indicates the purpose for which the certified public key is used",
                      "items": {
                        "type": "string"
                      },
                      "order": 4,
                      "title": "Key Usage",
                      "type": "array"
                    },
                    "netscape_cert_comment": {
                      "description": "Used to include free-form text comments inside certificates",
                      "order": 9,
                      "title": "Netscape Certificate Comment",
                      "type": "string"
                    },
                    "netscape_certificate": {
                      "description": "Identify whether the certificate subject is an SSL client, an SSL server, or a CA",
                      "order": 11,
                      "title": "Netscape Certificate",
                      "type": "boolean"
                    },
                    "old_authority_key_identifier": {
                      "description": "Whether the certificate has an old authority key identifier extension",
                      "order": 13,
                      "title": "Old Authority Key Identifier",
                      "type": "boolean"
                    },
                    "pe_logotype": {
                      "description": "Whether the certificate includes a logotype",
                      "order": 12,
                      "title": "PE Logotype",
                      "type": "boolean"
                    },
                    "subject_alternative_name": {
                      "description": "Contains one or more alternative names, using any of a variety of name forms, for the entity that is bound by the CA to the certified public key",
                      "items": {
                        "type": "string"
                      },
                      "order": 7,
                      "title": "Subject Alternative Name",
                      "type": "array"
                    },
                    "subject_key_identifier": {
                      "description": "Identifies the public key being certified",
                      "order": 2,
                      "title": "Subject Key Identifier",
                      "type": "string"
                    }
                  },
                  "title": "Ssl Extensions",
                  "type": "object"
                },
                "total_votes": {
                  "properties": {
                    "harmless": {
                      "description": "Number of positive votes",
                      "order": 1,
                      "title": "Harmless",
                      "type": "integer"
                    },
                    "malicious": {
                      "description": "Number of negative votes",
                      "order": 2,
                      "title": "Malicious",
                      "type": "integer"
                    }
                  },
                  "title": "Total Votes",
                  "type": "object"
                },
                "validity": {
                  "properties": {
                    "not_after": {
                      "description": "Expiry date in %Y-%m-%d %H:%M:%S format",
                      "order": 1,
                      "title": "Not After",
                      "type": "string"
                    },
                    "not_before": {
                      "description": "Issue date in %Y-%m-%d %H:%M:%S format",
                      "order": 2,
                      "title": "Not Before",
                      "type": "string"
                    }
                  },
                  "title": "Validity",
                  "type": "object"
                }
              },
              "properties": {
                "found": {
                  "description": "True if found",
                  "order": 2,
                  "title": "Found",
                  "type": "boolean"
                },
                "report": {
                  "$ref": "#/definitions/ip_report",
                  "description": "IP address report",
                  "order": 1,
                  "title": "Report"
                }
              },
              "required": [
                "found"
              ],
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          },
          "0c074692-5c2b-4e44-97cc-43f906525e57": {
            "nodeId": "0c074692-5c2b-4e44-97cc-43f906525e57",
            "name": "Processes",
            "type": "loop",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "customOutput": [],
              "innerEdgeId": "9caee343-eb49-4584-8ae6-f042e1e43dba",
              "nextEdgeId": "78305728-b283-4edf-bdb7-7da4080edf4e",
              "repeatVariable": "{{[ba8bae4b-ae24-47c9-b635-3ebb9b6a934a].[contents].[processes]}}"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": {
              "properties": {},
              "title": "Variables",
              "type": "object"
            },
            "defaultImageData": "https://us.cdn-assets.connect.insight.rapid7.com/step-type-icons/loop.svg",
            "connectionType": "NONE"
          },
          "0cb21508-40c5-4dc0-bb68-7ef943d61dfd": {
            "nodeId": "0cb21508-40c5-4dc0-bb68-7ef943d61dfd",
            "name": "Domain Found?",
            "type": "automated_decision",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "defaultEdgeId": "b2fbd4b7-9f99-43ac-8145-f484c854c23b",
              "stepControlParams": [
                {
                  "edgeId": "96c038f9-ce8e-436b-931f-313b8773cf0c",
                  "expression": {
                    "name": "e74274ce-7292-49ce-8e45-cdfa7d4e5752.found",
                    "type": "variable"
                  },
                  "expressionText": "{{[e74274ce-7292-49ce-8e45-cdfa7d4e5752].[found]}}"
                },
                {
                  "edgeId": "b2fbd4b7-9f99-43ac-8145-f484c854c23b",
                  "expression": {},
                  "expressionText": ""
                }
              ]
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://us.cdn-assets.connect.insight.rapid7.com/step-type-icons/automated-decision.svg",
            "connectionType": "NONE"
          },
          "126c83e4-bdf1-40ba-9980-279e2174cc3d": {
            "nodeId": "126c83e4-bdf1-40ba-9980-279e2174cc3d",
            "name": "Alert Information Message",
            "type": "action",
            "plugin": {
              "name": "Microsoft Teams",
              "slugVendor": "rapid7",
              "slugName": "microsoft_teams",
              "slugVersion": "3.1.5",
              "imageData": "https://us.cdn-assets.connect.insight.rapid7.com/icons/rapid7/microsoft_teams/3.1.5/icon.png"
            },
            "identifier": "send_html_message",
            "continueOnFailure": false,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "channel_name": "{{$workflow.[Channel Name]}}",
                "message_content": "<b>IDR Alert Contents</b><br>\n<br>\n{{#if [ba8bae4b-ae24-47c9-b635-3ebb9b6a934a].[contents].[urls]}}\nURLs:<br>\n<ul>\n{{#each [ba8bae4b-ae24-47c9-b635-3ebb9b6a934a].[contents].[urls]}}\n<li>{{this}}</li>\n{{/each}}\n</ul>\n{{/if}}\n{{#if [ba8bae4b-ae24-47c9-b635-3ebb9b6a934a].[contents].[domains]}}\nDomains:<br>\n<ul>\n{{#each [ba8bae4b-ae24-47c9-b635-3ebb9b6a934a].[contents].[domains]}}\n<li>{{this}}</li>\n{{/each}}\n</ul>\n{{/if}}\n{{#if [ba8bae4b-ae24-47c9-b635-3ebb9b6a934a].[contents].[processes]}}\nHashes:<br>\n<ul>\n{{#each [ba8bae4b-ae24-47c9-b635-3ebb9b6a934a].[contents].[processes]}}\n{{#if hashes}}\n{{#each hashes}}\n<li>{{hash}} ({{type}})</li>\n{{/each}}\n{{/if}}\n{{/each}}\n</ul>\n{{/if}}\n{{#if [ba8bae4b-ae24-47c9-b635-3ebb9b6a934a].[contents].[ipAddresses]}}\nIP Addresses:<br>\n<ul>\n{{#each [ba8bae4b-ae24-47c9-b635-3ebb9b6a934a].[contents].[ipAddresses]}}\n{{#if ip}}\n<li>{{ip}}</li>\n{{/if}}\n{{/each}}\n</ul>\n{{/if}}\n\n",
                "team_name": "{{$workflow.[Team Name]}}",
                "thread_id": ""
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "channel_name": {
                  "description": "Channel name",
                  "order": 2,
                  "title": "Channel Name",
                  "type": "string"
                },
                "message_content": {
                  "description": "HTML content to send",
                  "order": 4,
                  "title": "Message Content",
                  "type": "string"
                },
                "team_name": {
                  "description": "Team name",
                  "order": 1,
                  "title": "Team Name",
                  "type": "string"
                },
                "thread_id": {
                  "description": "To post in a thread, select parent message ID",
                  "order": 3,
                  "title": "Thread ID",
                  "type": "string"
                }
              },
              "required": [
                "message_content",
                "team_name",
                "channel_name"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "definitions": {
                "body": {
                  "properties": {
                    "content": {
                      "description": "Content",
                      "order": 1,
                      "title": "Content",
                      "type": "string"
                    },
                    "contentType": {
                      "description": "Content type",
                      "order": 2,
                      "title": "Content Type",
                      "type": "string"
                    }
                  },
                  "title": "Body",
                  "type": "object"
                },
                "from": {
                  "properties": {
                    "user": {
                      "$ref": "#/definitions/user",
                      "description": "User",
                      "order": 1,
                      "title": "User"
                    }
                  },
                  "title": "From",
                  "type": "object"
                },
                "message": {
                  "properties": {
                    "body": {
                      "$ref": "#/definitions/body",
                      "description": "Body",
                      "order": 1,
                      "title": "Body"
                    },
                    "createdDateTime": {
                      "description": "Created date time",
                      "order": 3,
                      "title": "Created Date Time",
                      "type": "string"
                    },
                    "first_word": {
                      "description": "Extracted first word from message (easy way to obtain a chat command)",
                      "order": 9,
                      "title": "First Word",
                      "type": "string"
                    },
                    "from": {
                      "$ref": "#/definitions/from",
                      "description": "From",
                      "order": 2,
                      "title": "From"
                    },
                    "id": {
                      "description": "ID",
                      "order": 8,
                      "title": "ID",
                      "type": "string"
                    },
                    "importance": {
                      "description": "Importance",
                      "order": 5,
                      "title": "Importance",
                      "type": "string"
                    },
                    "locale": {
                      "description": "Locale",
                      "order": 7,
                      "title": "Locale",
                      "type": "string"
                    },
                    "messageType": {
                      "description": "Message type",
                      "order": 6,
                      "title": "Message Type",
                      "type": "string"
                    },
                    "webUrl": {
                      "description": "Web URL",
                      "order": 4,
                      "title": "Web URL",
                      "type": "string"
                    },
                    "words": {
                      "description": "The message split by spaces into a list of words. This list makes finding and using parameters in chat commands easier",
                      "items": {
                        "type": "string"
                      },
                      "order": 10,
                      "title": "Words",
                      "type": "array"
                    }
                  },
                  "required": [
                    "first_word",
                    "words"
                  ],
                  "title": "Message",
                  "type": "object"
                },
                "user": {
                  "properties": {
                    "displayName": {
                      "description": "Display name",
                      "order": 1,
                      "title": "Display name",
                      "type": "string"
                    },
                    "id": {
                      "description": "ID",
                      "order": 2,
                      "title": "ID",
                      "type": "string"
                    }
                  },
                  "title": "User",
                  "type": "object"
                }
              },
              "properties": {
                "message": {
                  "$ref": "#/definitions/message",
                  "description": "The message object that was created",
                  "order": 1,
                  "title": "Message"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          },
          "13ba3e21-ea09-4dfd-b385-e2edfe0684e9": {
            "nodeId": "13ba3e21-ea09-4dfd-b385-e2edfe0684e9",
            "name": "URL Message",
            "type": "action",
            "plugin": {
              "name": "Microsoft Teams",
              "slugVendor": "rapid7",
              "slugName": "microsoft_teams",
              "slugVersion": "3.1.5",
              "imageData": "https://us.cdn-assets.connect.insight.rapid7.com/icons/rapid7/microsoft_teams/3.1.5/icon.png"
            },
            "identifier": "send_html_message",
            "continueOnFailure": false,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "channel_name": "{{$workflow.[Channel Name]}}",
                "message_content": "<h2>URL Report</h2>\n<br>\n<i>Report for {{[24ea0051-2329-4d9b-a230-6aed47c9a85b].[$item]}}</i><br>\n<br>\nScan date (timestamp): {{[8c4d0f0c-7c1f-49e2-a428-3017029e2327].[report].[last_analysis_date]}}<br>\nFound malicious by <code>{{[8c4d0f0c-7c1f-49e2-a428-3017029e2327].[report].[last_analysis_stats].[malicious]}}</code> scans out of <code>{{[36cc3723-5878-4174-9eec-7e04b1885816].[result]}}</code> total.<br>\n<br>\nFull VirusTotal Report: <a href=\"https://www.virustotal.com/gui/url/{{[e218194b-b97b-4628-9025-8ffeccec8d63].[sha256]}}/details\">https://www.virustotal.com/gui/url/{{[e218194b-b97b-4628-9025-8ffeccec8d63].[sha256]}}/details</a><br>",
                "team_name": "{{$workflow.[Team Name]}}",
                "thread_id": "{{[126c83e4-bdf1-40ba-9980-279e2174cc3d].[message].[id]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "channel_name": {
                  "description": "Channel name",
                  "order": 2,
                  "title": "Channel Name",
                  "type": "string"
                },
                "message_content": {
                  "description": "HTML content to send",
                  "order": 4,
                  "title": "Message Content",
                  "type": "string"
                },
                "team_name": {
                  "description": "Team name",
                  "order": 1,
                  "title": "Team Name",
                  "type": "string"
                },
                "thread_id": {
                  "description": "To post in a thread, select parent message ID",
                  "order": 3,
                  "title": "Thread ID",
                  "type": "string"
                }
              },
              "required": [
                "message_content",
                "team_name",
                "channel_name"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "definitions": {
                "body": {
                  "properties": {
                    "content": {
                      "description": "Content",
                      "order": 1,
                      "title": "Content",
                      "type": "string"
                    },
                    "contentType": {
                      "description": "Content type",
                      "order": 2,
                      "title": "Content Type",
                      "type": "string"
                    }
                  },
                  "title": "Body",
                  "type": "object"
                },
                "from": {
                  "properties": {
                    "user": {
                      "$ref": "#/definitions/user",
                      "description": "User",
                      "order": 1,
                      "title": "User"
                    }
                  },
                  "title": "From",
                  "type": "object"
                },
                "message": {
                  "properties": {
                    "body": {
                      "$ref": "#/definitions/body",
                      "description": "Body",
                      "order": 1,
                      "title": "Body"
                    },
                    "createdDateTime": {
                      "description": "Created date time",
                      "order": 3,
                      "title": "Created Date Time",
                      "type": "string"
                    },
                    "first_word": {
                      "description": "Extracted first word from message (easy way to obtain a chat command)",
                      "order": 9,
                      "title": "First Word",
                      "type": "string"
                    },
                    "from": {
                      "$ref": "#/definitions/from",
                      "description": "From",
                      "order": 2,
                      "title": "From"
                    },
                    "id": {
                      "description": "ID",
                      "order": 8,
                      "title": "ID",
                      "type": "string"
                    },
                    "importance": {
                      "description": "Importance",
                      "order": 5,
                      "title": "Importance",
                      "type": "string"
                    },
                    "locale": {
                      "description": "Locale",
                      "order": 7,
                      "title": "Locale",
                      "type": "string"
                    },
                    "messageType": {
                      "description": "Message type",
                      "order": 6,
                      "title": "Message Type",
                      "type": "string"
                    },
                    "webUrl": {
                      "description": "Web URL",
                      "order": 4,
                      "title": "Web URL",
                      "type": "string"
                    },
                    "words": {
                      "description": "The message split by spaces into a list of words. This list makes finding and using parameters in chat commands easier",
                      "items": {
                        "type": "string"
                      },
                      "order": 10,
                      "title": "Words",
                      "type": "array"
                    }
                  },
                  "required": [
                    "first_word",
                    "words"
                  ],
                  "title": "Message",
                  "type": "object"
                },
                "user": {
                  "properties": {
                    "displayName": {
                      "description": "Display name",
                      "order": 1,
                      "title": "Display name",
                      "type": "string"
                    },
                    "id": {
                      "description": "ID",
                      "order": 2,
                      "title": "ID",
                      "type": "string"
                    }
                  },
                  "title": "User",
                  "type": "object"
                }
              },
              "properties": {
                "message": {
                  "$ref": "#/definitions/message",
                  "description": "The message object that was created",
                  "order": 1,
                  "title": "Message"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          },
          "14326edd-892f-4f04-8e29-a1a1a1d123c6": {
            "nodeId": "14326edd-892f-4f04-8e29-a1a1a1d123c6",
            "name": "Domain Report",
            "type": "artifact",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "content": "## Domain Report\n\n*Report for {{[7847be03-2237-4036-b118-810ed591bcda].[$item]}}*\n\nFound malicious by `{{[e74274ce-7292-49ce-8e45-cdfa7d4e5752].[report].[last_analysis_stats].[malicious]}}` scans out of `{{[e63da188-ac02-40c3-aca0-a98793b094a0].[result]}}` total.\n\nCategories: \n{{#each [e74274ce-7292-49ce-8e45-cdfa7d4e5752].[report].[categories]}}\n + {{this}} ({{@key}})\n{{/each}}\n\nWHOIS Information:\n{{[e74274ce-7292-49ce-8e45-cdfa7d4e5752].[report].[whois]}}\n\nFull VirusTotal Report: [https://www.virustotal.com/gui/domain/{{[7847be03-2237-4036-b118-810ed591bcda].[$item]}}/detection](https://www.virustotal.com/gui/domain/{{[7847be03-2237-4036-b118-810ed591bcda].[$item]}}/detection)"
              },
              "type": "markdown"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://us.cdn-assets.connect.insight.rapid7.com/step-type-icons/artifact.svg",
            "connectionType": "NONE"
          },
          "153857af-a78a-41bd-a1c2-b08957248379": {
            "nodeId": "153857af-a78a-41bd-a1c2-b08957248379",
            "name": "Hash Not Found Message",
            "type": "action",
            "plugin": {
              "name": "Microsoft Teams",
              "slugVendor": "rapid7",
              "slugName": "microsoft_teams",
              "slugVersion": "3.1.5",
              "imageData": "https://us.cdn-assets.connect.insight.rapid7.com/icons/rapid7/microsoft_teams/3.1.5/icon.png"
            },
            "identifier": "send_html_message",
            "continueOnFailure": false,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "channel_name": "{{$workflow.[Channel Name]}}",
                "message_content": "<i>No reports found for {{[41ab1e00-636e-4702-80b5-4fff15161893].[$item].[hash]}}</i>",
                "team_name": "{{$workflow.[Team Name]}}",
                "thread_id": "{{[126c83e4-bdf1-40ba-9980-279e2174cc3d].[message].[id]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "channel_name": {
                  "description": "Channel name",
                  "order": 2,
                  "title": "Channel Name",
                  "type": "string"
                },
                "message_content": {
                  "description": "HTML content to send",
                  "order": 4,
                  "title": "Message Content",
                  "type": "string"
                },
                "team_name": {
                  "description": "Team name",
                  "order": 1,
                  "title": "Team Name",
                  "type": "string"
                },
                "thread_id": {
                  "description": "To post in a thread, select parent message ID",
                  "order": 3,
                  "title": "Thread ID",
                  "type": "string"
                }
              },
              "required": [
                "message_content",
                "team_name",
                "channel_name"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "definitions": {
                "body": {
                  "properties": {
                    "content": {
                      "description": "Content",
                      "order": 1,
                      "title": "Content",
                      "type": "string"
                    },
                    "contentType": {
                      "description": "Content type",
                      "order": 2,
                      "title": "Content Type",
                      "type": "string"
                    }
                  },
                  "title": "Body",
                  "type": "object"
                },
                "from": {
                  "properties": {
                    "user": {
                      "$ref": "#/definitions/user",
                      "description": "User",
                      "order": 1,
                      "title": "User"
                    }
                  },
                  "title": "From",
                  "type": "object"
                },
                "message": {
                  "properties": {
                    "body": {
                      "$ref": "#/definitions/body",
                      "description": "Body",
                      "order": 1,
                      "title": "Body"
                    },
                    "createdDateTime": {
                      "description": "Created date time",
                      "order": 3,
                      "title": "Created Date Time",
                      "type": "string"
                    },
                    "first_word": {
                      "description": "Extracted first word from message (easy way to obtain a chat command)",
                      "order": 9,
                      "title": "First Word",
                      "type": "string"
                    },
                    "from": {
                      "$ref": "#/definitions/from",
                      "description": "From",
                      "order": 2,
                      "title": "From"
                    },
                    "id": {
                      "description": "ID",
                      "order": 8,
                      "title": "ID",
                      "type": "string"
                    },
                    "importance": {
                      "description": "Importance",
                      "order": 5,
                      "title": "Importance",
                      "type": "string"
                    },
                    "locale": {
                      "description": "Locale",
                      "order": 7,
                      "title": "Locale",
                      "type": "string"
                    },
                    "messageType": {
                      "description": "Message type",
                      "order": 6,
                      "title": "Message Type",
                      "type": "string"
                    },
                    "webUrl": {
                      "description": "Web URL",
                      "order": 4,
                      "title": "Web URL",
                      "type": "string"
                    },
                    "words": {
                      "description": "The message split by spaces into a list of words. This list makes finding and using parameters in chat commands easier",
                      "items": {
                        "type": "string"
                      },
                      "order": 10,
                      "title": "Words",
                      "type": "array"
                    }
                  },
                  "required": [
                    "first_word",
                    "words"
                  ],
                  "title": "Message",
                  "type": "object"
                },
                "user": {
                  "properties": {
                    "displayName": {
                      "description": "Display name",
                      "order": 1,
                      "title": "Display name",
                      "type": "string"
                    },
                    "id": {
                      "description": "ID",
                      "order": 2,
                      "title": "ID",
                      "type": "string"
                    }
                  },
                  "title": "User",
                  "type": "object"
                }
              },
              "properties": {
                "message": {
                  "$ref": "#/definitions/message",
                  "description": "The message object that was created",
                  "order": 1,
                  "title": "Message"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          },
          "1ab58d1b-4a47-4373-9168-b213f11268c6": {
            "nodeId": "1ab58d1b-4a47-4373-9168-b213f11268c6",
            "name": "Any Indicators?",
            "type": "automated_decision",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "defaultEdgeId": "c65d9509-2b66-43d4-a9f6-d908061abe0a",
              "stepControlParams": [
                {
                  "edgeId": "c65d9509-2b66-43d4-a9f6-d908061abe0a",
                  "expression": {},
                  "expressionText": ""
                },
                {
                  "edgeId": "67941f3a-e99c-4568-9696-efcacfe829bc",
                  "expression": {
                    "left": {
                      "left": {
                        "args": [
                          {
                            "name": "ba8bae4b-ae24-47c9-b635-3ebb9b6a934a.contents.urls",
                            "type": "variable"
                          }
                        ],
                        "name": "length",
                        "type": "function"
                      },
                      "op": "==",
                      "right": {
                        "type": "literal",
                        "value": 0
                      },
                      "type": "binary"
                    },
                    "op": "AND",
                    "right": {
                      "left": {
                        "left": {
                          "args": [
                            {
                              "name": "ba8bae4b-ae24-47c9-b635-3ebb9b6a934a.contents.domains",
                              "type": "variable"
                            }
                          ],
                          "name": "length",
                          "type": "function"
                        },
                        "op": "==",
                        "right": {
                          "type": "literal",
                          "value": 0
                        },
                        "type": "binary"
                      },
                      "op": "AND",
                      "right": {
                        "left": {
                          "left": {
                            "args": [
                              {
                                "name": "ba8bae4b-ae24-47c9-b635-3ebb9b6a934a.contents.processes",
                                "type": "variable"
                              }
                            ],
                            "name": "length",
                            "type": "function"
                          },
                          "op": "==",
                          "right": {
                            "type": "literal",
                            "value": 0
                          },
                          "type": "binary"
                        },
                        "op": "AND",
                        "right": {
                          "left": {
                            "args": [
                              {
                                "name": "ba8bae4b-ae24-47c9-b635-3ebb9b6a934a.contents.ipAddresses",
                                "type": "variable"
                              }
                            ],
                            "name": "length",
                            "type": "function"
                          },
                          "op": "==",
                          "right": {
                            "type": "literal",
                            "value": 0
                          },
                          "type": "binary"
                        },
                        "type": "binary"
                      },
                      "type": "binary"
                    },
                    "type": "binary"
                  },
                  "expressionText": "length({{[ba8bae4b-ae24-47c9-b635-3ebb9b6a934a].[contents].[urls]}})==0 && length({{[ba8bae4b-ae24-47c9-b635-3ebb9b6a934a].[contents].[domains]}})==0 && length({{[ba8bae4b-ae24-47c9-b635-3ebb9b6a934a].[contents].[processes]}})==0 && length({{[ba8bae4b-ae24-47c9-b635-3ebb9b6a934a].[contents].[ipAddresses]}})==0"
                }
              ]
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://us.cdn-assets.connect.insight.rapid7.com/step-type-icons/automated-decision.svg",
            "connectionType": "NONE"
          },
          "1f893118-34f1-4147-9297-16da8aec11c2": {
            "nodeId": "1f893118-34f1-4147-9297-16da8aec11c2",
            "name": "Calculate Total Reports ",
            "type": "action",
            "plugin": {
              "name": "Math",
              "slugVendor": "rapid7",
              "slugName": "math",
              "slugVersion": "1.2.1",
              "imageData": "https://us.cdn-assets.connect.insight.rapid7.com/icons/rapid7/math/1.2.1/icon.png"
            },
            "identifier": "calculate",
            "continueOnFailure": false,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "equation": "{{[e629fe72-b425-480e-8e98-ea481d7438ee].[report].[last_analysis_stats].[harmless]}} + {{[e629fe72-b425-480e-8e98-ea481d7438ee].[report].[last_analysis_stats].[malicious]}} + {{[e629fe72-b425-480e-8e98-ea481d7438ee].[report].[last_analysis_stats].[suspicious]}} + {{[e629fe72-b425-480e-8e98-ea481d7438ee].[report].[last_analysis_stats].[undetected]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "equation": {
                  "description": "Equation to calculate. Uses Python arithmetic operators (+, -, /, *, **, %)",
                  "order": 1,
                  "title": "Equation",
                  "type": "string"
                }
              },
              "required": [
                "equation"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "result": {
                  "description": "Result of the arithmetic operation",
                  "order": 1,
                  "title": "Result",
                  "type": "number"
                }
              },
              "required": [
                "result"
              ],
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "ORCHESTRATOR"
          },
          "24ea0051-2329-4d9b-a230-6aed47c9a85b": {
            "nodeId": "24ea0051-2329-4d9b-a230-6aed47c9a85b",
            "name": "URLs",
            "type": "loop",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "customOutput": [],
              "innerEdgeId": "4d561572-42ed-4718-8c84-0d6f0814ae3a",
              "nextEdgeId": "c741c60c-1d87-4ccf-bbeb-bd3b699d23eb",
              "repeatVariable": "{{[ba8bae4b-ae24-47c9-b635-3ebb9b6a934a].[contents].[urls]}}"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": {
              "properties": {},
              "title": "Variables",
              "type": "object"
            },
            "defaultImageData": "https://us.cdn-assets.connect.insight.rapid7.com/step-type-icons/loop.svg",
            "connectionType": "NONE"
          },
          "2c4cdbb2-2dd1-4a03-b57a-b6e1dca72790": {
            "nodeId": "2c4cdbb2-2dd1-4a03-b57a-b6e1dca72790",
            "name": "Domain Not Found",
            "type": "artifact",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "content": "*No reports found for {{[7847be03-2237-4036-b118-810ed591bcda].[$item]}}*"
              },
              "type": "markdown"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://us.cdn-assets.connect.insight.rapid7.com/step-type-icons/artifact.svg",
            "connectionType": "NONE"
          },
          "36cc3723-5878-4174-9eec-7e04b1885816": {
            "nodeId": "36cc3723-5878-4174-9eec-7e04b1885816",
            "name": "Calculate Total Scans",
            "type": "action",
            "plugin": {
              "name": "Math",
              "slugVendor": "rapid7",
              "slugName": "math",
              "slugVersion": "1.2.1",
              "imageData": "https://us.cdn-assets.connect.insight.rapid7.com/icons/rapid7/math/1.2.1/icon.png"
            },
            "identifier": "calculate",
            "continueOnFailure": false,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "equation": "{{[8c4d0f0c-7c1f-49e2-a428-3017029e2327].[report].[last_analysis_stats].[harmless]}} + {{[8c4d0f0c-7c1f-49e2-a428-3017029e2327].[report].[last_analysis_stats].[malicious]}} + {{[8c4d0f0c-7c1f-49e2-a428-3017029e2327].[report].[last_analysis_stats].[suspicious]}} + {{[8c4d0f0c-7c1f-49e2-a428-3017029e2327].[report].[last_analysis_stats].[undetected]}}\n"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "equation": {
                  "description": "Equation to calculate. Uses Python arithmetic operators (+, -, /, *, **, %)",
                  "order": 1,
                  "title": "Equation",
                  "type": "string"
                }
              },
              "required": [
                "equation"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "result": {
                  "description": "Result of the arithmetic operation",
                  "order": 1,
                  "title": "Result",
                  "type": "number"
                }
              },
              "required": [
                "result"
              ],
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "ORCHESTRATOR"
          },
          "41ab1e00-636e-4702-80b5-4fff15161893": {
            "nodeId": "41ab1e00-636e-4702-80b5-4fff15161893",
            "name": "Hashes",
            "type": "loop",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "customOutput": [],
              "innerEdgeId": "e9e803c9-0fdb-46d9-ab30-5d0b277a1f94",
              "nextEdgeId": "237f40d2-e748-44f2-8279-420e2148c2bf",
              "repeatVariable": "{{[0c074692-5c2b-4e44-97cc-43f906525e57].[$item].[hashes]}}"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": {
              "properties": {},
              "title": "Variables",
              "type": "object"
            },
            "defaultImageData": "https://us.cdn-assets.connect.insight.rapid7.com/step-type-icons/loop.svg",
            "connectionType": "NONE"
          },
          "6098ca26-515f-4a15-94a3-2b587292d6b4": {
            "nodeId": "6098ca26-515f-4a15-94a3-2b587292d6b4",
            "name": "IP Addresses",
            "type": "loop",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "customOutput": [],
              "innerEdgeId": "57734d40-4fd1-45ff-a86e-bab602c7a4e9",
              "nextEdgeId": "156320c0-65ed-4045-b8cd-dec203a4d17f",
              "repeatVariable": "{{[ba8bae4b-ae24-47c9-b635-3ebb9b6a934a].[contents].[ipAddresses]}}"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": {
              "properties": {},
              "title": "Variables",
              "type": "object"
            },
            "defaultImageData": "https://us.cdn-assets.connect.insight.rapid7.com/step-type-icons/loop.svg",
            "connectionType": "NONE"
          },
          "616f86c5-f811-43d4-80a9-55746f816f63": {
            "nodeId": "616f86c5-f811-43d4-80a9-55746f816f63",
            "name": "Hash Not Found",
            "type": "artifact",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "content": "*No reports found for {{[41ab1e00-636e-4702-80b5-4fff15161893].[$item].[hash]}}*"
              },
              "type": "markdown"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://us.cdn-assets.connect.insight.rapid7.com/step-type-icons/artifact.svg",
            "connectionType": "NONE"
          },
          "6542b420-735c-4fa4-ae53-872c46e983fb": {
            "nodeId": "6542b420-735c-4fa4-ae53-872c46e983fb",
            "name": "Calculate Total IP Reports",
            "type": "action",
            "plugin": {
              "name": "Math",
              "slugVendor": "rapid7",
              "slugName": "math",
              "slugVersion": "1.2.1",
              "imageData": "https://us.cdn-assets.connect.insight.rapid7.com/icons/rapid7/math/1.2.1/icon.png"
            },
            "identifier": "calculate",
            "continueOnFailure": false,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "equation": "{{[08fd10ab-d304-4b0c-9611-6427bc595c9a].[report].[last_analysis_stats].[malicious]}} + {{[08fd10ab-d304-4b0c-9611-6427bc595c9a].[report].[last_analysis_stats].[harmless]}} + {{[08fd10ab-d304-4b0c-9611-6427bc595c9a].[report].[last_analysis_stats].[suspicious]}} + {{[08fd10ab-d304-4b0c-9611-6427bc595c9a].[report].[last_analysis_stats].[undetected]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "equation": {
                  "description": "Equation to calculate. Uses Python arithmetic operators (+, -, /, *, **, %)",
                  "order": 1,
                  "title": "Equation",
                  "type": "string"
                }
              },
              "required": [
                "equation"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "result": {
                  "description": "Result of the arithmetic operation",
                  "order": 1,
                  "title": "Result",
                  "type": "number"
                }
              },
              "required": [
                "result"
              ],
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "ORCHESTRATOR"
          },
          "761abdab-762a-4558-b9f7-7cd42518bebd": {
            "nodeId": "761abdab-762a-4558-b9f7-7cd42518bebd",
            "name": "IP Address Not Found",
            "type": "artifact",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "content": "*No reports found for {{[6098ca26-515f-4a15-94a3-2b587292d6b4].[$item].[ip]}}*"
              },
              "type": "markdown"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://us.cdn-assets.connect.insight.rapid7.com/step-type-icons/artifact.svg",
            "connectionType": "NONE"
          },
          "7782ed10-999d-42b3-9348-d9b96099b67a": {
            "nodeId": "7782ed10-999d-42b3-9348-d9b96099b67a",
            "name": "Hash Artifact",
            "type": "artifact",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "content": "## Hash Report\n\n*Hash report for {{[41ab1e00-636e-4702-80b5-4fff15161893].[$item].[hash]}}*\n\nScan date (timestamp): {{[e629fe72-b425-480e-8e98-ea481d7438ee].[report].[last_analysis_date]}}\nFound malicious by `{{[e629fe72-b425-480e-8e98-ea481d7438ee].[report].[last_analysis_stats].[malicious]}}` scans out of `{{[1f893118-34f1-4147-9297-16da8aec11c2].[result]}}` total.\n\nComplete VirusTotal Report: [https://www.virustotal.com/gui/file/{{[e629fe72-b425-480e-8e98-ea481d7438ee].[report].[sha256]}}/detection](https://www.virustotal.com/gui/file/{{[e629fe72-b425-480e-8e98-ea481d7438ee].[report].[sha256]}}/detection)"
              },
              "type": "markdown"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://us.cdn-assets.connect.insight.rapid7.com/step-type-icons/artifact.svg",
            "connectionType": "NONE"
          },
          "77e243b3-0fe6-42a4-8181-ed9f2ea6cd2a": {
            "nodeId": "77e243b3-0fe6-42a4-8181-ed9f2ea6cd2a",
            "name": "URL Not Found Artifact",
            "type": "artifact",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "content": "*No reports found for {{[8c4d0f0c-7c1f-49e2-a428-3017029e2327].[report].[url]}}*"
              },
              "type": "markdown"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://us.cdn-assets.connect.insight.rapid7.com/step-type-icons/artifact.svg",
            "connectionType": "NONE"
          },
          "7847be03-2237-4036-b118-810ed591bcda": {
            "nodeId": "7847be03-2237-4036-b118-810ed591bcda",
            "name": "Domains",
            "type": "loop",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "customOutput": [],
              "innerEdgeId": "cdbb2e40-0ff7-4139-b551-6b95d59f1ea1",
              "nextEdgeId": "78953dc8-7262-45e9-81c2-88b6b2f19d60",
              "repeatVariable": "{{[ba8bae4b-ae24-47c9-b635-3ebb9b6a934a].[contents].[domains]}}"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": {
              "properties": {},
              "title": "Variables",
              "type": "object"
            },
            "defaultImageData": "https://us.cdn-assets.connect.insight.rapid7.com/step-type-icons/loop.svg",
            "connectionType": "NONE"
          },
          "89137b7a-a8c6-4b33-9d80-ef354cc9973b": {
            "nodeId": "89137b7a-a8c6-4b33-9d80-ef354cc9973b",
            "name": "IP Address Message",
            "type": "action",
            "plugin": {
              "name": "Microsoft Teams",
              "slugVendor": "rapid7",
              "slugName": "microsoft_teams",
              "slugVersion": "3.1.5",
              "imageData": "https://us.cdn-assets.connect.insight.rapid7.com/icons/rapid7/microsoft_teams/3.1.5/icon.png"
            },
            "identifier": "send_html_message",
            "continueOnFailure": false,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "channel_name": "{{$workflow.[Channel Name]}}",
                "message_content": "<h2>IP Address Report</h2>\n<br>\n<i>Report for {{[6098ca26-515f-4a15-94a3-2b587292d6b4].[$item].[ip]}}</i><br>\n<br>\n{{#if [08fd10ab-d304-4b0c-9611-6427bc595c9a].[report].[country]}}\nHosting country: {{[08fd10ab-d304-4b0c-9611-6427bc595c9a].[report].[country]}}<br>\n{{/if}}\n{{#if [08fd10ab-d304-4b0c-9611-6427bc595c9a].[report].[network]}}\nNetwork: {{[08fd10ab-d304-4b0c-9611-6427bc595c9a].[report].[network]}}<br>\n{{/if}}\n{{#if [08fd10ab-d304-4b0c-9611-6427bc595c9a].[report].[asn]}}\nASN: {{[08fd10ab-d304-4b0c-9611-6427bc595c9a].[report].[asn]}}<br>\n{{/if}}\n{{#if [08fd10ab-d304-4b0c-9611-6427bc595c9a].[report].[reputation]}}\nReputation: {{[08fd10ab-d304-4b0c-9611-6427bc595c9a].[report].[reputation]}}<br>\n{{/if}}\nFound malicious by <code>{{[08fd10ab-d304-4b0c-9611-6427bc595c9a].[report].[last_analysis_stats].[malicious]}}</code> scans out of <code>{{[6542b420-735c-4fa4-ae53-872c46e983fb].[result]}}</code> total.<br>\n<br>\nComplete VirusTotal Report: <a href=\"https://www.virustotal.com/gui/ip-address/{{[6098ca26-515f-4a15-94a3-2b587292d6b4].[$item].[ip]}}\">https://www.virustotal.com/gui/ip-address/{{[6098ca26-515f-4a15-94a3-2b587292d6b4].[$item].[ip]}}</a><br>\n",
                "team_name": "{{$workflow.[Team Name]}}",
                "thread_id": "{{[126c83e4-bdf1-40ba-9980-279e2174cc3d].[message].[id]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "channel_name": {
                  "description": "Channel name",
                  "order": 2,
                  "title": "Channel Name",
                  "type": "string"
                },
                "message_content": {
                  "description": "HTML content to send",
                  "order": 4,
                  "title": "Message Content",
                  "type": "string"
                },
                "team_name": {
                  "description": "Team name",
                  "order": 1,
                  "title": "Team Name",
                  "type": "string"
                },
                "thread_id": {
                  "description": "To post in a thread, select parent message ID",
                  "order": 3,
                  "title": "Thread ID",
                  "type": "string"
                }
              },
              "required": [
                "message_content",
                "team_name",
                "channel_name"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "definitions": {
                "body": {
                  "properties": {
                    "content": {
                      "description": "Content",
                      "order": 1,
                      "title": "Content",
                      "type": "string"
                    },
                    "contentType": {
                      "description": "Content type",
                      "order": 2,
                      "title": "Content Type",
                      "type": "string"
                    }
                  },
                  "title": "Body",
                  "type": "object"
                },
                "from": {
                  "properties": {
                    "user": {
                      "$ref": "#/definitions/user",
                      "description": "User",
                      "order": 1,
                      "title": "User"
                    }
                  },
                  "title": "From",
                  "type": "object"
                },
                "message": {
                  "properties": {
                    "body": {
                      "$ref": "#/definitions/body",
                      "description": "Body",
                      "order": 1,
                      "title": "Body"
                    },
                    "createdDateTime": {
                      "description": "Created date time",
                      "order": 3,
                      "title": "Created Date Time",
                      "type": "string"
                    },
                    "first_word": {
                      "description": "Extracted first word from message (easy way to obtain a chat command)",
                      "order": 9,
                      "title": "First Word",
                      "type": "string"
                    },
                    "from": {
                      "$ref": "#/definitions/from",
                      "description": "From",
                      "order": 2,
                      "title": "From"
                    },
                    "id": {
                      "description": "ID",
                      "order": 8,
                      "title": "ID",
                      "type": "string"
                    },
                    "importance": {
                      "description": "Importance",
                      "order": 5,
                      "title": "Importance",
                      "type": "string"
                    },
                    "locale": {
                      "description": "Locale",
                      "order": 7,
                      "title": "Locale",
                      "type": "string"
                    },
                    "messageType": {
                      "description": "Message type",
                      "order": 6,
                      "title": "Message Type",
                      "type": "string"
                    },
                    "webUrl": {
                      "description": "Web URL",
                      "order": 4,
                      "title": "Web URL",
                      "type": "string"
                    },
                    "words": {
                      "description": "The message split by spaces into a list of words. This list makes finding and using parameters in chat commands easier",
                      "items": {
                        "type": "string"
                      },
                      "order": 10,
                      "title": "Words",
                      "type": "array"
                    }
                  },
                  "required": [
                    "first_word",
                    "words"
                  ],
                  "title": "Message",
                  "type": "object"
                },
                "user": {
                  "properties": {
                    "displayName": {
                      "description": "Display name",
                      "order": 1,
                      "title": "Display name",
                      "type": "string"
                    },
                    "id": {
                      "description": "ID",
                      "order": 2,
                      "title": "ID",
                      "type": "string"
                    }
                  },
                  "title": "User",
                  "type": "object"
                }
              },
              "properties": {
                "message": {
                  "$ref": "#/definitions/message",
                  "description": "The message object that was created",
                  "order": 1,
                  "title": "Message"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          },
          "8c4d0f0c-7c1f-49e2-a428-3017029e2327": {
            "nodeId": "8c4d0f0c-7c1f-49e2-a428-3017029e2327",
            "name": "Lookup URL",
            "type": "action",
            "plugin": {
              "name": "VirusTotal",
              "slugVendor": "rapid7",
              "slugName": "virustotal",
              "slugVersion": "8.1.0",
              "imageData": "https://us.cdn-assets.connect.insight.rapid7.com/icons/rapid7/virustotal/8.1.0/icon.png"
            },
            "identifier": "scan_url_report",
            "continueOnFailure": false,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "url": "{{[24ea0051-2329-4d9b-a230-6aed47c9a85b].[$item]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "url": {
                  "description": "URL scanned",
                  "order": 1,
                  "title": "URL",
                  "type": "string"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "definitions": {
                "icon": {
                  "properties": {
                    "dhash": {
                      "description": "Difference hash",
                      "order": 1,
                      "title": "DHASH",
                      "type": "string"
                    },
                    "raw_md5": {
                      "description": "Icon's MD5 hash",
                      "order": 2,
                      "title": "Raw MD5",
                      "type": "string"
                    }
                  },
                  "title": "Icon",
                  "type": "object"
                },
                "last_analysis_result": {
                  "properties": {
                    "category": {
                      "description": "Category",
                      "order": 2,
                      "title": "Category",
                      "type": "string"
                    },
                    "engine_name": {
                      "description": "Engine name",
                      "order": 1,
                      "title": "Engine Name",
                      "type": "string"
                    },
                    "engine_update": {
                      "description": "Engine's last update date",
                      "order": 3,
                      "title": "Engine Update",
                      "type": "string"
                    },
                    "engine_version": {
                      "description": "Engine's version",
                      "order": 4,
                      "title": "Engine Version",
                      "type": "string"
                    },
                    "method": {
                      "description": "Detection method",
                      "order": 5,
                      "title": "Method",
                      "type": "string"
                    },
                    "result": {
                      "description": "Result",
                      "order": 6,
                      "title": "Result",
                      "type": "string"
                    }
                  },
                  "title": "Last Analysis Result",
                  "type": "object"
                },
                "last_analysis_stats": {
                  "properties": {
                    "harmless": {
                      "description": "Number of reports indicating harmless",
                      "order": 1,
                      "title": "Harmless",
                      "type": "integer"
                    },
                    "malicious": {
                      "description": "Number of reports indicating malicious",
                      "order": 2,
                      "title": "Malicious",
                      "type": "integer"
                    },
                    "suspicious": {
                      "description": "Number of reports indicating suspicious",
                      "order": 3,
                      "title": "Suspicious",
                      "type": "integer"
                    },
                    "timeout": {
                      "description": "Number of reports indicating timeout",
                      "order": 4,
                      "title": "Timeout",
                      "type": "integer"
                    },
                    "undetected": {
                      "description": "Number of reports indicating undetected",
                      "order": 5,
                      "title": "Undetected",
                      "type": "integer"
                    }
                  },
                  "title": "Last Analysis Stats",
                  "type": "object"
                },
                "total_votes": {
                  "properties": {
                    "harmless": {
                      "description": "Number of positive votes",
                      "order": 1,
                      "title": "Harmless",
                      "type": "integer"
                    },
                    "malicious": {
                      "description": "Number of negative votes",
                      "order": 2,
                      "title": "Malicious",
                      "type": "integer"
                    }
                  },
                  "title": "Total Votes",
                  "type": "object"
                },
                "url_report": {
                  "properties": {
                    "categories": {
                      "description": "Object, with the key as the partner who categorized the URL and the value as the URL's category according to that partner",
                      "order": 1,
                      "title": "Categories",
                      "type": "object"
                    },
                    "favicon": {
                      "$ref": "#/definitions/icon",
                      "description": "Dictionary including difference hash and MD5 hash of the URL's favicon",
                      "order": 2,
                      "title": "Favicon"
                    },
                    "first_submission_date": {
                      "description": "UTC timestamp of the date when the URL was first submitted to VirusTotal",
                      "order": 3,
                      "title": "First Submission Date",
                      "type": "integer"
                    },
                    "html_meta": {
                      "description": "Contains all meta tags (only for URLs downloading a HTML). Keys are meta tag names and values are lists containing all values of that meta tag",
                      "order": 4,
                      "title": "HTML Meta",
                      "type": "object"
                    },
                    "last_analysis_date": {
                      "description": "UTC timestamp representing last time the URL was scanned",
                      "order": 5,
                      "title": "Last Analysis Date",
                      "type": "integer"
                    },
                    "last_analysis_results": {
                      "description": "Result from URL scanners. Object with scanner name as key and an object with notes/result from that scanner as value",
                      "items": {
                        "$ref": "#/definitions/last_analysis_result"
                      },
                      "order": 6,
                      "title": "Last Analysis Results",
                      "type": "array"
                    },
                    "last_analysis_stats": {
                      "$ref": "#/definitions/last_analysis_stats",
                      "description": "Number of different results from this scan",
                      "order": 7,
                      "title": "Last Analysis Stats"
                    },
                    "last_final_url": {
                      "description": "Final URL in URL redirections",
                      "order": 8,
                      "title": "Last Final URL",
                      "type": "string"
                    },
                    "last_http_response_code": {
                      "description": "HTTP response code of the last response",
                      "order": 9,
                      "title": "Last HTTP Response Code",
                      "type": "integer"
                    },
                    "last_http_response_content_length": {
                      "description": "Length in bytes of the content received",
                      "order": 10,
                      "title": "Last HTTP Response Content Length",
                      "type": "integer"
                    },
                    "last_http_response_content_sha256": {
                      "description": "URL response body's SHA256 hash",
                      "order": 11,
                      "title": "Last HTTP Response Content SHA256",
                      "type": "string"
                    },
                    "last_http_response_cookies": {
                      "description": "Dictionary containing the website's cookies",
                      "order": 12,
                      "title": "Last HTTP Response Cookies",
                      "type": "object"
                    },
                    "last_http_response_headers": {
                      "description": "Dictionary containing headers and values of last HTTP response",
                      "order": 13,
                      "title": "Last HTTP Response Headers",
                      "type": "object"
                    },
                    "last_modification_date": {
                      "description": "UTC timestamp representing last modification date",
                      "order": 14,
                      "title": "Last Modification Date",
                      "type": "integer"
                    },
                    "last_submission_date": {
                      "description": "UTC timestamp representing last time it was sent to be analyzed",
                      "order": 15,
                      "title": "Last Submission Date",
                      "type": "integer"
                    },
                    "outgoing_links": {
                      "description": "List of links to outgoing domains",
                      "items": {
                        "type": "string"
                      },
                      "order": 16,
                      "title": "Outgoing Links",
                      "type": "array"
                    },
                    "reputation": {
                      "description": "Value of votes from VirusTotal community",
                      "order": 17,
                      "title": "Reputation",
                      "type": "integer"
                    },
                    "tags": {
                      "description": "Tags",
                      "items": {
                        "type": "string"
                      },
                      "order": 18,
                      "title": "Tags",
                      "type": "array"
                    },
                    "targeted_brand": {
                      "description": "Targeted brand info extracted from phishing engines",
                      "order": 19,
                      "title": "Targeted Brand",
                      "type": "object"
                    },
                    "times_submitted": {
                      "description": "Number of times that URL has been checked",
                      "order": 20,
                      "title": "Times Submitted",
                      "type": "integer"
                    },
                    "title": {
                      "description": "Webpage title",
                      "order": 21,
                      "title": "Title",
                      "type": "string"
                    },
                    "total_votes": {
                      "$ref": "#/definitions/total_votes",
                      "description": "Containing the number of positive (harmless) and negative (malicious) votes received from VirusTotal community",
                      "order": 22,
                      "title": "Total Votes"
                    },
                    "trackers": {
                      "description": "Object containing all found trackers in that URL in a historical manner",
                      "order": 23,
                      "title": "Trackers",
                      "type": "object"
                    },
                    "url": {
                      "description": "Original URL to be scanned",
                      "order": 24,
                      "title": "URL",
                      "type": "string"
                    }
                  },
                  "title": "Url Report",
                  "type": "object"
                }
              },
              "properties": {
                "found": {
                  "description": "True if found",
                  "order": 2,
                  "title": "Found",
                  "type": "boolean"
                },
                "report": {
                  "$ref": "#/definitions/url_report",
                  "description": "URL report",
                  "order": 1,
                  "title": "Report"
                }
              },
              "required": [
                "found"
              ],
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          },
          "8c8e5c9a-c89b-427e-81ce-1618320d87ce": {
            "nodeId": "8c8e5c9a-c89b-427e-81ce-1618320d87ce",
            "name": "No Indicators",
            "type": "artifact",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "content": "This alert did not contain any indicators for VirusTotal to analyze. \n\nThis workflow is now complete."
              },
              "type": "markdown"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://us.cdn-assets.connect.insight.rapid7.com/step-type-icons/artifact.svg",
            "connectionType": "NONE"
          },
          "aab694b7-7859-42c0-97c6-783c681371b6": {
            "nodeId": "aab694b7-7859-42c0-97c6-783c681371b6",
            "name": "Hash Message",
            "type": "action",
            "plugin": {
              "name": "Microsoft Teams",
              "slugVendor": "rapid7",
              "slugName": "microsoft_teams",
              "slugVersion": "3.1.5",
              "imageData": "https://us.cdn-assets.connect.insight.rapid7.com/icons/rapid7/microsoft_teams/3.1.5/icon.png"
            },
            "identifier": "send_html_message",
            "continueOnFailure": false,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "channel_name": "{{$workflow.[Channel Name]}}",
                "message_content": "<h2>Hash Report</h2>\n<br>\n<i>Hash report for {{[41ab1e00-636e-4702-80b5-4fff15161893].[$item].[hash]}}</i><br>\n<br>\nScan date (timestamp): {{[e629fe72-b425-480e-8e98-ea481d7438ee].[report].[last_analysis_date]}}<br>\nFound malicious by <code>{{[e629fe72-b425-480e-8e98-ea481d7438ee].[report].[last_analysis_stats].[malicious]}}</code> scans out of <code>{{[1f893118-34f1-4147-9297-16da8aec11c2].[result]}}</code> total.<br>\n<br>\nComplete VirusTotal Report: <a href=\"https://www.virustotal.com/gui/file/{{[e629fe72-b425-480e-8e98-ea481d7438ee].[report].[sha256]}}/detection\">https://www.virustotal.com/gui/file/{{[e629fe72-b425-480e-8e98-ea481d7438ee].[report].[sha256]}}/detection</a><br>",
                "team_name": "{{$workflow.[Team Name]}}",
                "thread_id": "{{[126c83e4-bdf1-40ba-9980-279e2174cc3d].[message].[id]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "channel_name": {
                  "description": "Channel name",
                  "order": 2,
                  "title": "Channel Name",
                  "type": "string"
                },
                "message_content": {
                  "description": "HTML content to send",
                  "order": 4,
                  "title": "Message Content",
                  "type": "string"
                },
                "team_name": {
                  "description": "Team name",
                  "order": 1,
                  "title": "Team Name",
                  "type": "string"
                },
                "thread_id": {
                  "description": "To post in a thread, select parent message ID",
                  "order": 3,
                  "title": "Thread ID",
                  "type": "string"
                }
              },
              "required": [
                "message_content",
                "team_name",
                "channel_name"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "definitions": {
                "body": {
                  "properties": {
                    "content": {
                      "description": "Content",
                      "order": 1,
                      "title": "Content",
                      "type": "string"
                    },
                    "contentType": {
                      "description": "Content type",
                      "order": 2,
                      "title": "Content Type",
                      "type": "string"
                    }
                  },
                  "title": "Body",
                  "type": "object"
                },
                "from": {
                  "properties": {
                    "user": {
                      "$ref": "#/definitions/user",
                      "description": "User",
                      "order": 1,
                      "title": "User"
                    }
                  },
                  "title": "From",
                  "type": "object"
                },
                "message": {
                  "properties": {
                    "body": {
                      "$ref": "#/definitions/body",
                      "description": "Body",
                      "order": 1,
                      "title": "Body"
                    },
                    "createdDateTime": {
                      "description": "Created date time",
                      "order": 3,
                      "title": "Created Date Time",
                      "type": "string"
                    },
                    "first_word": {
                      "description": "Extracted first word from message (easy way to obtain a chat command)",
                      "order": 9,
                      "title": "First Word",
                      "type": "string"
                    },
                    "from": {
                      "$ref": "#/definitions/from",
                      "description": "From",
                      "order": 2,
                      "title": "From"
                    },
                    "id": {
                      "description": "ID",
                      "order": 8,
                      "title": "ID",
                      "type": "string"
                    },
                    "importance": {
                      "description": "Importance",
                      "order": 5,
                      "title": "Importance",
                      "type": "string"
                    },
                    "locale": {
                      "description": "Locale",
                      "order": 7,
                      "title": "Locale",
                      "type": "string"
                    },
                    "messageType": {
                      "description": "Message type",
                      "order": 6,
                      "title": "Message Type",
                      "type": "string"
                    },
                    "webUrl": {
                      "description": "Web URL",
                      "order": 4,
                      "title": "Web URL",
                      "type": "string"
                    },
                    "words": {
                      "description": "The message split by spaces into a list of words. This list makes finding and using parameters in chat commands easier",
                      "items": {
                        "type": "string"
                      },
                      "order": 10,
                      "title": "Words",
                      "type": "array"
                    }
                  },
                  "required": [
                    "first_word",
                    "words"
                  ],
                  "title": "Message",
                  "type": "object"
                },
                "user": {
                  "properties": {
                    "displayName": {
                      "description": "Display name",
                      "order": 1,
                      "title": "Display name",
                      "type": "string"
                    },
                    "id": {
                      "description": "ID",
                      "order": 2,
                      "title": "ID",
                      "type": "string"
                    }
                  },
                  "title": "User",
                  "type": "object"
                }
              },
              "properties": {
                "message": {
                  "$ref": "#/definitions/message",
                  "description": "The message object that was created",
                  "order": 1,
                  "title": "Message"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          },
          "b9fe9505-1ef2-4855-9887-f548af14fd19": {
            "nodeId": "b9fe9505-1ef2-4855-9887-f548af14fd19",
            "name": "IP Address Not Found Message",
            "type": "action",
            "plugin": {
              "name": "Microsoft Teams",
              "slugVendor": "rapid7",
              "slugName": "microsoft_teams",
              "slugVersion": "3.1.5",
              "imageData": "https://us.cdn-assets.connect.insight.rapid7.com/icons/rapid7/microsoft_teams/3.1.5/icon.png"
            },
            "identifier": "send_html_message",
            "continueOnFailure": false,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "channel_name": "{{$workflow.[Channel Name]}}",
                "message_content": "<i>No reports found for {{[6098ca26-515f-4a15-94a3-2b587292d6b4].[$item].[ip]}}</i>",
                "team_name": "{{$workflow.[Team Name]}}",
                "thread_id": "{{[126c83e4-bdf1-40ba-9980-279e2174cc3d].[message].[id]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "channel_name": {
                  "description": "Channel name",
                  "order": 2,
                  "title": "Channel Name",
                  "type": "string"
                },
                "message_content": {
                  "description": "HTML content to send",
                  "order": 4,
                  "title": "Message Content",
                  "type": "string"
                },
                "team_name": {
                  "description": "Team name",
                  "order": 1,
                  "title": "Team Name",
                  "type": "string"
                },
                "thread_id": {
                  "description": "To post in a thread, select parent message ID",
                  "order": 3,
                  "title": "Thread ID",
                  "type": "string"
                }
              },
              "required": [
                "message_content",
                "team_name",
                "channel_name"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "definitions": {
                "body": {
                  "properties": {
                    "content": {
                      "description": "Content",
                      "order": 1,
                      "title": "Content",
                      "type": "string"
                    },
                    "contentType": {
                      "description": "Content type",
                      "order": 2,
                      "title": "Content Type",
                      "type": "string"
                    }
                  },
                  "title": "Body",
                  "type": "object"
                },
                "from": {
                  "properties": {
                    "user": {
                      "$ref": "#/definitions/user",
                      "description": "User",
                      "order": 1,
                      "title": "User"
                    }
                  },
                  "title": "From",
                  "type": "object"
                },
                "message": {
                  "properties": {
                    "body": {
                      "$ref": "#/definitions/body",
                      "description": "Body",
                      "order": 1,
                      "title": "Body"
                    },
                    "createdDateTime": {
                      "description": "Created date time",
                      "order": 3,
                      "title": "Created Date Time",
                      "type": "string"
                    },
                    "first_word": {
                      "description": "Extracted first word from message (easy way to obtain a chat command)",
                      "order": 9,
                      "title": "First Word",
                      "type": "string"
                    },
                    "from": {
                      "$ref": "#/definitions/from",
                      "description": "From",
                      "order": 2,
                      "title": "From"
                    },
                    "id": {
                      "description": "ID",
                      "order": 8,
                      "title": "ID",
                      "type": "string"
                    },
                    "importance": {
                      "description": "Importance",
                      "order": 5,
                      "title": "Importance",
                      "type": "string"
                    },
                    "locale": {
                      "description": "Locale",
                      "order": 7,
                      "title": "Locale",
                      "type": "string"
                    },
                    "messageType": {
                      "description": "Message type",
                      "order": 6,
                      "title": "Message Type",
                      "type": "string"
                    },
                    "webUrl": {
                      "description": "Web URL",
                      "order": 4,
                      "title": "Web URL",
                      "type": "string"
                    },
                    "words": {
                      "description": "The message split by spaces into a list of words. This list makes finding and using parameters in chat commands easier",
                      "items": {
                        "type": "string"
                      },
                      "order": 10,
                      "title": "Words",
                      "type": "array"
                    }
                  },
                  "required": [
                    "first_word",
                    "words"
                  ],
                  "title": "Message",
                  "type": "object"
                },
                "user": {
                  "properties": {
                    "displayName": {
                      "description": "Display name",
                      "order": 1,
                      "title": "Display name",
                      "type": "string"
                    },
                    "id": {
                      "description": "ID",
                      "order": 2,
                      "title": "ID",
                      "type": "string"
                    }
                  },
                  "title": "User",
                  "type": "object"
                }
              },
              "properties": {
                "message": {
                  "$ref": "#/definitions/message",
                  "description": "The message object that was created",
                  "order": 1,
                  "title": "Message"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          },
          "ba8bae4b-ae24-47c9-b635-3ebb9b6a934a": {
            "nodeId": "ba8bae4b-ae24-47c9-b635-3ebb9b6a934a",
            "name": "IDR Alert",
            "type": "trigger",
            "continueOnFailure": false,
            "isDisabled": false,
            "triggerId": "ed11d549-b669-498e-b9e2-9e4f33eccf55",
            "defaultInputJSONSchema": {
              "definitions": {
                "actor": {
                  "properties": {
                    "assets": {
                      "description": "The assets that are part of the investigation",
                      "items": {
                        "$ref": "#/definitions/asset"
                      },
                      "order": 2,
                      "title": "Assets",
                      "type": "array"
                    },
                    "users": {
                      "description": "The users that are part of the investigation",
                      "items": {
                        "$ref": "#/definitions/user"
                      },
                      "order": 1,
                      "title": "Users",
                      "type": "array"
                    }
                  },
                  "title": "Actor",
                  "type": "object"
                },
                "asset": {
                  "properties": {
                    "assetId": {
                      "description": "the ID of the asset",
                      "order": 1,
                      "title": "AssetId",
                      "type": "string"
                    },
                    "fqdn": {
                      "description": "The fully qualified domain name",
                      "order": 3,
                      "title": "Fqdn",
                      "type": "string"
                    },
                    "shortname": {
                      "description": "shortname of the asset",
                      "order": 2,
                      "title": "Shortname",
                      "type": "string"
                    }
                  },
                  "required": [
                    "shortname",
                    "assetId"
                  ],
                  "title": "Asset",
                  "type": "object"
                },
                "content": {
                  "properties": {
                    "domains": {
                      "description": "A list of domains to check",
                      "items": {
                        "type": "string"
                      },
                      "order": 2,
                      "title": "Domains",
                      "type": "array"
                    },
                    "ipAddresses": {
                      "description": "A list of ip addresses to check",
                      "items": {
                        "$ref": "#/definitions/ipAddress"
                      },
                      "order": 3,
                      "title": "IpAddresses",
                      "type": "array"
                    },
                    "processes": {
                      "description": "A list of processes to check",
                      "items": {
                        "$ref": "#/definitions/process"
                      },
                      "order": 4,
                      "title": "Processes",
                      "type": "array"
                    },
                    "urls": {
                      "description": "A list of URLs to check",
                      "items": {
                        "type": "string"
                      },
                      "order": 1,
                      "title": "Urls",
                      "type": "array"
                    }
                  },
                  "title": "Content",
                  "type": "object"
                },
                "hash": {
                  "properties": {
                    "hash": {
                      "description": "The actual hash",
                      "order": 1,
                      "title": "Hash",
                      "type": "string"
                    },
                    "type": {
                      "description": "The algorithm used to generate the hash",
                      "order": 2,
                      "title": "Type",
                      "type": "string"
                    }
                  },
                  "required": [
                    "hash",
                    "type"
                  ],
                  "title": "Hash",
                  "type": "object"
                },
                "ipAddress": {
                  "properties": {
                    "ip": {
                      "description": "The raw IP",
                      "order": 1,
                      "title": "Ip",
                      "type": "string"
                    },
                    "type": {
                      "description": "Denotes if an IP is internal or external",
                      "order": 2,
                      "title": "Type",
                      "type": "string"
                    }
                  },
                  "required": [
                    "ip",
                    "type"
                  ],
                  "title": "IpAddress",
                  "type": "object"
                },
                "process": {
                  "properties": {
                    "assetId": {
                      "description": "The asset id associated with the process",
                      "order": 1,
                      "title": "AssetId",
                      "type": "string"
                    },
                    "cmdLine": {
                      "description": "The raw value of the command line call used to invoke the process",
                      "order": 5,
                      "title": "CmdLine",
                      "type": "string"
                    },
                    "hashes": {
                      "description": "The list of hashes to check",
                      "items": {
                        "$ref": "#/definitions/hash"
                      },
                      "order": 3,
                      "title": "Hashes",
                      "type": "array"
                    },
                    "name": {
                      "description": "The name of the process",
                      "order": 4,
                      "title": "Name",
                      "type": "string"
                    },
                    "processId": {
                      "description": "The PID from the running process on the asset",
                      "order": 2,
                      "title": "ProcessId",
                      "type": "integer"
                    }
                  },
                  "required": [
                    "assetId",
                    "processId"
                  ],
                  "title": "Process",
                  "type": "object"
                },
                "user": {
                  "properties": {
                    "distinguishedName": {
                      "description": "The Active Directory distinguished name of the user",
                      "order": 2,
                      "title": "DistinguishedName",
                      "type": "string"
                    },
                    "emails": {
                      "description": "The email addresses associated with the user",
                      "items": {
                        "type": "string"
                      },
                      "order": 3,
                      "title": "Emails",
                      "type": "array"
                    },
                    "name": {
                      "description": "The name of the user, as '<firstname> <lastname>' if available, or account name otherwise",
                      "order": 1,
                      "title": "Name",
                      "type": "string"
                    }
                  },
                  "required": [
                    "name",
                    "emails"
                  ],
                  "title": "User",
                  "type": "object"
                }
              },
              "properties": {
                "actors": {
                  "$ref": "#/definitions/actor",
                  "description": "The insightIDR actors that are part of the investigation",
                  "order": 7,
                  "title": "Actors"
                },
                "contents": {
                  "$ref": "#/definitions/content",
                  "description": "The contents to enrich",
                  "order": 8,
                  "title": "Contents"
                },
                "description": {
                  "description": "The description of the alert",
                  "order": 4,
                  "title": "Description",
                  "type": "string"
                },
                "investigationId": {
                  "description": "The investigation id",
                  "order": 6,
                  "title": "InvestigationId",
                  "type": "string"
                },
                "link": {
                  "description": "The deep link to the investigation in insightIDR",
                  "order": 5,
                  "title": "Link",
                  "type": "string"
                },
                "name": {
                  "description": "The human-readable name of the alert",
                  "order": 3,
                  "title": "Name",
                  "type": "string"
                },
                "timestamp": {
                  "description": "The time the alert was triggered in ISO 8601 extended timestamp format",
                  "order": 1,
                  "title": "Timestamp",
                  "type": "string"
                },
                "type": {
                  "description": "The type of alert",
                  "order": 2,
                  "title": "Type",
                  "type": "string"
                }
              },
              "required": [
                "investigationId",
                "actors",
                "timestamp",
                "type",
                "name",
                "description",
                "link"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "definitions": {
                "actor": {
                  "properties": {
                    "assets": {
                      "description": "The assets that are part of the investigation",
                      "items": {
                        "$ref": "#/definitions/asset"
                      },
                      "order": 2,
                      "title": "Assets",
                      "type": "array"
                    },
                    "users": {
                      "description": "The users that are part of the investigation",
                      "items": {
                        "$ref": "#/definitions/user"
                      },
                      "order": 1,
                      "title": "Users",
                      "type": "array"
                    }
                  },
                  "title": "Actor",
                  "type": "object"
                },
                "asset": {
                  "properties": {
                    "assetId": {
                      "description": "the ID of the asset",
                      "order": 1,
                      "title": "AssetId",
                      "type": "string"
                    },
                    "fqdn": {
                      "description": "The fully qualified domain name",
                      "order": 3,
                      "title": "Fqdn",
                      "type": "string"
                    },
                    "shortname": {
                      "description": "shortname of the asset",
                      "order": 2,
                      "title": "Shortname",
                      "type": "string"
                    }
                  },
                  "required": [
                    "shortname",
                    "assetId"
                  ],
                  "title": "Asset",
                  "type": "object"
                },
                "content": {
                  "properties": {
                    "domains": {
                      "description": "A list of domains to check",
                      "items": {
                        "type": "string"
                      },
                      "order": 2,
                      "title": "Domains",
                      "type": "array"
                    },
                    "ipAddresses": {
                      "description": "A list of ip addresses to check",
                      "items": {
                        "$ref": "#/definitions/ipAddress"
                      },
                      "order": 3,
                      "title": "IpAddresses",
                      "type": "array"
                    },
                    "processes": {
                      "description": "A list of processes to check",
                      "items": {
                        "$ref": "#/definitions/process"
                      },
                      "order": 4,
                      "title": "Processes",
                      "type": "array"
                    },
                    "urls": {
                      "description": "A list of URLs to check",
                      "items": {
                        "type": "string"
                      },
                      "order": 1,
                      "title": "Urls",
                      "type": "array"
                    }
                  },
                  "title": "Content",
                  "type": "object"
                },
                "hash": {
                  "properties": {
                    "hash": {
                      "description": "The actual hash",
                      "order": 1,
                      "title": "Hash",
                      "type": "string"
                    },
                    "type": {
                      "description": "The algorithm used to generate the hash",
                      "order": 2,
                      "title": "Type",
                      "type": "string"
                    }
                  },
                  "required": [
                    "hash",
                    "type"
                  ],
                  "title": "Hash",
                  "type": "object"
                },
                "ipAddress": {
                  "properties": {
                    "ip": {
                      "description": "The raw IP",
                      "order": 1,
                      "title": "Ip",
                      "type": "string"
                    },
                    "type": {
                      "description": "Denotes if an IP is internal or external",
                      "order": 2,
                      "title": "Type",
                      "type": "string"
                    }
                  },
                  "required": [
                    "ip",
                    "type"
                  ],
                  "title": "IpAddress",
                  "type": "object"
                },
                "process": {
                  "properties": {
                    "assetId": {
                      "description": "The asset id associated with the process",
                      "order": 1,
                      "title": "AssetId",
                      "type": "string"
                    },
                    "cmdLine": {
                      "description": "The raw value of the command line call used to invoke the process",
                      "order": 5,
                      "title": "CmdLine",
                      "type": "string"
                    },
                    "hashes": {
                      "description": "The list of hashes to check",
                      "items": {
                        "$ref": "#/definitions/hash"
                      },
                      "order": 3,
                      "title": "Hashes",
                      "type": "array"
                    },
                    "name": {
                      "description": "The name of the process",
                      "order": 4,
                      "title": "Name",
                      "type": "string"
                    },
                    "processId": {
                      "description": "The PID from the running process on the asset",
                      "order": 2,
                      "title": "ProcessId",
                      "type": "integer"
                    }
                  },
                  "required": [
                    "assetId",
                    "processId"
                  ],
                  "title": "Process",
                  "type": "object"
                },
                "user": {
                  "properties": {
                    "distinguishedName": {
                      "description": "The Active Directory distinguished name of the user",
                      "order": 2,
                      "title": "DistinguishedName",
                      "type": "string"
                    },
                    "emails": {
                      "description": "The email addresses associated with the user",
                      "items": {
                        "type": "string"
                      },
                      "order": 3,
                      "title": "Emails",
                      "type": "array"
                    },
                    "name": {
                      "description": "The name of the user, as '<firstname> <lastname>' if available, or account name otherwise",
                      "order": 1,
                      "title": "Name",
                      "type": "string"
                    }
                  },
                  "required": [
                    "name",
                    "emails"
                  ],
                  "title": "User",
                  "type": "object"
                }
              },
              "properties": {
                "actors": {
                  "$ref": "#/definitions/actor",
                  "description": "The insightIDR actors that are part of the investigation",
                  "order": 7,
                  "title": "Actors"
                },
                "contents": {
                  "$ref": "#/definitions/content",
                  "description": "The contents to enrich",
                  "order": 8,
                  "title": "Contents"
                },
                "description": {
                  "description": "The description of the alert",
                  "order": 4,
                  "title": "Description",
                  "type": "string"
                },
                "investigationId": {
                  "description": "The investigation id",
                  "order": 6,
                  "title": "InvestigationId",
                  "type": "string"
                },
                "link": {
                  "description": "The deep link to the investigation in insightIDR",
                  "order": 5,
                  "title": "Link",
                  "type": "string"
                },
                "name": {
                  "description": "The human-readable name of the alert",
                  "order": 3,
                  "title": "Name",
                  "type": "string"
                },
                "timestamp": {
                  "description": "The time the alert was triggered in ISO 8601 extended timestamp format",
                  "order": 1,
                  "title": "Timestamp",
                  "type": "string"
                },
                "type": {
                  "description": "The type of alert",
                  "order": 2,
                  "title": "Type",
                  "type": "string"
                }
              },
              "required": [
                "investigationId",
                "actors",
                "timestamp",
                "type",
                "name",
                "description",
                "link"
              ],
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "https://us.cdn-assets.connect.insight.rapid7.com/step-type-icons/trigger-api-idr.svg",
            "connectionType": "NONE"
          },
          "ce760c8c-1172-42fb-b721-008c77fb2327": {
            "nodeId": "ce760c8c-1172-42fb-b721-008c77fb2327",
            "name": "URL Found?",
            "type": "automated_decision",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "defaultEdgeId": "5c36bc3d-2cec-4ff6-ac68-335ce045b2ce",
              "stepControlParams": [
                {
                  "edgeId": "5c36bc3d-2cec-4ff6-ac68-335ce045b2ce",
                  "expression": {},
                  "expressionText": ""
                },
                {
                  "edgeId": "9b11e6ea-cae5-4133-92c7-6b462f7b66e1",
                  "expression": {
                    "name": "8c4d0f0c-7c1f-49e2-a428-3017029e2327.found",
                    "type": "variable"
                  },
                  "expressionText": "{{[8c4d0f0c-7c1f-49e2-a428-3017029e2327].[found]}}"
                }
              ]
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://us.cdn-assets.connect.insight.rapid7.com/step-type-icons/automated-decision.svg",
            "connectionType": "NONE"
          },
          "ced04333-2cd7-450d-be1e-9d176c168644": {
            "nodeId": "ced04333-2cd7-450d-be1e-9d176c168644",
            "name": "Domain Report Message",
            "type": "action",
            "plugin": {
              "name": "Microsoft Teams",
              "slugVendor": "rapid7",
              "slugName": "microsoft_teams",
              "slugVersion": "3.1.5",
              "imageData": "https://us.cdn-assets.connect.insight.rapid7.com/icons/rapid7/microsoft_teams/3.1.5/icon.png"
            },
            "identifier": "send_html_message",
            "continueOnFailure": false,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "channel_name": "{{$workflow.[Channel Name]}}",
                "message_content": "<h2>Domain Report</h2>\n<br>\n<i>Report for {{[7847be03-2237-4036-b118-810ed591bcda].[$item]}}</i><br>\n<br>\nFound malicious by <code>{{[e74274ce-7292-49ce-8e45-cdfa7d4e5752].[report].[last_analysis_stats].[malicious]}}</code> scans out of <code>{{[e63da188-ac02-40c3-aca0-a98793b094a0].[result]}}</code> total.<br>\n<br>\nCategories:<br>\n<ul>\n{{#each [e74274ce-7292-49ce-8e45-cdfa7d4e5752].[report].[categories]}}\n<li>{{this}} ({{@key}})</li>\n{{/each}}\n</ul>\n<br>\nFull VirusTotal Report: <a href=\"https://www.virustotal.com/gui/domain/{{[7847be03-2237-4036-b118-810ed591bcda].[$item]}}/detection\">https://www.virustotal.com/gui/domain/{{[7847be03-2237-4036-b118-810ed591bcda].[$item]}}/detection</a><br>",
                "team_name": "{{$workflow.[Team Name]}}",
                "thread_id": "{{[126c83e4-bdf1-40ba-9980-279e2174cc3d].[message].[id]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "channel_name": {
                  "description": "Channel name",
                  "order": 2,
                  "title": "Channel Name",
                  "type": "string"
                },
                "message_content": {
                  "description": "HTML content to send",
                  "order": 4,
                  "title": "Message Content",
                  "type": "string"
                },
                "team_name": {
                  "description": "Team name",
                  "order": 1,
                  "title": "Team Name",
                  "type": "string"
                },
                "thread_id": {
                  "description": "To post in a thread, select parent message ID",
                  "order": 3,
                  "title": "Thread ID",
                  "type": "string"
                }
              },
              "required": [
                "message_content",
                "team_name",
                "channel_name"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "definitions": {
                "body": {
                  "properties": {
                    "content": {
                      "description": "Content",
                      "order": 1,
                      "title": "Content",
                      "type": "string"
                    },
                    "contentType": {
                      "description": "Content type",
                      "order": 2,
                      "title": "Content Type",
                      "type": "string"
                    }
                  },
                  "title": "Body",
                  "type": "object"
                },
                "from": {
                  "properties": {
                    "user": {
                      "$ref": "#/definitions/user",
                      "description": "User",
                      "order": 1,
                      "title": "User"
                    }
                  },
                  "title": "From",
                  "type": "object"
                },
                "message": {
                  "properties": {
                    "body": {
                      "$ref": "#/definitions/body",
                      "description": "Body",
                      "order": 1,
                      "title": "Body"
                    },
                    "createdDateTime": {
                      "description": "Created date time",
                      "order": 3,
                      "title": "Created Date Time",
                      "type": "string"
                    },
                    "first_word": {
                      "description": "Extracted first word from message (easy way to obtain a chat command)",
                      "order": 9,
                      "title": "First Word",
                      "type": "string"
                    },
                    "from": {
                      "$ref": "#/definitions/from",
                      "description": "From",
                      "order": 2,
                      "title": "From"
                    },
                    "id": {
                      "description": "ID",
                      "order": 8,
                      "title": "ID",
                      "type": "string"
                    },
                    "importance": {
                      "description": "Importance",
                      "order": 5,
                      "title": "Importance",
                      "type": "string"
                    },
                    "locale": {
                      "description": "Locale",
                      "order": 7,
                      "title": "Locale",
                      "type": "string"
                    },
                    "messageType": {
                      "description": "Message type",
                      "order": 6,
                      "title": "Message Type",
                      "type": "string"
                    },
                    "webUrl": {
                      "description": "Web URL",
                      "order": 4,
                      "title": "Web URL",
                      "type": "string"
                    },
                    "words": {
                      "description": "The message split by spaces into a list of words. This list makes finding and using parameters in chat commands easier",
                      "items": {
                        "type": "string"
                      },
                      "order": 10,
                      "title": "Words",
                      "type": "array"
                    }
                  },
                  "required": [
                    "first_word",
                    "words"
                  ],
                  "title": "Message",
                  "type": "object"
                },
                "user": {
                  "properties": {
                    "displayName": {
                      "description": "Display name",
                      "order": 1,
                      "title": "Display name",
                      "type": "string"
                    },
                    "id": {
                      "description": "ID",
                      "order": 2,
                      "title": "ID",
                      "type": "string"
                    }
                  },
                  "title": "User",
                  "type": "object"
                }
              },
              "properties": {
                "message": {
                  "$ref": "#/definitions/message",
                  "description": "The message object that was created",
                  "order": 1,
                  "title": "Message"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          },
          "d37f3dc7-b16f-43ac-872e-33d6d8c354e5": {
            "nodeId": "d37f3dc7-b16f-43ac-872e-33d6d8c354e5",
            "name": "IP Address Found?",
            "type": "automated_decision",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "defaultEdgeId": "2b4c22ec-73af-4399-8a23-6048a1e8c97f",
              "stepControlParams": [
                {
                  "edgeId": "2b4c22ec-73af-4399-8a23-6048a1e8c97f",
                  "expression": {},
                  "expressionText": ""
                },
                {
                  "edgeId": "5cd96d52-afe8-48c7-8999-5e4c84919153",
                  "expression": {
                    "name": "08fd10ab-d304-4b0c-9611-6427bc595c9a.found",
                    "type": "variable"
                  },
                  "expressionText": "{{[08fd10ab-d304-4b0c-9611-6427bc595c9a].[found]}}"
                }
              ]
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://us.cdn-assets.connect.insight.rapid7.com/step-type-icons/automated-decision.svg",
            "connectionType": "NONE"
          },
          "dc234514-a1c1-449c-8544-13f5b5dcd32a": {
            "nodeId": "dc234514-a1c1-449c-8544-13f5b5dcd32a",
            "name": "Hash Found?",
            "type": "automated_decision",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "defaultEdgeId": "54758277-f133-45ec-9259-406a8f906c14",
              "stepControlParams": [
                {
                  "edgeId": "54758277-f133-45ec-9259-406a8f906c14",
                  "expression": {},
                  "expressionText": ""
                },
                {
                  "edgeId": "cdfd55af-a982-4cad-8cf0-e6355fa2505c",
                  "expression": {
                    "name": "e629fe72-b425-480e-8e98-ea481d7438ee.found",
                    "type": "variable"
                  },
                  "expressionText": "{{[e629fe72-b425-480e-8e98-ea481d7438ee].[found]}}"
                }
              ]
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://us.cdn-assets.connect.insight.rapid7.com/step-type-icons/automated-decision.svg",
            "connectionType": "NONE"
          },
          "e218194b-b97b-4628-9025-8ffeccec8d63": {
            "nodeId": "e218194b-b97b-4628-9025-8ffeccec8d63",
            "name": "Hash URL",
            "type": "action",
            "plugin": {
              "name": "HashIt",
              "slugVendor": "rapid7",
              "slugName": "hashit",
              "slugVersion": "2.0.4",
              "imageData": "https://us.cdn-assets.connect.insight.rapid7.com/icons/rapid7/hashit/2.0.4/icon.png"
            },
            "identifier": "string",
            "continueOnFailure": false,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "string": "{{[8c4d0f0c-7c1f-49e2-a428-3017029e2327].[report].[url]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "string": {
                  "description": "String of text to hash",
                  "order": 1,
                  "title": "String",
                  "type": "string"
                }
              },
              "required": [
                "string"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "md5": {
                  "description": "MD5 hash",
                  "order": 1,
                  "title": "MD5 Hash",
                  "type": "string"
                },
                "sha1": {
                  "description": "SHA1 hash",
                  "order": 2,
                  "title": "SHA1 Hash",
                  "type": "string"
                },
                "sha256": {
                  "description": "SHA256 hash",
                  "order": 3,
                  "title": "SHA256 Hash",
                  "type": "string"
                },
                "sha512": {
                  "description": "SHA512 hash",
                  "order": 4,
                  "title": "SHA512 Hash",
                  "type": "string"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "ORCHESTRATOR"
          },
          "e629fe72-b425-480e-8e98-ea481d7438ee": {
            "nodeId": "e629fe72-b425-480e-8e98-ea481d7438ee",
            "name": "Lookup Hash",
            "type": "action",
            "plugin": {
              "name": "VirusTotal",
              "slugVendor": "rapid7",
              "slugName": "virustotal",
              "slugVersion": "8.1.0",
              "imageData": "https://us.cdn-assets.connect.insight.rapid7.com/icons/rapid7/virustotal/8.1.0/icon.png"
            },
            "identifier": "lookup_hash",
            "continueOnFailure": false,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "hash": "{{[41ab1e00-636e-4702-80b5-4fff15161893].[$item].[hash]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "hash": {
                  "description": "MD5/SHA1/SHA256 hash to lookup",
                  "order": 1,
                  "title": "Hash",
                  "type": "string"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "definitions": {
                "alert_context": {
                  "properties": {
                    "dest_ip": {
                      "description": "Destination IP",
                      "order": 1,
                      "title": "Destination IP",
                      "type": "string"
                    },
                    "dest_port": {
                      "description": "Destination port",
                      "order": 2,
                      "title": "Destination Port",
                      "type": "integer"
                    },
                    "hostname": {
                      "description": "In case the alert is related to an HTTP event, destination hostname",
                      "order": 3,
                      "title": "Hostname",
                      "type": "string"
                    },
                    "protocol": {
                      "description": "Communication protocol",
                      "order": 4,
                      "title": "Protocol",
                      "type": "string"
                    },
                    "src_ip": {
                      "description": "Source IP",
                      "order": 5,
                      "title": "Source IP",
                      "type": "string"
                    },
                    "src_port": {
                      "description": "Source port",
                      "order": 6,
                      "title": "Source Port",
                      "type": "integer"
                    },
                    "url": {
                      "description": "In case the alert is related to an HTTP event, destination URL",
                      "order": 7,
                      "title": "URL",
                      "type": "string"
                    }
                  },
                  "title": "Alert Context",
                  "type": "object"
                },
                "crowdsourced_ids_results": {
                  "properties": {
                    "alert_context": {
                      "description": "Context for every match of that alert",
                      "items": {
                        "$ref": "#/definitions/alert_context"
                      },
                      "order": 1,
                      "title": "Alert Context",
                      "type": "array"
                    },
                    "alert_severity": {
                      "description": "Alert severity",
                      "order": 2,
                      "title": "Alert Severity",
                      "type": "string"
                    },
                    "rule_category": {
                      "description": "Alert category description",
                      "order": 3,
                      "title": "Rule Category",
                      "type": "string"
                    },
                    "rule_id": {
                      "description": "Suricata/Snort rule SID",
                      "order": 4,
                      "title": "Rule ID",
                      "type": "string"
                    },
                    "rule_msg": {
                      "description": "Alert description",
                      "order": 5,
                      "title": "Rule Message",
                      "type": "string"
                    },
                    "rule_source": {
                      "description": "Rule source, determined by SID range",
                      "order": 6,
                      "title": "Rule Source",
                      "type": "string"
                    }
                  },
                  "title": "Crowdsourced Ids Results",
                  "type": "object"
                },
                "crowdsourced_ids_stats": {
                  "properties": {
                    "high": {
                      "description": "Number of matched rules having a high severity",
                      "order": 1,
                      "title": "High",
                      "type": "integer"
                    },
                    "info": {
                      "description": "Number of matched rules having an info severity",
                      "order": 2,
                      "title": "Info",
                      "type": "integer"
                    },
                    "low": {
                      "description": "Number of matched rules having a low severity",
                      "order": 3,
                      "title": "Low",
                      "type": "integer"
                    },
                    "medium": {
                      "description": "Number of matched rules having a medium severity",
                      "order": 4,
                      "title": "Medium",
                      "type": "integer"
                    }
                  },
                  "title": "Crowdsourced Ids Stats",
                  "type": "object"
                },
                "crowdsourced_yara_results": {
                  "properties": {
                    "author": {
                      "description": "Rule author",
                      "order": 1,
                      "title": "Author",
                      "type": "string"
                    },
                    "description": {
                      "description": "Matched rule description",
                      "order": 2,
                      "title": "Description",
                      "type": "string"
                    },
                    "match_in_subfile": {
                      "description": "Whether the match was in a subfile or not",
                      "order": 3,
                      "title": "Match in Subfile",
                      "type": "boolean"
                    },
                    "rule_name": {
                      "description": "Matched rule name",
                      "order": 4,
                      "title": "Rule Name",
                      "type": "string"
                    },
                    "ruleset_id": {
                      "description": "VirusTotal's ruleset ID",
                      "order": 5,
                      "title": "Ruleset ID",
                      "type": "string"
                    },
                    "ruleset_name": {
                      "description": "Matched rule's ruleset name",
                      "order": 6,
                      "title": "Ruleset Name",
                      "type": "string"
                    },
                    "source": {
                      "description": "Ruleset source",
                      "order": 7,
                      "title": "Source",
                      "type": "string"
                    }
                  },
                  "title": "Crowdsourced Yara Results",
                  "type": "object"
                },
                "file_report": {
                  "properties": {
                    "capabilities_tags": {
                      "description": "List of representative tags related to the file's capabilities",
                      "items": {
                        "type": "string"
                      },
                      "order": 1,
                      "title": "Capabilities Tags",
                      "type": "array"
                    },
                    "creation_date": {
                      "description": "Extracted when possible from the file's metadata. Indicates when it was built or compiled. It can also be faked by malware creators. UTC timestamp",
                      "order": 2,
                      "title": "Creation Date",
                      "type": "integer"
                    },
                    "crowdsourced_ids_results": {
                      "description": "IDS (Snort and Suricata) matches for the file. If the file is not a PCAP, the matches are taken from a PCAP generated after running the file in a sandbox",
                      "items": {
                        "$ref": "#/definitions/crowdsourced_ids_results"
                      },
                      "order": 3,
                      "title": "Crowdsourced IDS Results",
                      "type": "array"
                    },
                    "crowdsourced_ids_stats": {
                      "$ref": "#/definitions/crowdsourced_ids_stats",
                      "description": "IDS results stats",
                      "order": 4,
                      "title": "Crowdsourced IDS Stats"
                    },
                    "crowdsourced_yara_results": {
                      "description": "YARA matches for the file",
                      "items": {
                        "$ref": "#/definitions/crowdsourced_yara_results"
                      },
                      "order": 5,
                      "title": "Crowdsourced YARA Results",
                      "type": "array"
                    },
                    "downloadable": {
                      "description": "True if the file can be downloaded, false otherwise",
                      "order": 6,
                      "title": "Downloadable",
                      "type": "boolean"
                    },
                    "first_submission_date": {
                      "description": "Date when the file was first seen in VirusTotal (UTC timestamp)",
                      "order": 7,
                      "title": "First Submission Date",
                      "type": "integer"
                    },
                    "last_analysis_date": {
                      "description": "Most recent scan date (UTC timestamp)",
                      "order": 8,
                      "title": "Last Analysis Date",
                      "type": "integer"
                    },
                    "last_analysis_results": {
                      "description": "Latest scan results. For more information about its format, check the Analysis object results attribute",
                      "items": {
                        "$ref": "#/definitions/last_analysis_result"
                      },
                      "order": 9,
                      "title": "Last Analysis Results",
                      "type": "array"
                    },
                    "last_analysis_stats": {
                      "$ref": "#/definitions/last_analysis_stats",
                      "description": "A summary of the latest scan results",
                      "order": 10,
                      "title": "Last Analysis Stats"
                    },
                    "last_modification_date": {
                      "description": "Date when the object itself was last modified (UTC timestamp)",
                      "order": 11,
                      "title": "Last Modification Date",
                      "type": "integer"
                    },
                    "last_submission_date": {
                      "description": "Most recent date the file was posted to VirusTotal (UTC timestamp)",
                      "order": 12,
                      "title": "Last Submission Date",
                      "type": "integer"
                    },
                    "main_icon": {
                      "$ref": "#/definitions/icon",
                      "description": "Dictionary including difference hash and MD5 hash of the main icon",
                      "order": 13,
                      "title": "Main Icon"
                    },
                    "md5": {
                      "description": "File's MD5 hash",
                      "order": 14,
                      "title": "MD5",
                      "type": "string"
                    },
                    "meaningful_name": {
                      "description": "The most interesting name out of all file's names",
                      "order": 15,
                      "title": "Meaningful Name",
                      "type": "string"
                    },
                    "names": {
                      "description": "All file names associated with the file",
                      "items": {
                        "type": "string"
                      },
                      "order": 16,
                      "title": "Names",
                      "type": "array"
                    },
                    "reputation": {
                      "description": "File's score calculated from all votes posted by the VirusTotal community",
                      "order": 17,
                      "title": "Reputation",
                      "type": "integer"
                    },
                    "sandbox_verdicts": {
                      "description": "A summary of all sandbox verdicts for a given file",
                      "order": 18,
                      "title": "Sandbox Verdicts",
                      "type": "object"
                    },
                    "sha1": {
                      "description": "File's SHA1 hash",
                      "order": 19,
                      "title": "SHA1",
                      "type": "string"
                    },
                    "sha256": {
                      "description": "File's SHA256 hash",
                      "order": 20,
                      "title": "SHA256",
                      "type": "string"
                    },
                    "sigma_analysis_stats": {
                      "$ref": "#/definitions/sigma_analysis",
                      "description": "Dictionary containing the number of matched sigma rules, grouped by its severity",
                      "order": 21,
                      "title": "Sigma Analysis Stats"
                    },
                    "sigma_analysis_summary": {
                      "$ref": "#/definitions/sigma_analysis",
                      "description": "Dictionary containing the number of matched sigma rules group by its severity",
                      "order": 22,
                      "title": "Sigma Analysis Summary"
                    },
                    "size": {
                      "description": "File size in bytes",
                      "order": 23,
                      "title": "Size",
                      "type": "integer"
                    },
                    "tags": {
                      "description": "List of representative attributes",
                      "items": {
                        "type": "string"
                      },
                      "order": 24,
                      "title": "Tags",
                      "type": "array"
                    },
                    "times_submitted": {
                      "description": "Number of times the file has been posted to VirusTotal",
                      "order": 25,
                      "title": "Times Submitted",
                      "type": "integer"
                    },
                    "total_votes": {
                      "$ref": "#/definitions/total_votes",
                      "description": "Unweighted number of total votes from the community, divided by harmless and malicious",
                      "order": 26,
                      "title": "Total Votes"
                    },
                    "type_description": {
                      "description": "Describes the file type",
                      "order": 27,
                      "title": "Type Description",
                      "type": "string"
                    },
                    "type_extension": {
                      "description": "Specifies file extension",
                      "order": 28,
                      "title": "Type Extension",
                      "type": "string"
                    },
                    "type_tag": {
                      "description": "Tag representing the file type",
                      "order": 29,
                      "title": "Type Tag",
                      "type": "string"
                    },
                    "unique_sources": {
                      "description": "Indicates from how many different sources the file has been posted from",
                      "order": 30,
                      "title": "Unique Sources",
                      "type": "integer"
                    },
                    "vhash": {
                      "description": "In-house similarity clustering algorithm value, based on a simple structural feature hash allowing you to find similar files",
                      "order": 31,
                      "title": "VHASH",
                      "type": "string"
                    }
                  },
                  "title": "File Report",
                  "type": "object"
                },
                "icon": {
                  "properties": {
                    "dhash": {
                      "description": "Difference hash",
                      "order": 1,
                      "title": "DHASH",
                      "type": "string"
                    },
                    "raw_md5": {
                      "description": "Icon's MD5 hash",
                      "order": 2,
                      "title": "Raw MD5",
                      "type": "string"
                    }
                  },
                  "title": "Icon",
                  "type": "object"
                },
                "last_analysis_result": {
                  "properties": {
                    "category": {
                      "description": "Category",
                      "order": 2,
                      "title": "Category",
                      "type": "string"
                    },
                    "engine_name": {
                      "description": "Engine name",
                      "order": 1,
                      "title": "Engine Name",
                      "type": "string"
                    },
                    "engine_update": {
                      "description": "Engine's last update date",
                      "order": 3,
                      "title": "Engine Update",
                      "type": "string"
                    },
                    "engine_version": {
                      "description": "Engine's version",
                      "order": 4,
                      "title": "Engine Version",
                      "type": "string"
                    },
                    "method": {
                      "description": "Detection method",
                      "order": 5,
                      "title": "Method",
                      "type": "string"
                    },
                    "result": {
                      "description": "Result",
                      "order": 6,
                      "title": "Result",
                      "type": "string"
                    }
                  },
                  "title": "Last Analysis Result",
                  "type": "object"
                },
                "last_analysis_stats": {
                  "properties": {
                    "harmless": {
                      "description": "Number of reports indicating harmless",
                      "order": 1,
                      "title": "Harmless",
                      "type": "integer"
                    },
                    "malicious": {
                      "description": "Number of reports indicating malicious",
                      "order": 2,
                      "title": "Malicious",
                      "type": "integer"
                    },
                    "suspicious": {
                      "description": "Number of reports indicating suspicious",
                      "order": 3,
                      "title": "Suspicious",
                      "type": "integer"
                    },
                    "timeout": {
                      "description": "Number of reports indicating timeout",
                      "order": 4,
                      "title": "Timeout",
                      "type": "integer"
                    },
                    "undetected": {
                      "description": "Number of reports indicating undetected",
                      "order": 5,
                      "title": "Undetected",
                      "type": "integer"
                    }
                  },
                  "title": "Last Analysis Stats",
                  "type": "object"
                },
                "sigma_analysis": {
                  "properties": {
                    "critical": {
                      "description": "Number of matched critical severity rules/rulesets",
                      "order": 1,
                      "title": "Critical",
                      "type": "integer"
                    },
                    "high": {
                      "description": "Number of matched high severity rules/rulesets",
                      "order": 2,
                      "title": "High",
                      "type": "integer"
                    },
                    "low": {
                      "description": "Number of matched low severity rules/rulesets",
                      "order": 3,
                      "title": "Low",
                      "type": "integer"
                    },
                    "medium": {
                      "description": "Number of matched medium severity rules/rulesets",
                      "order": 4,
                      "title": "Medium",
                      "type": "integer"
                    }
                  },
                  "title": "Sigma Analysis",
                  "type": "object"
                },
                "total_votes": {
                  "properties": {
                    "harmless": {
                      "description": "Number of positive votes",
                      "order": 1,
                      "title": "Harmless",
                      "type": "integer"
                    },
                    "malicious": {
                      "description": "Number of negative votes",
                      "order": 2,
                      "title": "Malicious",
                      "type": "integer"
                    }
                  },
                  "title": "Total Votes",
                  "type": "object"
                }
              },
              "properties": {
                "found": {
                  "description": "True if found",
                  "order": 2,
                  "title": "Found",
                  "type": "boolean"
                },
                "report": {
                  "$ref": "#/definitions/file_report",
                  "description": "Hash report",
                  "order": 1,
                  "title": "Report"
                }
              },
              "required": [
                "found"
              ],
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          },
          "e63da188-ac02-40c3-aca0-a98793b094a0": {
            "nodeId": "e63da188-ac02-40c3-aca0-a98793b094a0",
            "name": "Calculate Total Domain Reports",
            "type": "action",
            "plugin": {
              "name": "Math",
              "slugVendor": "rapid7",
              "slugName": "math",
              "slugVersion": "1.2.1",
              "imageData": "https://us.cdn-assets.connect.insight.rapid7.com/icons/rapid7/math/1.2.1/icon.png"
            },
            "identifier": "calculate",
            "continueOnFailure": false,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "equation": "{{[e74274ce-7292-49ce-8e45-cdfa7d4e5752].[report].[last_analysis_stats].[malicious]}} + {{[e74274ce-7292-49ce-8e45-cdfa7d4e5752].[report].[last_analysis_stats].[harmless]}} + {{[e74274ce-7292-49ce-8e45-cdfa7d4e5752].[report].[last_analysis_stats].[suspicious]}} + {{[e74274ce-7292-49ce-8e45-cdfa7d4e5752].[report].[last_analysis_stats].[undetected]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "equation": {
                  "description": "Equation to calculate. Uses Python arithmetic operators (+, -, /, *, **, %)",
                  "order": 1,
                  "title": "Equation",
                  "type": "string"
                }
              },
              "required": [
                "equation"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "result": {
                  "description": "Result of the arithmetic operation",
                  "order": 1,
                  "title": "Result",
                  "type": "number"
                }
              },
              "required": [
                "result"
              ],
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "ORCHESTRATOR"
          },
          "e74274ce-7292-49ce-8e45-cdfa7d4e5752": {
            "nodeId": "e74274ce-7292-49ce-8e45-cdfa7d4e5752",
            "name": "Lookup Domain",
            "type": "action",
            "plugin": {
              "name": "VirusTotal",
              "slugVendor": "rapid7",
              "slugName": "virustotal",
              "slugVersion": "8.1.0",
              "imageData": "https://us.cdn-assets.connect.insight.rapid7.com/icons/rapid7/virustotal/8.1.0/icon.png"
            },
            "identifier": "domain_report",
            "continueOnFailure": false,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "domain": "{{[7847be03-2237-4036-b118-810ed591bcda].[$item]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "domain": {
                  "description": "Domain name",
                  "order": 1,
                  "title": "Domain",
                  "type": "string"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "definitions": {
                "authority_key_identifier": {
                  "properties": {
                    "keyid": {
                      "description": "Key hexdump",
                      "order": 1,
                      "title": "Key ID",
                      "type": "string"
                    },
                    "serial_number": {
                      "description": "Serial number hexdump",
                      "order": 2,
                      "title": "Serial Number",
                      "type": "string"
                    }
                  },
                  "title": "Authority Key Identifier",
                  "type": "object"
                },
                "cert_signature": {
                  "properties": {
                    "signature": {
                      "description": "Signature hexdump",
                      "order": 1,
                      "title": "Signature",
                      "type": "string"
                    },
                    "signature_algorithm": {
                      "description": "Used algorithm",
                      "order": 2,
                      "title": "Signature Algorithm",
                      "type": "string"
                    }
                  },
                  "title": "Cert Signature",
                  "type": "object"
                },
                "domain_report": {
                  "properties": {
                    "categories": {
                      "description": "Mapping that relates categorization services with the assigned domain category. These services are, among others: Alexa, BitDefender, TrendMicro, Websense ThreatSeeker, etc.",
                      "order": 1,
                      "title": "Categories",
                      "type": "object"
                    },
                    "creation_date": {
                      "description": "Creation date extracted from the Domain's WHOIS (UTC timestamp)",
                      "order": 2,
                      "title": "Creation Date",
                      "type": "integer"
                    },
                    "favicon": {
                      "$ref": "#/definitions/icon",
                      "description": "Dictionary including difference hash and MD5 hash of the domain's favicon",
                      "order": 3,
                      "title": "Favicon"
                    },
                    "last_analysis_results": {
                      "description": "Result from URL scanners. Object with scanner name as key and an object with notes/result from that scanner as value",
                      "items": {
                        "$ref": "#/definitions/last_analysis_result"
                      },
                      "order": 4,
                      "title": "Last Analysis Results",
                      "type": "array"
                    },
                    "last_analysis_stats": {
                      "$ref": "#/definitions/last_analysis_stats",
                      "description": "Number of different results from this scan",
                      "order": 5,
                      "title": "Last Analysis Statistics"
                    },
                    "last_dns_records": {
                      "description": "Domain's DNS records on its last scan",
                      "items": {
                        "$ref": "#/definitions/last_dns_records"
                      },
                      "order": 6,
                      "title": "Last DNS Records",
                      "type": "array"
                    },
                    "last_dns_records_date": {
                      "description": "Date when the DNS records list was retrieved by VirusTotal (UTC timestamp)",
                      "order": 7,
                      "title": "Last DNS Records Date",
                      "type": "integer"
                    },
                    "last_https_certificate": {
                      "$ref": "#/definitions/ssl_certificate",
                      "description": "SSL certificate object retrieved last time the domain was analyzed",
                      "order": 8,
                      "title": "Last HTTPS Certificate"
                    },
                    "last_https_certificate_date": {
                      "description": "Date when the certificate was retrieved by VirusTotal (UTC timestamp)",
                      "order": 9,
                      "title": "Last HTTPS Certificate Date",
                      "type": "integer"
                    },
                    "last_modification_date": {
                      "description": "Date when any of the domain's information was last updated",
                      "order": 10,
                      "title": "Last Modification Date",
                      "type": "integer"
                    },
                    "last_update_date": {
                      "description": "Updated date extracted from WHOIS (UTC timestamp)",
                      "order": 11,
                      "title": "Last Update Date",
                      "type": "integer"
                    },
                    "popularity_ranks": {
                      "$ref": "#/definitions/popularity_ranks",
                      "description": "Domain's position in popularity ranks such as Alexa, Quantcast, Statvoo, etc.",
                      "order": 12,
                      "title": "Popularity Ranks"
                    },
                    "registrar": {
                      "description": "Company that registered the domain",
                      "order": 13,
                      "title": "Registrar",
                      "type": "string"
                    },
                    "reputation": {
                      "description": "Domain's score calculated from the votes of the VirusTotal's community",
                      "order": 14,
                      "title": "Reputation",
                      "type": "integer"
                    },
                    "tags": {
                      "description": "List of representative attributes",
                      "items": {
                        "type": "string"
                      },
                      "order": 15,
                      "title": "Tags",
                      "type": "array"
                    },
                    "total_votes": {
                      "$ref": "#/definitions/total_votes",
                      "description": "Unweighted number of total votes from the community, divided in harmless and malicious",
                      "order": 16,
                      "title": "Total Votes"
                    },
                    "whois": {
                      "description": "WHOIS information as returned from the pertinent WHOIS server",
                      "order": 17,
                      "title": "WHOIS",
                      "type": "string"
                    },
                    "whois_date": {
                      "description": "Date of the last update of the WHOIS record in VirusTotal",
                      "order": 18,
                      "title": "WHOIS Date",
                      "type": "integer"
                    }
                  },
                  "title": "Domain Report",
                  "type": "object"
                },
                "dsa": {
                  "properties": {
                    "g": {
                      "description": "G component hexdump",
                      "order": 3,
                      "title": "G",
                      "type": "string"
                    },
                    "p": {
                      "description": "P component hexdump",
                      "order": 1,
                      "title": "P",
                      "type": "string"
                    },
                    "pub": {
                      "description": "Public key hexdump",
                      "order": 4,
                      "title": "Public",
                      "type": "string"
                    },
                    "q": {
                      "description": "Q component hexdump",
                      "order": 2,
                      "title": "Q",
                      "type": "string"
                    }
                  },
                  "title": "Dsa",
                  "type": "object"
                },
                "ec": {
                  "properties": {
                    "oid": {
                      "description": "Curve name",
                      "order": 1,
                      "title": "OID",
                      "type": "string"
                    },
                    "pub": {
                      "description": "Public key hexdump",
                      "order": 2,
                      "title": "Public",
                      "type": "string"
                    }
                  },
                  "title": "Ec",
                  "type": "object"
                },
                "icon": {
                  "properties": {
                    "dhash": {
                      "description": "Difference hash",
                      "order": 1,
                      "title": "DHASH",
                      "type": "string"
                    },
                    "raw_md5": {
                      "description": "Icon's MD5 hash",
                      "order": 2,
                      "title": "Raw MD5",
                      "type": "string"
                    }
                  },
                  "title": "Icon",
                  "type": "object"
                },
                "last_analysis_result": {
                  "properties": {
                    "category": {
                      "description": "Category",
                      "order": 2,
                      "title": "Category",
                      "type": "string"
                    },
                    "engine_name": {
                      "description": "Engine name",
                      "order": 1,
                      "title": "Engine Name",
                      "type": "string"
                    },
                    "engine_update": {
                      "description": "Engine's last update date",
                      "order": 3,
                      "title": "Engine Update",
                      "type": "string"
                    },
                    "engine_version": {
                      "description": "Engine's version",
                      "order": 4,
                      "title": "Engine Version",
                      "type": "string"
                    },
                    "method": {
                      "description": "Detection method",
                      "order": 5,
                      "title": "Method",
                      "type": "string"
                    },
                    "result": {
                      "description": "Result",
                      "order": 6,
                      "title": "Result",
                      "type": "string"
                    }
                  },
                  "title": "Last Analysis Result",
                  "type": "object"
                },
                "last_analysis_stats": {
                  "properties": {
                    "harmless": {
                      "description": "Number of reports indicating harmless",
                      "order": 1,
                      "title": "Harmless",
                      "type": "integer"
                    },
                    "malicious": {
                      "description": "Number of reports indicating malicious",
                      "order": 2,
                      "title": "Malicious",
                      "type": "integer"
                    },
                    "suspicious": {
                      "description": "Number of reports indicating suspicious",
                      "order": 3,
                      "title": "Suspicious",
                      "type": "integer"
                    },
                    "timeout": {
                      "description": "Number of reports indicating timeout",
                      "order": 4,
                      "title": "Timeout",
                      "type": "integer"
                    },
                    "undetected": {
                      "description": "Number of reports indicating undetected",
                      "order": 5,
                      "title": "Undetected",
                      "type": "integer"
                    }
                  },
                  "title": "Last Analysis Stats",
                  "type": "object"
                },
                "last_dns_records": {
                  "properties": {
                    "expire": {
                      "description": "Expire",
                      "order": 1,
                      "title": "Expire",
                      "type": "integer"
                    },
                    "flag": {
                      "description": "Flag",
                      "order": 2,
                      "title": "Flag",
                      "type": "integer"
                    },
                    "minimum": {
                      "description": "Minimum",
                      "order": 3,
                      "title": "Minimum",
                      "type": "integer"
                    },
                    "priority": {
                      "description": "Priority",
                      "order": 4,
                      "title": "Priority",
                      "type": "integer"
                    },
                    "refresh": {
                      "description": "Refresh",
                      "order": 5,
                      "title": "Refresh",
                      "type": "integer"
                    },
                    "retry": {
                      "description": "Retry",
                      "order": 7,
                      "title": "Retry",
                      "type": "integer"
                    },
                    "rname": {
                      "description": "RNAME",
                      "order": 6,
                      "title": "RNAME",
                      "type": "string"
                    },
                    "serial": {
                      "description": "Serial",
                      "order": 8,
                      "title": "Serial",
                      "type": "integer"
                    },
                    "tag": {
                      "description": "Tag",
                      "order": 9,
                      "title": "Tag",
                      "type": "string"
                    },
                    "ttl": {
                      "description": "Time to live",
                      "order": 10,
                      "title": "TTL",
                      "type": "integer"
                    },
                    "type": {
                      "description": "Type",
                      "order": 11,
                      "title": "Type",
                      "type": "string"
                    },
                    "value": {
                      "description": "Value",
                      "order": 12,
                      "title": "Value",
                      "type": "string"
                    }
                  },
                  "title": "Last Dns Records",
                  "type": "object"
                },
                "popularity_ranks": {
                  "properties": {
                    "rank": {
                      "description": "Rank position",
                      "order": 1,
                      "title": "Rank",
                      "type": "integer"
                    },
                    "timestamp": {
                      "description": "UTC timestamp when the rank was ingested",
                      "order": 2,
                      "title": "Timestamp",
                      "type": "integer"
                    }
                  },
                  "title": "Popularity Ranks",
                  "type": "object"
                },
                "public_key": {
                  "properties": {
                    "algorithm": {
                      "description": "Indicates the algorithm used to generate the certificate",
                      "order": 1,
                      "title": "Algorithm",
                      "type": "string"
                    },
                    "dsa": {
                      "$ref": "#/definitions/dsa",
                      "description": "DSA public key information",
                      "order": 3,
                      "title": "DSA"
                    },
                    "ec": {
                      "$ref": "#/definitions/ec",
                      "description": "EC public key information",
                      "order": 4,
                      "title": "EC"
                    },
                    "rsa": {
                      "$ref": "#/definitions/rsa",
                      "description": "RSA public key information",
                      "order": 2,
                      "title": "RSA"
                    }
                  },
                  "title": "Public Key",
                  "type": "object"
                },
                "rsa": {
                  "properties": {
                    "exponent": {
                      "description": "Key exponent hexdump",
                      "order": 3,
                      "title": "Exponent",
                      "type": "string"
                    },
                    "key_size": {
                      "description": "Key size",
                      "order": 1,
                      "title": "Key Size",
                      "type": "integer"
                    },
                    "modulus": {
                      "description": "Key modulus hexdump",
                      "order": 2,
                      "title": "Modulus",
                      "type": "string"
                    }
                  },
                  "title": "Rsa",
                  "type": "object"
                },
                "ssl_certificate": {
                  "properties": {
                    "cert_signature": {
                      "$ref": "#/definitions/cert_signature",
                      "description": "Dictionary containing certificate's signature and algorithm",
                      "order": 1,
                      "title": "Certificate Signature"
                    },
                    "extensions": {
                      "$ref": "#/definitions/ssl_extensions",
                      "description": "Dictionary containing all certificate's extensions",
                      "order": 2,
                      "title": "Extensions"
                    },
                    "first_seen_date": {
                      "description": "Date the certificate was first retrieved by VirusTotal",
                      "order": 3,
                      "title": "First Seen Date",
                      "type": "integer"
                    },
                    "issuer": {
                      "$ref": "#/definitions/ssl_data",
                      "description": "Dictionary containing the certificate's issuer data",
                      "order": 4,
                      "title": "Issuer"
                    },
                    "public_key": {
                      "$ref": "#/definitions/public_key",
                      "description": "Subject public key info",
                      "order": 5,
                      "title": "Public Key"
                    },
                    "serial_number": {
                      "description": "Certificate's serial number hexdump",
                      "order": 6,
                      "title": "Serial Number",
                      "type": "string"
                    },
                    "signature_algorithm": {
                      "description": "Algorithm used for the signature",
                      "order": 7,
                      "title": "Signature Algorithm",
                      "type": "string"
                    },
                    "size": {
                      "description": "Certificate content length",
                      "order": 8,
                      "title": "Size",
                      "type": "integer"
                    },
                    "subject": {
                      "$ref": "#/definitions/ssl_data",
                      "description": "Dictionary containing the certificate's subject data",
                      "order": 9,
                      "title": "Subject"
                    },
                    "thumbprint": {
                      "description": "Certificate's content SHA1 hash",
                      "order": 10,
                      "title": "Thumbprint",
                      "type": "string"
                    },
                    "thumbprint_sha256": {
                      "description": "Certificate's content SHA256 hash",
                      "order": 11,
                      "title": "Thumbprint SHA256",
                      "type": "string"
                    },
                    "validity": {
                      "$ref": "#/definitions/validity",
                      "description": "Defines certificate's validity period",
                      "order": 12,
                      "title": "Validity"
                    },
                    "version": {
                      "description": "Certificate version",
                      "order": 13,
                      "title": "Version",
                      "type": "string"
                    }
                  },
                  "title": "Ssl Certificate",
                  "type": "object"
                },
                "ssl_data": {
                  "properties": {
                    "C": {
                      "description": "Country name",
                      "order": 1,
                      "title": "Country Name",
                      "type": "string"
                    },
                    "CN": {
                      "description": "Common name",
                      "order": 2,
                      "title": "Common Name",
                      "type": "string"
                    },
                    "L": {
                      "description": "Locality",
                      "order": 3,
                      "title": "Locality",
                      "type": "string"
                    },
                    "O": {
                      "description": "Organization",
                      "order": 4,
                      "title": "Organization",
                      "type": "string"
                    },
                    "OU": {
                      "description": "Organizational unit",
                      "order": 5,
                      "title": "Organizational Unit",
                      "type": "string"
                    },
                    "ST": {
                      "description": "State or province name",
                      "order": 6,
                      "title": "State or Province Name",
                      "type": "string"
                    }
                  },
                  "title": "Ssl Data",
                  "type": "object"
                },
                "ssl_extensions": {
                  "properties": {
                    "authority_key_identifier": {
                      "$ref": "#/definitions/authority_key_identifier",
                      "description": "Identifies the public key to be used to verify the signature on this certificate or CRL",
                      "order": 3,
                      "title": "Authority Key Identifier"
                    },
                    "ca": {
                      "description": "Whether the subject acts as a CA or not",
                      "order": 1,
                      "title": "CA",
                      "type": "boolean"
                    },
                    "ca_information_access": {
                      "description": "Authority information access locations are URLs that are added to a certificate in its authority information access extension",
                      "order": 5,
                      "title": "CA Information Access",
                      "type": "object"
                    },
                    "cert_template_name_dc": {
                      "description": "BMP data value DomainController, see MS Q291010",
                      "order": 10,
                      "title": "Certificate Template Name DC",
                      "type": "string"
                    },
                    "certificate_policies": {
                      "description": "Different certificate policies will relate to different applications which may use the certified key",
                      "items": {
                        "type": "string"
                      },
                      "order": 8,
                      "title": "Certificate Policies",
                      "type": "array"
                    },
                    "crl_distribution_points": {
                      "description": "Identifies the CRL distribution points to which a certificate user should refer to ascertain if the certificate has been revoked",
                      "items": {
                        "type": "string"
                      },
                      "order": 6,
                      "title": "CRL Distribution Points",
                      "type": "array"
                    },
                    "key_usage": {
                      "description": "Indicates the purpose for which the certified public key is used",
                      "items": {
                        "type": "string"
                      },
                      "order": 4,
                      "title": "Key Usage",
                      "type": "array"
                    },
                    "netscape_cert_comment": {
                      "description": "Used to include free-form text comments inside certificates",
                      "order": 9,
                      "title": "Netscape Certificate Comment",
                      "type": "string"
                    },
                    "netscape_certificate": {
                      "description": "Identify whether the certificate subject is an SSL client, an SSL server, or a CA",
                      "order": 11,
                      "title": "Netscape Certificate",
                      "type": "boolean"
                    },
                    "old_authority_key_identifier": {
                      "description": "Whether the certificate has an old authority key identifier extension",
                      "order": 13,
                      "title": "Old Authority Key Identifier",
                      "type": "boolean"
                    },
                    "pe_logotype": {
                      "description": "Whether the certificate includes a logotype",
                      "order": 12,
                      "title": "PE Logotype",
                      "type": "boolean"
                    },
                    "subject_alternative_name": {
                      "description": "Contains one or more alternative names, using any of a variety of name forms, for the entity that is bound by the CA to the certified public key",
                      "items": {
                        "type": "string"
                      },
                      "order": 7,
                      "title": "Subject Alternative Name",
                      "type": "array"
                    },
                    "subject_key_identifier": {
                      "description": "Identifies the public key being certified",
                      "order": 2,
                      "title": "Subject Key Identifier",
                      "type": "string"
                    }
                  },
                  "title": "Ssl Extensions",
                  "type": "object"
                },
                "total_votes": {
                  "properties": {
                    "harmless": {
                      "description": "Number of positive votes",
                      "order": 1,
                      "title": "Harmless",
                      "type": "integer"
                    },
                    "malicious": {
                      "description": "Number of negative votes",
                      "order": 2,
                      "title": "Malicious",
                      "type": "integer"
                    }
                  },
                  "title": "Total Votes",
                  "type": "object"
                },
                "validity": {
                  "properties": {
                    "not_after": {
                      "description": "Expiry date in %Y-%m-%d %H:%M:%S format",
                      "order": 1,
                      "title": "Not After",
                      "type": "string"
                    },
                    "not_before": {
                      "description": "Issue date in %Y-%m-%d %H:%M:%S format",
                      "order": 2,
                      "title": "Not Before",
                      "type": "string"
                    }
                  },
                  "title": "Validity",
                  "type": "object"
                }
              },
              "properties": {
                "found": {
                  "description": "True if found",
                  "order": 2,
                  "title": "Found",
                  "type": "boolean"
                },
                "report": {
                  "$ref": "#/definitions/domain_report",
                  "description": "Domain report",
                  "order": 1,
                  "title": "Report"
                }
              },
              "required": [
                "found"
              ],
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          },
          "e96d520e-38ed-4265-85a3-eede6419ea69": {
            "nodeId": "e96d520e-38ed-4265-85a3-eede6419ea69",
            "name": "IP Address Artifact",
            "type": "artifact",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "content": "## IP Address Report\n\n*Report for {{[6098ca26-515f-4a15-94a3-2b587292d6b4].[$item].[ip]}}*\n\n{{#if [08fd10ab-d304-4b0c-9611-6427bc595c9a].[report].[country]}}\nHosting country: {{[08fd10ab-d304-4b0c-9611-6427bc595c9a].[report].[country]}}\n{{/if}}\n{{#if [08fd10ab-d304-4b0c-9611-6427bc595c9a].[report].[network]}}\nNetwork: {{[08fd10ab-d304-4b0c-9611-6427bc595c9a].[report].[network]}}\n{{/if}}\n{{#if [08fd10ab-d304-4b0c-9611-6427bc595c9a].[report].[asn]}}\nASN: {{[08fd10ab-d304-4b0c-9611-6427bc595c9a].[report].[asn]}}\n{{/if}}\n{{#if [08fd10ab-d304-4b0c-9611-6427bc595c9a].[report].[reputation]}}\nReputation: {{[08fd10ab-d304-4b0c-9611-6427bc595c9a].[report].[reputation]}}\n{{/if}}\nFound malicious by `{{[08fd10ab-d304-4b0c-9611-6427bc595c9a].[report].[last_analysis_stats].[malicious]}}` scans out of `{{[6542b420-735c-4fa4-ae53-872c46e983fb].[result]}}` total.\n\nComplete VirusTotal Report: [https://www.virustotal.com/gui/ip-address/{{[6098ca26-515f-4a15-94a3-2b587292d6b4].[$item].[ip]}}](https://www.virustotal.com/gui/ip-address/{{[6098ca26-515f-4a15-94a3-2b587292d6b4].[$item].[ip]}})\n"
              },
              "type": "markdown"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://us.cdn-assets.connect.insight.rapid7.com/step-type-icons/artifact.svg",
            "connectionType": "NONE"
          },
          "e988c51e-cac0-4670-80b2-0ad9fe7e42ad": {
            "nodeId": "e988c51e-cac0-4670-80b2-0ad9fe7e42ad",
            "name": "URL Not Found Message",
            "type": "action",
            "plugin": {
              "name": "Microsoft Teams",
              "slugVendor": "rapid7",
              "slugName": "microsoft_teams",
              "slugVersion": "3.1.5",
              "imageData": "https://us.cdn-assets.connect.insight.rapid7.com/icons/rapid7/microsoft_teams/3.1.5/icon.png"
            },
            "identifier": "send_html_message",
            "continueOnFailure": false,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "channel_name": "{{$workflow.[Channel Name]}}",
                "message_content": "<i>No reports found for {{[8c4d0f0c-7c1f-49e2-a428-3017029e2327].[report].[url]}}</i>",
                "team_name": "{{$workflow.[Team Name]}}",
                "thread_id": "{{[126c83e4-bdf1-40ba-9980-279e2174cc3d].[message].[id]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "channel_name": {
                  "description": "Channel name",
                  "order": 2,
                  "title": "Channel Name",
                  "type": "string"
                },
                "message_content": {
                  "description": "HTML content to send",
                  "order": 4,
                  "title": "Message Content",
                  "type": "string"
                },
                "team_name": {
                  "description": "Team name",
                  "order": 1,
                  "title": "Team Name",
                  "type": "string"
                },
                "thread_id": {
                  "description": "To post in a thread, select parent message ID",
                  "order": 3,
                  "title": "Thread ID",
                  "type": "string"
                }
              },
              "required": [
                "message_content",
                "team_name",
                "channel_name"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "definitions": {
                "body": {
                  "properties": {
                    "content": {
                      "description": "Content",
                      "order": 1,
                      "title": "Content",
                      "type": "string"
                    },
                    "contentType": {
                      "description": "Content type",
                      "order": 2,
                      "title": "Content Type",
                      "type": "string"
                    }
                  },
                  "title": "Body",
                  "type": "object"
                },
                "from": {
                  "properties": {
                    "user": {
                      "$ref": "#/definitions/user",
                      "description": "User",
                      "order": 1,
                      "title": "User"
                    }
                  },
                  "title": "From",
                  "type": "object"
                },
                "message": {
                  "properties": {
                    "body": {
                      "$ref": "#/definitions/body",
                      "description": "Body",
                      "order": 1,
                      "title": "Body"
                    },
                    "createdDateTime": {
                      "description": "Created date time",
                      "order": 3,
                      "title": "Created Date Time",
                      "type": "string"
                    },
                    "first_word": {
                      "description": "Extracted first word from message (easy way to obtain a chat command)",
                      "order": 9,
                      "title": "First Word",
                      "type": "string"
                    },
                    "from": {
                      "$ref": "#/definitions/from",
                      "description": "From",
                      "order": 2,
                      "title": "From"
                    },
                    "id": {
                      "description": "ID",
                      "order": 8,
                      "title": "ID",
                      "type": "string"
                    },
                    "importance": {
                      "description": "Importance",
                      "order": 5,
                      "title": "Importance",
                      "type": "string"
                    },
                    "locale": {
                      "description": "Locale",
                      "order": 7,
                      "title": "Locale",
                      "type": "string"
                    },
                    "messageType": {
                      "description": "Message type",
                      "order": 6,
                      "title": "Message Type",
                      "type": "string"
                    },
                    "webUrl": {
                      "description": "Web URL",
                      "order": 4,
                      "title": "Web URL",
                      "type": "string"
                    },
                    "words": {
                      "description": "The message split by spaces into a list of words. This list makes finding and using parameters in chat commands easier",
                      "items": {
                        "type": "string"
                      },
                      "order": 10,
                      "title": "Words",
                      "type": "array"
                    }
                  },
                  "required": [
                    "first_word",
                    "words"
                  ],
                  "title": "Message",
                  "type": "object"
                },
                "user": {
                  "properties": {
                    "displayName": {
                      "description": "Display name",
                      "order": 1,
                      "title": "Display name",
                      "type": "string"
                    },
                    "id": {
                      "description": "ID",
                      "order": 2,
                      "title": "ID",
                      "type": "string"
                    }
                  },
                  "title": "User",
                  "type": "object"
                }
              },
              "properties": {
                "message": {
                  "$ref": "#/definitions/message",
                  "description": "The message object that was created",
                  "order": 1,
                  "title": "Message"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          },
          "efedb489-0e07-4a9e-99c6-395a7d5f0090": {
            "nodeId": "efedb489-0e07-4a9e-99c6-395a7d5f0090",
            "name": "Domain Not Found Message",
            "type": "action",
            "plugin": {
              "name": "Microsoft Teams",
              "slugVendor": "rapid7",
              "slugName": "microsoft_teams",
              "slugVersion": "3.1.5",
              "imageData": "https://us.cdn-assets.connect.insight.rapid7.com/icons/rapid7/microsoft_teams/3.1.5/icon.png"
            },
            "identifier": "send_html_message",
            "continueOnFailure": false,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "channel_name": "{{$workflow.[Channel Name]}}",
                "message_content": "<i>No reports found for {{[7847be03-2237-4036-b118-810ed591bcda].[$item]}}</i>",
                "team_name": "{{$workflow.[Team Name]}}",
                "thread_id": "{{[126c83e4-bdf1-40ba-9980-279e2174cc3d].[message].[id]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "channel_name": {
                  "description": "Channel name",
                  "order": 2,
                  "title": "Channel Name",
                  "type": "string"
                },
                "message_content": {
                  "description": "HTML content to send",
                  "order": 4,
                  "title": "Message Content",
                  "type": "string"
                },
                "team_name": {
                  "description": "Team name",
                  "order": 1,
                  "title": "Team Name",
                  "type": "string"
                },
                "thread_id": {
                  "description": "To post in a thread, select parent message ID",
                  "order": 3,
                  "title": "Thread ID",
                  "type": "string"
                }
              },
              "required": [
                "message_content",
                "team_name",
                "channel_name"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "definitions": {
                "body": {
                  "properties": {
                    "content": {
                      "description": "Content",
                      "order": 1,
                      "title": "Content",
                      "type": "string"
                    },
                    "contentType": {
                      "description": "Content type",
                      "order": 2,
                      "title": "Content Type",
                      "type": "string"
                    }
                  },
                  "title": "Body",
                  "type": "object"
                },
                "from": {
                  "properties": {
                    "user": {
                      "$ref": "#/definitions/user",
                      "description": "User",
                      "order": 1,
                      "title": "User"
                    }
                  },
                  "title": "From",
                  "type": "object"
                },
                "message": {
                  "properties": {
                    "body": {
                      "$ref": "#/definitions/body",
                      "description": "Body",
                      "order": 1,
                      "title": "Body"
                    },
                    "createdDateTime": {
                      "description": "Created date time",
                      "order": 3,
                      "title": "Created Date Time",
                      "type": "string"
                    },
                    "first_word": {
                      "description": "Extracted first word from message (easy way to obtain a chat command)",
                      "order": 9,
                      "title": "First Word",
                      "type": "string"
                    },
                    "from": {
                      "$ref": "#/definitions/from",
                      "description": "From",
                      "order": 2,
                      "title": "From"
                    },
                    "id": {
                      "description": "ID",
                      "order": 8,
                      "title": "ID",
                      "type": "string"
                    },
                    "importance": {
                      "description": "Importance",
                      "order": 5,
                      "title": "Importance",
                      "type": "string"
                    },
                    "locale": {
                      "description": "Locale",
                      "order": 7,
                      "title": "Locale",
                      "type": "string"
                    },
                    "messageType": {
                      "description": "Message type",
                      "order": 6,
                      "title": "Message Type",
                      "type": "string"
                    },
                    "webUrl": {
                      "description": "Web URL",
                      "order": 4,
                      "title": "Web URL",
                      "type": "string"
                    },
                    "words": {
                      "description": "The message split by spaces into a list of words. This list makes finding and using parameters in chat commands easier",
                      "items": {
                        "type": "string"
                      },
                      "order": 10,
                      "title": "Words",
                      "type": "array"
                    }
                  },
                  "required": [
                    "first_word",
                    "words"
                  ],
                  "title": "Message",
                  "type": "object"
                },
                "user": {
                  "properties": {
                    "displayName": {
                      "description": "Display name",
                      "order": 1,
                      "title": "Display name",
                      "type": "string"
                    },
                    "id": {
                      "description": "ID",
                      "order": 2,
                      "title": "ID",
                      "type": "string"
                    }
                  },
                  "title": "User",
                  "type": "object"
                }
              },
              "properties": {
                "message": {
                  "$ref": "#/definitions/message",
                  "description": "The message object that was created",
                  "order": 1,
                  "title": "Message"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          },
          "f6c5881d-3b2e-4217-b531-80dca5efef74": {
            "nodeId": "f6c5881d-3b2e-4217-b531-80dca5efef74",
            "name": "Alert Information Artifact",
            "type": "artifact",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "content": "**IDR Alert Contents**\n\n{{#if [ba8bae4b-ae24-47c9-b635-3ebb9b6a934a].[contents].[urls]}}\nURLs:\n{{#each [ba8bae4b-ae24-47c9-b635-3ebb9b6a934a].[contents].[urls]}}\n+ {{this}}\n{{/each}}\n{{/if}}\n\n{{#if [ba8bae4b-ae24-47c9-b635-3ebb9b6a934a].[contents].[domains]}}\nDomains:\n{{#each [ba8bae4b-ae24-47c9-b635-3ebb9b6a934a].[contents].[domains]}}\n+ {{this}}\n{{/each}}\n{{/if}}\n\n{{#if [ba8bae4b-ae24-47c9-b635-3ebb9b6a934a].[contents].[processes]}}\nHashes:\n{{#each [ba8bae4b-ae24-47c9-b635-3ebb9b6a934a].[contents].[processes]}}\n{{#if hashes}}\n{{#each hashes}}\n* {{hash}} ({{type}})\n{{/each}}\n{{/if}}\n{{/each}}\n{{/if}}\n\n{{#if [ba8bae4b-ae24-47c9-b635-3ebb9b6a934a].[contents].[ipAddresses]}}\nIP Addresses:\n{{#each [ba8bae4b-ae24-47c9-b635-3ebb9b6a934a].[contents].[ipAddresses]}}\n{{#if ip}}\n* {{ip}}\n{{/if}}\n{{/each}}\n{{/if}}\n\n"
              },
              "type": "markdown"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://us.cdn-assets.connect.insight.rapid7.com/step-type-icons/artifact.svg",
            "connectionType": "NONE"
          },
          "f8a3f205-93c8-4bdb-bbd9-86c9573d0fe6": {
            "nodeId": "f8a3f205-93c8-4bdb-bbd9-86c9573d0fe6",
            "name": "URL Artifact",
            "type": "artifact",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "content": "## URL Report\n\n*Report for {{[24ea0051-2329-4d9b-a230-6aed47c9a85b].[$item]}}*\n\nScan date (timestamp): {{[8c4d0f0c-7c1f-49e2-a428-3017029e2327].[report].[last_analysis_date]}}\nFound malicious by `{{[8c4d0f0c-7c1f-49e2-a428-3017029e2327].[report].[last_analysis_stats].[malicious]}}` scans out of `{{[36cc3723-5878-4174-9eec-7e04b1885816].[result]}}` total.\n\nFull VirusTotal Report: [https://www.virustotal.com/gui/url/{{[e218194b-b97b-4628-9025-8ffeccec8d63].[sha256]}}/details](https://www.virustotal.com/gui/url/{{[e218194b-b97b-4628-9025-8ffeccec8d63].[sha256]}}/details)"
              },
              "type": "markdown"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://us.cdn-assets.connect.insight.rapid7.com/step-type-icons/artifact.svg",
            "connectionType": "NONE"
          }
        },
        "tags": [
          "Rapid7",
          "Threat Intelligence",
          "Virustotal"
        ],
        "humanCostSeconds": 600,
        "humanCostDisplayUnit": "minutes",
        "parameters": {
          "definitionSchema": {
            "type": "object",
            "required": [],
            "properties": {
              "Team Name": {
                "type": "string",
                "description": "The Microsoft Teams team name in your environment where the workflow should be triggered and respond"
              },
              "Channel Name": {
                "type": "string",
                "description": "The Microsoft Teams channel name in your environment where the workflow should be triggered and respond (the channel should exist in the aforementioned team)"
              }
            },
            "definitions": {}
          }
        },
        "summary": ""
      }
    ],
    "triggers": [
      {
        "id": "ed11d549-b669-498e-b9e2-9e4f33eccf55",
        "name": "IDR Alert",
        "description": "",
        "input": null,
        "inputJsonSchema": {
          "definitions": {
            "actor": {
              "properties": {
                "assets": {
                  "description": "The assets that are part of the investigation",
                  "items": {
                    "$ref": "#/definitions/asset"
                  },
                  "order": 2,
                  "title": "Assets",
                  "type": "array"
                },
                "users": {
                  "description": "The users that are part of the investigation",
                  "items": {
                    "$ref": "#/definitions/user"
                  },
                  "order": 1,
                  "title": "Users",
                  "type": "array"
                }
              },
              "title": "Actor",
              "type": "object"
            },
            "asset": {
              "properties": {
                "assetId": {
                  "description": "the ID of the asset",
                  "order": 1,
                  "title": "AssetId",
                  "type": "string"
                },
                "fqdn": {
                  "description": "The fully qualified domain name",
                  "order": 3,
                  "title": "Fqdn",
                  "type": "string"
                },
                "shortname": {
                  "description": "shortname of the asset",
                  "order": 2,
                  "title": "Shortname",
                  "type": "string"
                }
              },
              "required": [
                "shortname",
                "assetId"
              ],
              "title": "Asset",
              "type": "object"
            },
            "content": {
              "properties": {
                "domains": {
                  "description": "A list of domains to check",
                  "items": {
                    "type": "string"
                  },
                  "order": 2,
                  "title": "Domains",
                  "type": "array"
                },
                "ipAddresses": {
                  "description": "A list of ip addresses to check",
                  "items": {
                    "$ref": "#/definitions/ipAddress"
                  },
                  "order": 3,
                  "title": "IpAddresses",
                  "type": "array"
                },
                "processes": {
                  "description": "A list of processes to check",
                  "items": {
                    "$ref": "#/definitions/process"
                  },
                  "order": 4,
                  "title": "Processes",
                  "type": "array"
                },
                "urls": {
                  "description": "A list of URLs to check",
                  "items": {
                    "type": "string"
                  },
                  "order": 1,
                  "title": "Urls",
                  "type": "array"
                }
              },
              "title": "Content",
              "type": "object"
            },
            "hash": {
              "properties": {
                "hash": {
                  "description": "The actual hash",
                  "order": 1,
                  "title": "Hash",
                  "type": "string"
                },
                "type": {
                  "description": "The algorithm used to generate the hash",
                  "order": 2,
                  "title": "Type",
                  "type": "string"
                }
              },
              "required": [
                "hash",
                "type"
              ],
              "title": "Hash",
              "type": "object"
            },
            "ipAddress": {
              "properties": {
                "ip": {
                  "description": "The raw IP",
                  "order": 1,
                  "title": "Ip",
                  "type": "string"
                },
                "type": {
                  "description": "Denotes if an IP is internal or external",
                  "order": 2,
                  "title": "Type",
                  "type": "string"
                }
              },
              "required": [
                "ip",
                "type"
              ],
              "title": "IpAddress",
              "type": "object"
            },
            "process": {
              "properties": {
                "assetId": {
                  "description": "The asset id associated with the process",
                  "order": 1,
                  "title": "AssetId",
                  "type": "string"
                },
                "cmdLine": {
                  "description": "The raw value of the command line call used to invoke the process",
                  "order": 5,
                  "title": "CmdLine",
                  "type": "string"
                },
                "hashes": {
                  "description": "The list of hashes to check",
                  "items": {
                    "$ref": "#/definitions/hash"
                  },
                  "order": 3,
                  "title": "Hashes",
                  "type": "array"
                },
                "name": {
                  "description": "The name of the process",
                  "order": 4,
                  "title": "Name",
                  "type": "string"
                },
                "processId": {
                  "description": "The PID from the running process on the asset",
                  "order": 2,
                  "title": "ProcessId",
                  "type": "integer"
                }
              },
              "required": [
                "assetId",
                "processId"
              ],
              "title": "Process",
              "type": "object"
            },
            "user": {
              "properties": {
                "distinguishedName": {
                  "description": "The Active Directory distinguished name of the user",
                  "order": 2,
                  "title": "DistinguishedName",
                  "type": "string"
                },
                "emails": {
                  "description": "The email addresses associated with the user",
                  "items": {
                    "type": "string"
                  },
                  "order": 3,
                  "title": "Emails",
                  "type": "array"
                },
                "name": {
                  "description": "The name of the user, as '<firstname> <lastname>' if available, or account name otherwise",
                  "order": 1,
                  "title": "Name",
                  "type": "string"
                }
              },
              "required": [
                "name",
                "emails"
              ],
              "title": "User",
              "type": "object"
            }
          },
          "properties": {
            "actors": {
              "$ref": "#/definitions/actor",
              "description": "The insightIDR actors that are part of the investigation",
              "order": 7,
              "title": "Actors"
            },
            "contents": {
              "$ref": "#/definitions/content",
              "description": "The contents to enrich",
              "order": 8,
              "title": "Contents"
            },
            "description": {
              "description": "The description of the alert",
              "order": 4,
              "title": "Description",
              "type": "string"
            },
            "investigationId": {
              "description": "The investigation id",
              "order": 6,
              "title": "InvestigationId",
              "type": "string"
            },
            "link": {
              "description": "The deep link to the investigation in insightIDR",
              "order": 5,
              "title": "Link",
              "type": "string"
            },
            "name": {
              "description": "The human-readable name of the alert",
              "order": 3,
              "title": "Name",
              "type": "string"
            },
            "timestamp": {
              "description": "The time the alert was triggered in ISO 8601 extended timestamp format",
              "order": 1,
              "title": "Timestamp",
              "type": "string"
            },
            "type": {
              "description": "The type of alert",
              "order": 2,
              "title": "Type",
              "type": "string"
            }
          },
          "required": [
            "investigationId",
            "actors",
            "timestamp",
            "type",
            "name",
            "description",
            "link"
          ],
          "title": "Variables",
          "type": "object"
        },
        "outputJsonSchema": {
          "definitions": {
            "actor": {
              "properties": {
                "assets": {
                  "description": "The assets that are part of the investigation",
                  "items": {
                    "$ref": "#/definitions/asset"
                  },
                  "order": 2,
                  "title": "Assets",
                  "type": "array"
                },
                "users": {
                  "description": "The users that are part of the investigation",
                  "items": {
                    "$ref": "#/definitions/user"
                  },
                  "order": 1,
                  "title": "Users",
                  "type": "array"
                }
              },
              "title": "Actor",
              "type": "object"
            },
            "asset": {
              "properties": {
                "assetId": {
                  "description": "the ID of the asset",
                  "order": 1,
                  "title": "AssetId",
                  "type": "string"
                },
                "fqdn": {
                  "description": "The fully qualified domain name",
                  "order": 3,
                  "title": "Fqdn",
                  "type": "string"
                },
                "shortname": {
                  "description": "shortname of the asset",
                  "order": 2,
                  "title": "Shortname",
                  "type": "string"
                }
              },
              "required": [
                "shortname",
                "assetId"
              ],
              "title": "Asset",
              "type": "object"
            },
            "content": {
              "properties": {
                "domains": {
                  "description": "A list of domains to check",
                  "items": {
                    "type": "string"
                  },
                  "order": 2,
                  "title": "Domains",
                  "type": "array"
                },
                "ipAddresses": {
                  "description": "A list of ip addresses to check",
                  "items": {
                    "$ref": "#/definitions/ipAddress"
                  },
                  "order": 3,
                  "title": "IpAddresses",
                  "type": "array"
                },
                "processes": {
                  "description": "A list of processes to check",
                  "items": {
                    "$ref": "#/definitions/process"
                  },
                  "order": 4,
                  "title": "Processes",
                  "type": "array"
                },
                "urls": {
                  "description": "A list of URLs to check",
                  "items": {
                    "type": "string"
                  },
                  "order": 1,
                  "title": "Urls",
                  "type": "array"
                }
              },
              "title": "Content",
              "type": "object"
            },
            "hash": {
              "properties": {
                "hash": {
                  "description": "The actual hash",
                  "order": 1,
                  "title": "Hash",
                  "type": "string"
                },
                "type": {
                  "description": "The algorithm used to generate the hash",
                  "order": 2,
                  "title": "Type",
                  "type": "string"
                }
              },
              "required": [
                "hash",
                "type"
              ],
              "title": "Hash",
              "type": "object"
            },
            "ipAddress": {
              "properties": {
                "ip": {
                  "description": "The raw IP",
                  "order": 1,
                  "title": "Ip",
                  "type": "string"
                },
                "type": {
                  "description": "Denotes if an IP is internal or external",
                  "order": 2,
                  "title": "Type",
                  "type": "string"
                }
              },
              "required": [
                "ip",
                "type"
              ],
              "title": "IpAddress",
              "type": "object"
            },
            "process": {
              "properties": {
                "assetId": {
                  "description": "The asset id associated with the process",
                  "order": 1,
                  "title": "AssetId",
                  "type": "string"
                },
                "cmdLine": {
                  "description": "The raw value of the command line call used to invoke the process",
                  "order": 5,
                  "title": "CmdLine",
                  "type": "string"
                },
                "hashes": {
                  "description": "The list of hashes to check",
                  "items": {
                    "$ref": "#/definitions/hash"
                  },
                  "order": 3,
                  "title": "Hashes",
                  "type": "array"
                },
                "name": {
                  "description": "The name of the process",
                  "order": 4,
                  "title": "Name",
                  "type": "string"
                },
                "processId": {
                  "description": "The PID from the running process on the asset",
                  "order": 2,
                  "title": "ProcessId",
                  "type": "integer"
                }
              },
              "required": [
                "assetId",
                "processId"
              ],
              "title": "Process",
              "type": "object"
            },
            "user": {
              "properties": {
                "distinguishedName": {
                  "description": "The Active Directory distinguished name of the user",
                  "order": 2,
                  "title": "DistinguishedName",
                  "type": "string"
                },
                "emails": {
                  "description": "The email addresses associated with the user",
                  "items": {
                    "type": "string"
                  },
                  "order": 3,
                  "title": "Emails",
                  "type": "array"
                },
                "name": {
                  "description": "The name of the user, as '<firstname> <lastname>' if available, or account name otherwise",
                  "order": 1,
                  "title": "Name",
                  "type": "string"
                }
              },
              "required": [
                "name",
                "emails"
              ],
              "title": "User",
              "type": "object"
            }
          },
          "properties": {
            "actors": {
              "$ref": "#/definitions/actor",
              "description": "The insightIDR actors that are part of the investigation",
              "order": 7,
              "title": "Actors"
            },
            "contents": {
              "$ref": "#/definitions/content",
              "description": "The contents to enrich",
              "order": 8,
              "title": "Contents"
            },
            "description": {
              "description": "The description of the alert",
              "order": 4,
              "title": "Description",
              "type": "string"
            },
            "investigationId": {
              "description": "The investigation id",
              "order": 6,
              "title": "InvestigationId",
              "type": "string"
            },
            "link": {
              "description": "The deep link to the investigation in insightIDR",
              "order": 5,
              "title": "Link",
              "type": "string"
            },
            "name": {
              "description": "The human-readable name of the alert",
              "order": 3,
              "title": "Name",
              "type": "string"
            },
            "timestamp": {
              "description": "The time the alert was triggered in ISO 8601 extended timestamp format",
              "order": 1,
              "title": "Timestamp",
              "type": "string"
            },
            "type": {
              "description": "The type of alert",
              "order": 2,
              "title": "Type",
              "type": "string"
            }
          },
          "required": [
            "investigationId",
            "actors",
            "timestamp",
            "type",
            "name",
            "description",
            "link"
          ],
          "title": "Variables",
          "type": "object"
        },
        "tags": [],
        "type": "trigger_api_idr"
      }
    ]
  }
}