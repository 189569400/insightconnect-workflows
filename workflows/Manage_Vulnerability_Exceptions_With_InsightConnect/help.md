# Description

This workflow helps manage vulnerability exception requests in InsightVM by automatically approving exception requests for low-risk, low-scope vulnerabilities with InsightConnect. This workflow can help remediators remove vulnerabilities that cannot be remediated from their task list, helping alleviate false positives while saving InsightVM administrator time.

Both the risk threshold and the scope acceptable for automatic approval may be customized. By default, this workflow will automatically approve exception requests for vulnerabilities with a CVSS risk score of 0 scoped to a single asset.

# Key Features

* Automatically approve low-risk vulnerability exception requests
* Reduce overhead associated with manual vulnerability exception reviews
* Maintain visibility into approved exception requests with Job History in InsightConnect

# Requirements

* InsightConnect
* InsightVM

# Documentation

## Setup

*This workflow requires deployment of the [Insight Orchestrator](https://docs.rapid7.com/insightconnect/install-and-activate-the-orchestrator) and a [connection to the InsightVM Console](https://extensions.rapid7.com/extension/rapid7_insightvm#Documentation-Setup).*

Import the workflow and proceed through the Import Workflow wizard in InsightConnect. Import plugins and create connections during the import process as necessary.

## Usage

*Note: This workflow can be activated immediately with the default exception approval settings. This will automatically approve InsightVM vulnerability exceptions where the CVSSv2 risk score is 0 and the exception scope is a single asset.*

**To run the workflow**, simply submit (do not approve!) a new Vulnerability Exception in InsightVM. A new InsightConnect Job should start within a few minutes. If the vulnerability exception is within the scope of the approval settings, then it will be automatically approved. The workflow will include a comment linking the exception in InsightVM to the InsightConnect Job for audit purposes.

**To adjust the exception approval settings**, edit the workflow draft and open the `SETTINGS` step. Inside, you may adjust either or both of the following options: 

1. Acceptable CVSS `risk_threshold` for auto-approving vulnerability exceptions (`0 - 10`)
    * If the threshold is set to `1`, then all vulnerabilities with CVSS risk score equal to or less then 1 will be automatically approved
2. Acceptable `scope` for auto-approving vulnerability exceptions (`global`, `site`, `asset group`, or  `asset`)
    * If `global` is selected, then all exception scopes will be allowed
    * If `site` is selected, then exceptions for `asset` and `instance` will also be allowed
    * If `asset group` is selected, then exceptions for `asset` and `instance` will also be allowed

When combined, these settings provide users with control over when exception requests are automatically approved. For example, if the `risk_threshold` is set to `1` and the `scope` is set to `asset group`, then an exception request for a single asset with CVSS risk of 1 would be automatically approved. Conversely, the following exception requests would not be automatically approved:
    *  `global` scope and CVSS risk of 0
    *  `asset group` scope and CVSS risk of 5 

## Technical Details

Plugins utilized by workflow:

|Plugin|Version|Count|
|----|----|--------|
|Type Converter|1.6.0|1|
|Rapid7 InsightVM|4.2.0|3|


## Troubleshooting

_There is no troubleshooting information at this time_

# Version History

* 1.0.1 - Revised workflow title
* 1.0.0 - Initial workflow

# Links

## References


