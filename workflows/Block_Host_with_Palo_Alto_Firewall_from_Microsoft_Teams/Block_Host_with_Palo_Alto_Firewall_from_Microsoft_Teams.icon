{
  "kom": {
    "komandVersion": "1.50.1-0-gaec79",
    "komFileVersion": "2.0.0",
    "exportedAt": "2020-05-21T20:46:55.686913962Z",
    "workflowVersions": [
      {
        "name": "Block Host with Palo Alto Firewall from Microsoft Teams",
        "type": "runnable",
        "version": "",
        "description": "",
        "graph": {
          "edges": {
            "00f26916-43a3-418a-ab98-326391be9993": {
              "id": "00f26916-43a3-418a-ab98-326391be9993",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "4448411f-10bf-4898-9b83-75555ce41c13",
              "toNodeId": "b5baf6db-0d7d-4fd7-b146-00925635c7f2"
            },
            "08ec65ca-0094-48f7-ab18-1034c59ccbc8": {
              "id": "08ec65ca-0094-48f7-ab18-1034c59ccbc8",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "983495e5-68d4-4145-949c-51c509e0d6c4",
              "toNodeId": "7d54bed0-0fb7-4840-9f89-28737d307141"
            },
            "1c74ba92-5d6e-48db-9e2b-562a0d4cc026": {
              "id": "1c74ba92-5d6e-48db-9e2b-562a0d4cc026",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "c14619d0-89e1-440d-ae65-f85970c06e15",
              "toNodeId": "0fb40255-5bb0-4dee-8b74-7f3ac392bd7c"
            },
            "3292fd53-43d1-4460-b612-b85044c4c819": {
              "id": "3292fd53-43d1-4460-b612-b85044c4c819",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "0fb40255-5bb0-4dee-8b74-7f3ac392bd7c",
              "toNodeId": "1934a549-846f-4e68-b062-3d688e972ab2"
            },
            "355304b4-6277-4ffa-93b6-9a156dedc31c": {
              "id": "355304b4-6277-4ffa-93b6-9a156dedc31c",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "92405a43-74cc-4a86-aa1e-595b54f0f374",
              "toNodeId": ""
            },
            "3d13e6b2-5096-450c-8ad5-ef27a0aefcfb": {
              "id": "3d13e6b2-5096-450c-8ad5-ef27a0aefcfb",
              "name": "Block Host",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "e4ea28d6-006e-40fc-8a79-32f290e754c3",
              "toNodeId": "7b2bd280-4565-4095-af97-de154b4426bf"
            },
            "6c6b3ba0-6394-4401-a8c7-3ac2416be977": {
              "id": "6c6b3ba0-6394-4401-a8c7-3ac2416be977",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "786cbab2-9f35-44f1-b2e9-a2c236cb5a37",
              "toNodeId": "8300c579-8aeb-405b-ae13-3bea6c68eb7e"
            },
            "766efd98-7cb1-40ad-a45e-ad0e3fd49485": {
              "id": "766efd98-7cb1-40ad-a45e-ad0e3fd49485",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "4d650a86-639d-4f34-8920-52d3c954152b",
              "toNodeId": "4448411f-10bf-4898-9b83-75555ce41c13"
            },
            "7a188ee0-98bc-4945-b973-74e35f64b47d": {
              "id": "7a188ee0-98bc-4945-b973-74e35f64b47d",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "8300c579-8aeb-405b-ae13-3bea6c68eb7e",
              "toNodeId": ""
            },
            "8935f832-644a-432f-85d7-992b0061c594": {
              "id": "8935f832-644a-432f-85d7-992b0061c594",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "17ba3e71-3cbd-4995-a0d4-0c3b8974ef15",
              "toNodeId": "1aca3918-3c66-4a3f-ac52-d3e6ee38613b"
            },
            "8a364fc8-a042-41e6-93b5-f32a659d6bb3": {
              "id": "8a364fc8-a042-41e6-93b5-f32a659d6bb3",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "b5baf6db-0d7d-4fd7-b146-00925635c7f2",
              "toNodeId": "c14619d0-89e1-440d-ae65-f85970c06e15"
            },
            "8bf59ba4-7dca-454a-b2e4-48c8ca656983": {
              "id": "8bf59ba4-7dca-454a-b2e4-48c8ca656983",
              "name": "Unblock Host",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "e4ea28d6-006e-40fc-8a79-32f290e754c3",
              "toNodeId": "13b66114-3d09-471f-b6f1-c4f996bbfc31"
            },
            "9b9c2746-b900-4847-b980-086d0e2521f6": {
              "id": "9b9c2746-b900-4847-b980-086d0e2521f6",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "85241969-7636-4ddf-ab00-6bd220c28e51",
              "toNodeId": "983495e5-68d4-4145-949c-51c509e0d6c4"
            },
            "abb87f31-e4e6-4120-bae7-5dceb3621d7e": {
              "id": "abb87f31-e4e6-4120-bae7-5dceb3621d7e",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "13b66114-3d09-471f-b6f1-c4f996bbfc31",
              "toNodeId": "8c18b523-d755-46d0-a37d-a3caf41e4b78"
            },
            "b5909a47-f97e-4ca1-93b7-7750509a046a": {
              "id": "b5909a47-f97e-4ca1-93b7-7750509a046a",
              "name": "No",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "95c927b8-9dba-4fb0-9c4c-882501926cea",
              "toNodeId": "92405a43-74cc-4a86-aa1e-595b54f0f374"
            },
            "c9e28355-1cb1-4aca-b089-3ac607f58d2e": {
              "id": "c9e28355-1cb1-4aca-b089-3ac607f58d2e",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "1aca3918-3c66-4a3f-ac52-d3e6ee38613b",
              "toNodeId": "e4ea28d6-006e-40fc-8a79-32f290e754c3"
            },
            "cb205160-ba88-4b8d-9288-e27a1f88af74": {
              "id": "cb205160-ba88-4b8d-9288-e27a1f88af74",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "7d54bed0-0fb7-4840-9f89-28737d307141",
              "toNodeId": ""
            },
            "e1d845ed-6ad1-493a-9275-a822cb4e6ba2": {
              "id": "e1d845ed-6ad1-493a-9275-a822cb4e6ba2",
              "name": "Yes",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "95c927b8-9dba-4fb0-9c4c-882501926cea",
              "toNodeId": "786cbab2-9f35-44f1-b2e9-a2c236cb5a37"
            },
            "e44f72e2-4358-427e-9336-43968403c7a8": {
              "id": "e44f72e2-4358-427e-9336-43968403c7a8",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "1934a549-846f-4e68-b062-3d688e972ab2",
              "toNodeId": "83782ee6-5362-4b81-8902-9d4904c8ecd8"
            },
            "eb01ead8-58c2-4064-b44c-9cbd5700ba3c": {
              "id": "eb01ead8-58c2-4064-b44c-9cbd5700ba3c",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "7b2bd280-4565-4095-af97-de154b4426bf",
              "toNodeId": "85241969-7636-4ddf-ab00-6bd220c28e51"
            },
            "edf8af0b-8b05-4284-9d01-d32f451ae5e0": {
              "id": "edf8af0b-8b05-4284-9d01-d32f451ae5e0",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "8c18b523-d755-46d0-a37d-a3caf41e4b78",
              "toNodeId": "95c927b8-9dba-4fb0-9c4c-882501926cea"
            },
            "f33fb385-16d8-46f8-9a1f-0ea5046a1898": {
              "id": "f33fb385-16d8-46f8-9a1f-0ea5046a1898",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "83782ee6-5362-4b81-8902-9d4904c8ecd8",
              "toNodeId": "17ba3e71-3cbd-4995-a0d4-0c3b8974ef15"
            }
          },
          "nodes": {
            "0fb40255-5bb0-4dee-8b74-7f3ac392bd7c": {
              "id": "0fb40255-5bb0-4dee-8b74-7f3ac392bd7c",
              "parentNodeId": ""
            },
            "13b66114-3d09-471f-b6f1-c4f996bbfc31": {
              "id": "13b66114-3d09-471f-b6f1-c4f996bbfc31",
              "parentNodeId": ""
            },
            "17ba3e71-3cbd-4995-a0d4-0c3b8974ef15": {
              "id": "17ba3e71-3cbd-4995-a0d4-0c3b8974ef15",
              "parentNodeId": ""
            },
            "1934a549-846f-4e68-b062-3d688e972ab2": {
              "id": "1934a549-846f-4e68-b062-3d688e972ab2",
              "parentNodeId": ""
            },
            "1aca3918-3c66-4a3f-ac52-d3e6ee38613b": {
              "id": "1aca3918-3c66-4a3f-ac52-d3e6ee38613b",
              "parentNodeId": ""
            },
            "4448411f-10bf-4898-9b83-75555ce41c13": {
              "id": "4448411f-10bf-4898-9b83-75555ce41c13",
              "parentNodeId": ""
            },
            "4d650a86-639d-4f34-8920-52d3c954152b": {
              "id": "4d650a86-639d-4f34-8920-52d3c954152b",
              "parentNodeId": ""
            },
            "786cbab2-9f35-44f1-b2e9-a2c236cb5a37": {
              "id": "786cbab2-9f35-44f1-b2e9-a2c236cb5a37",
              "parentNodeId": ""
            },
            "7b2bd280-4565-4095-af97-de154b4426bf": {
              "id": "7b2bd280-4565-4095-af97-de154b4426bf",
              "parentNodeId": ""
            },
            "7d54bed0-0fb7-4840-9f89-28737d307141": {
              "id": "7d54bed0-0fb7-4840-9f89-28737d307141",
              "parentNodeId": ""
            },
            "8300c579-8aeb-405b-ae13-3bea6c68eb7e": {
              "id": "8300c579-8aeb-405b-ae13-3bea6c68eb7e",
              "parentNodeId": ""
            },
            "83782ee6-5362-4b81-8902-9d4904c8ecd8": {
              "id": "83782ee6-5362-4b81-8902-9d4904c8ecd8",
              "parentNodeId": ""
            },
            "85241969-7636-4ddf-ab00-6bd220c28e51": {
              "id": "85241969-7636-4ddf-ab00-6bd220c28e51",
              "parentNodeId": ""
            },
            "8c18b523-d755-46d0-a37d-a3caf41e4b78": {
              "id": "8c18b523-d755-46d0-a37d-a3caf41e4b78",
              "parentNodeId": ""
            },
            "92405a43-74cc-4a86-aa1e-595b54f0f374": {
              "id": "92405a43-74cc-4a86-aa1e-595b54f0f374",
              "parentNodeId": ""
            },
            "95c927b8-9dba-4fb0-9c4c-882501926cea": {
              "id": "95c927b8-9dba-4fb0-9c4c-882501926cea",
              "parentNodeId": ""
            },
            "983495e5-68d4-4145-949c-51c509e0d6c4": {
              "id": "983495e5-68d4-4145-949c-51c509e0d6c4",
              "parentNodeId": ""
            },
            "b5baf6db-0d7d-4fd7-b146-00925635c7f2": {
              "id": "b5baf6db-0d7d-4fd7-b146-00925635c7f2",
              "parentNodeId": ""
            },
            "c14619d0-89e1-440d-ae65-f85970c06e15": {
              "id": "c14619d0-89e1-440d-ae65-f85970c06e15",
              "parentNodeId": ""
            },
            "e4ea28d6-006e-40fc-8a79-32f290e754c3": {
              "id": "e4ea28d6-006e-40fc-8a79-32f290e754c3",
              "parentNodeId": ""
            }
          }
        },
        "steps": {
          "0fb40255-5bb0-4dee-8b74-7f3ac392bd7c": {
            "nodeId": "0fb40255-5bb0-4dee-8b74-7f3ac392bd7c",
            "name": "Trim Host",
            "type": "action",
            "plugin": {
              "name": "String Operations",
              "slugVendor": "rapid7",
              "slugName": "string",
              "slugVersion": "1.2.1",
              "imageData": "https://us.cdn-assets.connect.insight.rapid7.com/icons/rapid7/string/1.2.1/icon.png"
            },
            "identifier": "trim",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "string": "{{[c14619d0-89e1-440d-ae65-f85970c06e15].[list].[1]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "string": {
                  "description": "String to trim",
                  "order": 1,
                  "title": "String Input",
                  "type": "string"
                }
              },
              "required": [
                "string"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "trimmed": {
                  "description": "Trimmed string",
                  "order": 1,
                  "title": "Trimmed",
                  "type": "string"
                }
              },
              "required": [
                "trimmed"
              ],
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "ORCHESTRATOR"
          },
          "13b66114-3d09-471f-b6f1-c4f996bbfc31": {
            "nodeId": "13b66114-3d09-471f-b6f1-c4f996bbfc31",
            "name": "Unblock Host Artifact",
            "type": "artifact",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "content": "Unblock Host Command Received"
              },
              "type": "markdown"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://us.cdn-assets.connect.insight.rapid7.com/step-type-icons/artifact.svg",
            "connectionType": "NONE"
          },
          "17ba3e71-3cbd-4995-a0d4-0c3b8974ef15": {
            "nodeId": "17ba3e71-3cbd-4995-a0d4-0c3b8974ef15",
            "name": "Command",
            "type": "artifact",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "content": "{{[1934a549-846f-4e68-b062-3d688e972ab2].[trimmed]}}"
              },
              "type": "markdown"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://us.cdn-assets.connect.insight.rapid7.com/step-type-icons/artifact.svg",
            "connectionType": "NONE"
          },
          "1934a549-846f-4e68-b062-3d688e972ab2": {
            "nodeId": "1934a549-846f-4e68-b062-3d688e972ab2",
            "name": "Trim Command",
            "type": "action",
            "plugin": {
              "name": "String Operations",
              "slugVendor": "rapid7",
              "slugName": "string",
              "slugVersion": "1.2.1",
              "imageData": "https://us.cdn-assets.connect.insight.rapid7.com/icons/rapid7/string/1.2.1/icon.png"
            },
            "identifier": "trim",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "string": "{{[c14619d0-89e1-440d-ae65-f85970c06e15].[list].[0]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "string": {
                  "description": "String to trim",
                  "order": 1,
                  "title": "String Input",
                  "type": "string"
                }
              },
              "required": [
                "string"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "trimmed": {
                  "description": "Trimmed string",
                  "order": 1,
                  "title": "Trimmed",
                  "type": "string"
                }
              },
              "required": [
                "trimmed"
              ],
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "ORCHESTRATOR"
          },
          "1aca3918-3c66-4a3f-ac52-d3e6ee38613b": {
            "nodeId": "1aca3918-3c66-4a3f-ac52-d3e6ee38613b",
            "name": "Command Received Message",
            "type": "action",
            "plugin": {
              "name": "Microsoft Teams",
              "slugVendor": "rapid7",
              "slugName": "microsoft_teams",
              "slugVersion": "2.0.2",
              "imageData": "https://us.cdn-assets.connect.insight.rapid7.com/icons/rapid7/microsoft_teams/2.0.2/icon.png"
            },
            "identifier": "send_html_message",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "channel_name": "Komand Test Channel",
                "message_content": "<b>Command Received</b><br>\n<br>\nCommand: {{[17ba3e71-3cbd-4995-a0d4-0c3b8974ef15].[content]}}<br>\nHost: {{[83782ee6-5362-4b81-8902-9d4904c8ecd8].[content]}}<br>\n\n",
                "team_name": "Komand-Test-Everyone"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "channel_name": {
                  "description": "Channel name",
                  "order": 2,
                  "title": "Channel Name",
                  "type": "string"
                },
                "message_content": {
                  "description": "HTML content to send",
                  "order": 3,
                  "title": "Message Content",
                  "type": "string"
                },
                "team_name": {
                  "description": "Team name",
                  "order": 1,
                  "title": "Team Name",
                  "type": "string"
                }
              },
              "required": [
                "team_name",
                "channel_name",
                "message_content"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "definitions": {
                "body": {
                  "properties": {
                    "content": {
                      "description": "Content",
                      "order": 1,
                      "title": "Content",
                      "type": "string"
                    },
                    "contentType": {
                      "description": "Content type",
                      "order": 2,
                      "title": "Content Type",
                      "type": "string"
                    }
                  },
                  "title": "Body",
                  "type": "object"
                },
                "from": {
                  "properties": {
                    "user": {
                      "$ref": "#/definitions/user",
                      "description": "User",
                      "order": 1,
                      "title": "User"
                    }
                  },
                  "title": "From",
                  "type": "object"
                },
                "message": {
                  "properties": {
                    "body": {
                      "$ref": "#/definitions/body",
                      "description": "Body",
                      "order": 1,
                      "title": "Body"
                    },
                    "createdDateTime": {
                      "description": "Created date time",
                      "order": 3,
                      "title": "Created Date Time",
                      "type": "string"
                    },
                    "from": {
                      "$ref": "#/definitions/from",
                      "description": "From",
                      "order": 2,
                      "title": "From"
                    },
                    "id": {
                      "description": "ID",
                      "order": 8,
                      "title": "ID",
                      "type": "string"
                    },
                    "importance": {
                      "description": "Importance",
                      "order": 5,
                      "title": "Importance",
                      "type": "string"
                    },
                    "locale": {
                      "description": "Locale",
                      "order": 7,
                      "title": "Locale",
                      "type": "string"
                    },
                    "messageType": {
                      "description": "Message type",
                      "order": 6,
                      "title": "Message Type",
                      "type": "string"
                    },
                    "webUrl": {
                      "description": "Web URL",
                      "order": 4,
                      "title": "Web URL",
                      "type": "string"
                    }
                  },
                  "title": "Message",
                  "type": "object"
                },
                "user": {
                  "properties": {
                    "displayName": {
                      "description": "Display name",
                      "order": 1,
                      "title": "Display name",
                      "type": "string"
                    },
                    "id": {
                      "description": "ID",
                      "order": 2,
                      "title": "ID",
                      "type": "string"
                    }
                  },
                  "title": "User",
                  "type": "object"
                }
              },
              "properties": {
                "message": {
                  "$ref": "#/definitions/message",
                  "description": "The message object that was created",
                  "order": 1,
                  "title": "Message"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          },
          "4448411f-10bf-4898-9b83-75555ce41c13": {
            "nodeId": "4448411f-10bf-4898-9b83-75555ce41c13",
            "name": "Strip HTML",
            "type": "action",
            "plugin": {
              "name": "HTML",
              "slugVendor": "rapid7",
              "slugName": "html",
              "slugVersion": "1.2.1",
              "imageData": "https://us.cdn-assets.connect.insight.rapid7.com/icons/rapid7/html/1.2.1/icon.png"
            },
            "identifier": "text",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "doc": "{{[4d650a86-639d-4f34-8920-52d3c954152b].[message].[body].[content]}}",
                "remove_scripts": true
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "doc": {
                  "description": "Document to transform",
                  "order": 1,
                  "title": "Document",
                  "type": "string"
                },
                "remove_scripts": {
                  "description": "Remove non-HTML scripts from the document",
                  "order": 2,
                  "title": "Remove Scripts",
                  "type": "boolean"
                }
              },
              "required": [
                "doc"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "text": {
                  "description": "String without HTML tags",
                  "order": 1,
                  "title": "Text",
                  "type": "string"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "ORCHESTRATOR"
          },
          "4d650a86-639d-4f34-8920-52d3c954152b": {
            "nodeId": "4d650a86-639d-4f34-8920-52d3c954152b",
            "name": "Teams Trigger",
            "type": "trigger",
            "plugin": {
              "name": "Microsoft Teams",
              "slugVendor": "rapid7",
              "slugName": "microsoft_teams",
              "slugVersion": "2.0.2",
              "imageData": "https://us.cdn-assets.connect.insight.rapid7.com/icons/rapid7/microsoft_teams/2.0.2/icon.png"
            },
            "identifier": "new_message_received",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "channel_name": "Komand Test Channel",
                "message_content": "^!block-host.*|^!unblock-host.*",
                "team_name": "Komand-Test-Everyone"
              }
            },
            "triggerId": "3c8308eb-b93b-400f-84fb-4365f37a9b14",
            "defaultInputJSONSchema": {
              "properties": {
                "channel_name": {
                  "description": "Channel",
                  "order": 2,
                  "title": "Channel Name",
                  "type": "string"
                },
                "message_content": {
                  "description": "Regex to match new messages against",
                  "order": 3,
                  "title": "Message Content",
                  "type": "string"
                },
                "team_name": {
                  "description": "Team name",
                  "order": 1,
                  "title": "Team Name",
                  "type": "string"
                }
              },
              "required": [
                "team_name",
                "channel_name"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "definitions": {
                "body": {
                  "properties": {
                    "content": {
                      "description": "Content",
                      "order": 1,
                      "title": "Content",
                      "type": "string"
                    },
                    "contentType": {
                      "description": "Content type",
                      "order": 2,
                      "title": "Content Type",
                      "type": "string"
                    }
                  },
                  "title": "Body",
                  "type": "object"
                },
                "from": {
                  "properties": {
                    "user": {
                      "$ref": "#/definitions/user",
                      "description": "User",
                      "order": 1,
                      "title": "User"
                    }
                  },
                  "title": "From",
                  "type": "object"
                },
                "message": {
                  "properties": {
                    "body": {
                      "$ref": "#/definitions/body",
                      "description": "Body",
                      "order": 1,
                      "title": "Body"
                    },
                    "createdDateTime": {
                      "description": "Created date time",
                      "order": 3,
                      "title": "Created Date Time",
                      "type": "string"
                    },
                    "from": {
                      "$ref": "#/definitions/from",
                      "description": "From",
                      "order": 2,
                      "title": "From"
                    },
                    "id": {
                      "description": "ID",
                      "order": 8,
                      "title": "ID",
                      "type": "string"
                    },
                    "importance": {
                      "description": "Importance",
                      "order": 5,
                      "title": "Importance",
                      "type": "string"
                    },
                    "locale": {
                      "description": "Locale",
                      "order": 7,
                      "title": "Locale",
                      "type": "string"
                    },
                    "messageType": {
                      "description": "Message type",
                      "order": 6,
                      "title": "Message Type",
                      "type": "string"
                    },
                    "webUrl": {
                      "description": "Web URL",
                      "order": 4,
                      "title": "Web URL",
                      "type": "string"
                    }
                  },
                  "title": "Message",
                  "type": "object"
                },
                "user": {
                  "properties": {
                    "displayName": {
                      "description": "Display name",
                      "order": 1,
                      "title": "Display name",
                      "type": "string"
                    },
                    "id": {
                      "description": "ID",
                      "order": 2,
                      "title": "ID",
                      "type": "string"
                    }
                  },
                  "title": "User",
                  "type": "object"
                }
              },
              "properties": {
                "message": {
                  "$ref": "#/definitions/message",
                  "description": "The message object that was created",
                  "order": 1,
                  "title": "Message"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "https://us.cdn-assets.connect.insight.rapid7.com/step-type-icons/default.svg",
            "connectionType": "CONNECTION"
          },
          "786cbab2-9f35-44f1-b2e9-a2c236cb5a37": {
            "nodeId": "786cbab2-9f35-44f1-b2e9-a2c236cb5a37",
            "name": "Remove Address Object from Group",
            "type": "action",
            "plugin": {
              "name": "Palo Alto Firewall",
              "slugVendor": "rapid7",
              "slugName": "palo_alto_pan_os",
              "slugVersion": "5.1.1",
              "imageData": "https://us.cdn-assets.connect.insight.rapid7.com/icons/rapid7/palo_alto_pan_os/5.1.1/icon.png"
            },
            "identifier": "remove_address_object_from_group",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "address_object": "{{[8c18b523-d755-46d0-a37d-a3caf41e4b78].[address_objects].[0]}}",
                "device_name": "localhost.localdomain",
                "group": "ICON Block List",
                "virtual_system": "vsys1"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "address_object": {
                  "description": "The name of the address object to remove",
                  "order": 1,
                  "title": "Address Object",
                  "type": "string"
                },
                "device_name": {
                  "default": "localhost.localdomain",
                  "description": "Device name",
                  "order": 3,
                  "title": "Device Name",
                  "type": "string"
                },
                "group": {
                  "description": "Group name",
                  "order": 2,
                  "title": "Group",
                  "type": "string"
                },
                "virtual_system": {
                  "default": "vsys1",
                  "description": "Virtual system name",
                  "order": 4,
                  "title": "Virtual System Name",
                  "type": "string"
                }
              },
              "required": [
                "group",
                "device_name",
                "virtual_system",
                "address_object"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "success": {
                  "description": "Was operation successful",
                  "order": 1,
                  "title": "Success",
                  "type": "boolean"
                }
              },
              "required": [
                "success"
              ],
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          },
          "7b2bd280-4565-4095-af97-de154b4426bf": {
            "nodeId": "7b2bd280-4565-4095-af97-de154b4426bf",
            "name": "Block Host Command Received",
            "type": "artifact",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "content": "Block Host Command Received"
              },
              "type": "markdown"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://us.cdn-assets.connect.insight.rapid7.com/step-type-icons/artifact.svg",
            "connectionType": "NONE"
          },
          "7d54bed0-0fb7-4840-9f89-28737d307141": {
            "nodeId": "7d54bed0-0fb7-4840-9f89-28737d307141",
            "name": "Workflow Success Block",
            "type": "action",
            "plugin": {
              "name": "Microsoft Teams",
              "slugVendor": "rapid7",
              "slugName": "microsoft_teams",
              "slugVersion": "2.0.2",
              "imageData": "https://us.cdn-assets.connect.insight.rapid7.com/icons/rapid7/microsoft_teams/2.0.2/icon.png"
            },
            "identifier": "send_html_message",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "channel_name": "Komand Test Channel",
                "message_content": "🚨  <b>Workflow Success</b>  🚨<br>\n<br>\nBlocked: {{[83782ee6-5362-4b81-8902-9d4904c8ecd8].[content]}}<br>\n<br>\n<b>Workflow Complete</b>✅\n\n",
                "team_name": "Komand-Test-Everyone"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "channel_name": {
                  "description": "Channel name",
                  "order": 2,
                  "title": "Channel Name",
                  "type": "string"
                },
                "message_content": {
                  "description": "HTML content to send",
                  "order": 3,
                  "title": "Message Content",
                  "type": "string"
                },
                "team_name": {
                  "description": "Team name",
                  "order": 1,
                  "title": "Team Name",
                  "type": "string"
                }
              },
              "required": [
                "team_name",
                "channel_name",
                "message_content"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "definitions": {
                "body": {
                  "properties": {
                    "content": {
                      "description": "Content",
                      "order": 1,
                      "title": "Content",
                      "type": "string"
                    },
                    "contentType": {
                      "description": "Content type",
                      "order": 2,
                      "title": "Content Type",
                      "type": "string"
                    }
                  },
                  "title": "Body",
                  "type": "object"
                },
                "from": {
                  "properties": {
                    "user": {
                      "$ref": "#/definitions/user",
                      "description": "User",
                      "order": 1,
                      "title": "User"
                    }
                  },
                  "title": "From",
                  "type": "object"
                },
                "message": {
                  "properties": {
                    "body": {
                      "$ref": "#/definitions/body",
                      "description": "Body",
                      "order": 1,
                      "title": "Body"
                    },
                    "createdDateTime": {
                      "description": "Created date time",
                      "order": 3,
                      "title": "Created Date Time",
                      "type": "string"
                    },
                    "from": {
                      "$ref": "#/definitions/from",
                      "description": "From",
                      "order": 2,
                      "title": "From"
                    },
                    "id": {
                      "description": "ID",
                      "order": 8,
                      "title": "ID",
                      "type": "string"
                    },
                    "importance": {
                      "description": "Importance",
                      "order": 5,
                      "title": "Importance",
                      "type": "string"
                    },
                    "locale": {
                      "description": "Locale",
                      "order": 7,
                      "title": "Locale",
                      "type": "string"
                    },
                    "messageType": {
                      "description": "Message type",
                      "order": 6,
                      "title": "Message Type",
                      "type": "string"
                    },
                    "webUrl": {
                      "description": "Web URL",
                      "order": 4,
                      "title": "Web URL",
                      "type": "string"
                    }
                  },
                  "title": "Message",
                  "type": "object"
                },
                "user": {
                  "properties": {
                    "displayName": {
                      "description": "Display name",
                      "order": 1,
                      "title": "Display name",
                      "type": "string"
                    },
                    "id": {
                      "description": "ID",
                      "order": 2,
                      "title": "ID",
                      "type": "string"
                    }
                  },
                  "title": "User",
                  "type": "object"
                }
              },
              "properties": {
                "message": {
                  "$ref": "#/definitions/message",
                  "description": "The message object that was created",
                  "order": 1,
                  "title": "Message"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          },
          "8300c579-8aeb-405b-ae13-3bea6c68eb7e": {
            "nodeId": "8300c579-8aeb-405b-ae13-3bea6c68eb7e",
            "name": "Workflow Success Unblock",
            "type": "action",
            "plugin": {
              "name": "Microsoft Teams",
              "slugVendor": "rapid7",
              "slugName": "microsoft_teams",
              "slugVersion": "2.0.2",
              "imageData": "https://us.cdn-assets.connect.insight.rapid7.com/icons/rapid7/microsoft_teams/2.0.2/icon.png"
            },
            "identifier": "send_html_message",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "channel_name": "Komand Test Channel",
                "message_content": "🚨  <b>Workflow Success</b>  🚨<br>\n<br>\nUnblocked: {{[83782ee6-5362-4b81-8902-9d4904c8ecd8].[content]}}<br>\n<br>\n<b>Workflow Complete</b>✅\n",
                "team_name": "Komand-Test-Everyone"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "channel_name": {
                  "description": "Channel name",
                  "order": 2,
                  "title": "Channel Name",
                  "type": "string"
                },
                "message_content": {
                  "description": "HTML content to send",
                  "order": 3,
                  "title": "Message Content",
                  "type": "string"
                },
                "team_name": {
                  "description": "Team name",
                  "order": 1,
                  "title": "Team Name",
                  "type": "string"
                }
              },
              "required": [
                "team_name",
                "channel_name",
                "message_content"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "definitions": {
                "body": {
                  "properties": {
                    "content": {
                      "description": "Content",
                      "order": 1,
                      "title": "Content",
                      "type": "string"
                    },
                    "contentType": {
                      "description": "Content type",
                      "order": 2,
                      "title": "Content Type",
                      "type": "string"
                    }
                  },
                  "title": "Body",
                  "type": "object"
                },
                "from": {
                  "properties": {
                    "user": {
                      "$ref": "#/definitions/user",
                      "description": "User",
                      "order": 1,
                      "title": "User"
                    }
                  },
                  "title": "From",
                  "type": "object"
                },
                "message": {
                  "properties": {
                    "body": {
                      "$ref": "#/definitions/body",
                      "description": "Body",
                      "order": 1,
                      "title": "Body"
                    },
                    "createdDateTime": {
                      "description": "Created date time",
                      "order": 3,
                      "title": "Created Date Time",
                      "type": "string"
                    },
                    "from": {
                      "$ref": "#/definitions/from",
                      "description": "From",
                      "order": 2,
                      "title": "From"
                    },
                    "id": {
                      "description": "ID",
                      "order": 8,
                      "title": "ID",
                      "type": "string"
                    },
                    "importance": {
                      "description": "Importance",
                      "order": 5,
                      "title": "Importance",
                      "type": "string"
                    },
                    "locale": {
                      "description": "Locale",
                      "order": 7,
                      "title": "Locale",
                      "type": "string"
                    },
                    "messageType": {
                      "description": "Message type",
                      "order": 6,
                      "title": "Message Type",
                      "type": "string"
                    },
                    "webUrl": {
                      "description": "Web URL",
                      "order": 4,
                      "title": "Web URL",
                      "type": "string"
                    }
                  },
                  "title": "Message",
                  "type": "object"
                },
                "user": {
                  "properties": {
                    "displayName": {
                      "description": "Display name",
                      "order": 1,
                      "title": "Display name",
                      "type": "string"
                    },
                    "id": {
                      "description": "ID",
                      "order": 2,
                      "title": "ID",
                      "type": "string"
                    }
                  },
                  "title": "User",
                  "type": "object"
                }
              },
              "properties": {
                "message": {
                  "$ref": "#/definitions/message",
                  "description": "The message object that was created",
                  "order": 1,
                  "title": "Message"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          },
          "83782ee6-5362-4b81-8902-9d4904c8ecd8": {
            "nodeId": "83782ee6-5362-4b81-8902-9d4904c8ecd8",
            "name": "Host",
            "type": "artifact",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "content": "{{[0fb40255-5bb0-4dee-8b74-7f3ac392bd7c].[trimmed]}}"
              },
              "type": "markdown"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://us.cdn-assets.connect.insight.rapid7.com/step-type-icons/artifact.svg",
            "connectionType": "NONE"
          },
          "85241969-7636-4ddf-ab00-6bd220c28e51": {
            "nodeId": "85241969-7636-4ddf-ab00-6bd220c28e51",
            "name": "Create Network Object",
            "type": "action",
            "plugin": {
              "name": "Palo Alto Firewall",
              "slugVendor": "rapid7",
              "slugName": "palo_alto_pan_os",
              "slugVersion": "5.1.1",
              "imageData": "https://us.cdn-assets.connect.insight.rapid7.com/icons/rapid7/palo_alto_pan_os/5.1.1/icon.png"
            },
            "identifier": "set_address_object",
            "continueOnFailure": true,
            "isDisabled": false,
            "parameters": {
              "input": {
                "address": "{{[83782ee6-5362-4b81-8902-9d4904c8ecd8].[content]}}",
                "address_object": "{{[83782ee6-5362-4b81-8902-9d4904c8ecd8].[content]}}",
                "description": "InsightConnect Created Address Object",
                "tags": "",
                "whitelist": []
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "address": {
                  "description": "The IP address, network CIDR, or FQDN e.g. 192.168.1.1, 192.168.1.0/24, google.com google.com",
                  "order": 1,
                  "title": "Address",
                  "type": "string"
                },
                "address_object": {
                  "description": "The name of the address object",
                  "order": 2,
                  "title": "Address Object",
                  "type": "string"
                },
                "description": {
                  "description": "A description for the address object",
                  "order": 3,
                  "title": "Description",
                  "type": "string"
                },
                "tags": {
                  "description": "Tags for the address object. Use commas to separate multiple tags",
                  "order": 4,
                  "title": "Tags",
                  "type": "string"
                },
                "whitelist": {
                  "description": "This list contains a set of network objects that should not be blocked. This can include IPs, CIDR notation, or domains. It can not include an IP range (such as 10.0.0.0-10.0.0.10)",
                  "items": {
                    "type": "string"
                  },
                  "order": 5,
                  "title": "Whitelist",
                  "type": "array"
                }
              },
              "required": [
                "address",
                "address_object"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "code": {
                  "description": "Response code from the firewall",
                  "order": 2,
                  "title": "Code",
                  "type": "string"
                },
                "message": {
                  "description": "A message with more detail about the status",
                  "order": 3,
                  "title": "Message",
                  "type": "string"
                },
                "status": {
                  "description": "The status of the requested operation e.g. success, error, etc",
                  "order": 1,
                  "title": "Status",
                  "type": "string"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          },
          "8c18b523-d755-46d0-a37d-a3caf41e4b78": {
            "nodeId": "8c18b523-d755-46d0-a37d-a3caf41e4b78",
            "name": "Check if IP in Group",
            "type": "action",
            "plugin": {
              "name": "Palo Alto Firewall",
              "slugVendor": "rapid7",
              "slugName": "palo_alto_pan_os",
              "slugVersion": "5.1.1",
              "imageData": "https://us.cdn-assets.connect.insight.rapid7.com/icons/rapid7/palo_alto_pan_os/5.1.1/icon.png"
            },
            "identifier": "check_if_address_object_in_group",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "address": "{{[83782ee6-5362-4b81-8902-9d4904c8ecd8].[content]}}",
                "device_name": "localhost.localdomain",
                "enable_search": true,
                "group": "ICON Block List",
                "virtual_system": "vsys1"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "address": {
                  "description": "The Address Object name to check. If Enable Search is set to true then we search the addresses (IP, CIDR, doman) within the address object instead of matching the name",
                  "order": 2,
                  "title": "Address",
                  "type": "string"
                },
                "device_name": {
                  "default": "localhost.localdomain",
                  "description": "Device name",
                  "order": 4,
                  "title": "Device Name",
                  "type": "string"
                },
                "enable_search": {
                  "default": false,
                  "description": "When enabled, the Address input will accept a IP, CIDR, or domain name to search across the available Address Objects in the system. This is useful when you don’t know the Address Object by its name",
                  "order": 3,
                  "title": "Enable Search",
                  "type": "boolean"
                },
                "group": {
                  "description": "Group name",
                  "order": 1,
                  "title": "Group",
                  "type": "string"
                },
                "virtual_system": {
                  "default": "vsys1",
                  "description": "Virtual system name",
                  "order": 5,
                  "title": "Virtual System Name",
                  "type": "string"
                }
              },
              "required": [
                "enable_search",
                "device_name",
                "virtual_system",
                "group",
                "address"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "address_objects": {
                  "description": "The names of the address objects that match or contain address",
                  "items": {
                    "type": "string"
                  },
                  "order": 2,
                  "title": "Address Objects",
                  "type": "array"
                },
                "found": {
                  "description": "Was address found in group",
                  "order": 1,
                  "title": "Found",
                  "type": "boolean"
                }
              },
              "required": [
                "found"
              ],
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          },
          "92405a43-74cc-4a86-aa1e-595b54f0f374": {
            "nodeId": "92405a43-74cc-4a86-aa1e-595b54f0f374",
            "name": "Workflow Error IP not in Group",
            "type": "action",
            "plugin": {
              "name": "Microsoft Teams",
              "slugVendor": "rapid7",
              "slugName": "microsoft_teams",
              "slugVersion": "2.0.2",
              "imageData": "https://us.cdn-assets.connect.insight.rapid7.com/icons/rapid7/microsoft_teams/2.0.2/icon.png"
            },
            "identifier": "send_html_message",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "channel_name": "Komand Test Channel",
                "message_content": "<b>Workflow Failed</b><br>\n<br>\nCould not find host \"{{[83782ee6-5362-4b81-8902-9d4904c8ecd8].[content]}}\" in block list<br> \n<br>\n<b>Workflow Failed</b> ❗",
                "team_name": "Komand-Test-Everyone"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "channel_name": {
                  "description": "Channel name",
                  "order": 2,
                  "title": "Channel Name",
                  "type": "string"
                },
                "message_content": {
                  "description": "HTML content to send",
                  "order": 3,
                  "title": "Message Content",
                  "type": "string"
                },
                "team_name": {
                  "description": "Team name",
                  "order": 1,
                  "title": "Team Name",
                  "type": "string"
                }
              },
              "required": [
                "team_name",
                "channel_name",
                "message_content"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "definitions": {
                "body": {
                  "properties": {
                    "content": {
                      "description": "Content",
                      "order": 1,
                      "title": "Content",
                      "type": "string"
                    },
                    "contentType": {
                      "description": "Content type",
                      "order": 2,
                      "title": "Content Type",
                      "type": "string"
                    }
                  },
                  "title": "Body",
                  "type": "object"
                },
                "from": {
                  "properties": {
                    "user": {
                      "$ref": "#/definitions/user",
                      "description": "User",
                      "order": 1,
                      "title": "User"
                    }
                  },
                  "title": "From",
                  "type": "object"
                },
                "message": {
                  "properties": {
                    "body": {
                      "$ref": "#/definitions/body",
                      "description": "Body",
                      "order": 1,
                      "title": "Body"
                    },
                    "createdDateTime": {
                      "description": "Created date time",
                      "order": 3,
                      "title": "Created Date Time",
                      "type": "string"
                    },
                    "from": {
                      "$ref": "#/definitions/from",
                      "description": "From",
                      "order": 2,
                      "title": "From"
                    },
                    "id": {
                      "description": "ID",
                      "order": 8,
                      "title": "ID",
                      "type": "string"
                    },
                    "importance": {
                      "description": "Importance",
                      "order": 5,
                      "title": "Importance",
                      "type": "string"
                    },
                    "locale": {
                      "description": "Locale",
                      "order": 7,
                      "title": "Locale",
                      "type": "string"
                    },
                    "messageType": {
                      "description": "Message type",
                      "order": 6,
                      "title": "Message Type",
                      "type": "string"
                    },
                    "webUrl": {
                      "description": "Web URL",
                      "order": 4,
                      "title": "Web URL",
                      "type": "string"
                    }
                  },
                  "title": "Message",
                  "type": "object"
                },
                "user": {
                  "properties": {
                    "displayName": {
                      "description": "Display name",
                      "order": 1,
                      "title": "Display name",
                      "type": "string"
                    },
                    "id": {
                      "description": "ID",
                      "order": 2,
                      "title": "ID",
                      "type": "string"
                    }
                  },
                  "title": "User",
                  "type": "object"
                }
              },
              "properties": {
                "message": {
                  "$ref": "#/definitions/message",
                  "description": "The message object that was created",
                  "order": 1,
                  "title": "Message"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          },
          "95c927b8-9dba-4fb0-9c4c-882501926cea": {
            "nodeId": "95c927b8-9dba-4fb0-9c4c-882501926cea",
            "name": "Is IP in Group",
            "type": "automated_decision",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "defaultEdgeId": "b5909a47-f97e-4ca1-93b7-7750509a046a",
              "stepControlParams": [
                {
                  "edgeId": "e1d845ed-6ad1-493a-9275-a822cb4e6ba2",
                  "expression": {
                    "name": "8c18b523-d755-46d0-a37d-a3caf41e4b78.found",
                    "type": "variable"
                  },
                  "expressionText": "{{[8c18b523-d755-46d0-a37d-a3caf41e4b78].[found]}}"
                },
                {
                  "edgeId": "b5909a47-f97e-4ca1-93b7-7750509a046a",
                  "expression": {},
                  "expressionText": ""
                }
              ]
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://us.cdn-assets.connect.insight.rapid7.com/step-type-icons/automated-decision.svg",
            "connectionType": "NONE"
          },
          "983495e5-68d4-4145-949c-51c509e0d6c4": {
            "nodeId": "983495e5-68d4-4145-949c-51c509e0d6c4",
            "name": "Add Object to Group",
            "type": "action",
            "plugin": {
              "name": "Palo Alto Firewall",
              "slugVendor": "rapid7",
              "slugName": "palo_alto_pan_os",
              "slugVersion": "5.1.1",
              "imageData": "https://us.cdn-assets.connect.insight.rapid7.com/icons/rapid7/palo_alto_pan_os/5.1.1/icon.png"
            },
            "identifier": "add_address_object_to_group",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "address_object": "{{[83782ee6-5362-4b81-8902-9d4904c8ecd8].[content]}}",
                "device_name": "localhost.localdomain",
                "group": "ICON Block List",
                "virtual_system": "vsys1"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "address_object": {
                  "description": "The name of the address object to add",
                  "order": 1,
                  "title": "Address Object",
                  "type": "string"
                },
                "device_name": {
                  "default": "localhost.localdomain",
                  "description": "Device name",
                  "order": 3,
                  "title": "Device Name",
                  "type": "string"
                },
                "group": {
                  "description": "Group name",
                  "order": 2,
                  "title": "Group",
                  "type": "string"
                },
                "virtual_system": {
                  "default": "vsys1",
                  "description": "Virtual system name",
                  "order": 4,
                  "title": "Virtual System Name",
                  "type": "string"
                }
              },
              "required": [
                "device_name",
                "virtual_system",
                "address_object",
                "group"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "address_objects": {
                  "description": "Address objects currently in group",
                  "items": {
                    "type": "string"
                  },
                  "order": 2,
                  "title": "Address Objects",
                  "type": "array"
                },
                "success": {
                  "description": "Was operation successful",
                  "order": 1,
                  "title": "Success",
                  "type": "boolean"
                }
              },
              "required": [
                "success",
                "address_objects"
              ],
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          },
          "b5baf6db-0d7d-4fd7-b146-00925635c7f2": {
            "nodeId": "b5baf6db-0d7d-4fd7-b146-00925635c7f2",
            "name": "Command Received",
            "type": "artifact",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "content": "{{[4448411f-10bf-4898-9b83-75555ce41c13].[text]}}"
              },
              "type": "markdown"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://us.cdn-assets.connect.insight.rapid7.com/step-type-icons/artifact.svg",
            "connectionType": "NONE"
          },
          "c14619d0-89e1-440d-ae65-f85970c06e15": {
            "nodeId": "c14619d0-89e1-440d-ae65-f85970c06e15",
            "name": "Split Command",
            "type": "action",
            "plugin": {
              "name": "String Operations",
              "slugVendor": "rapid7",
              "slugName": "string",
              "slugVersion": "1.2.1",
              "imageData": "https://us.cdn-assets.connect.insight.rapid7.com/icons/rapid7/string/1.2.1/icon.png"
            },
            "identifier": "split_to_list",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "delimiter": " ",
                "string": "{{[4448411f-10bf-4898-9b83-75555ce41c13].[text]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "delimiter": {
                  "description": "The character used to split the string into slices for the list. The default is a newline, if not provided by the user",
                  "order": 2,
                  "title": "Delimiter",
                  "type": "string"
                },
                "string": {
                  "description": "String to convert e.g. Sentence one\nSentence two",
                  "order": 1,
                  "title": "String Input",
                  "type": "string"
                }
              },
              "required": [
                "string"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "list": {
                  "description": "List of string components",
                  "items": {
                    "type": "string"
                  },
                  "order": 1,
                  "title": "List",
                  "type": "array"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "ORCHESTRATOR"
          },
          "e4ea28d6-006e-40fc-8a79-32f290e754c3": {
            "nodeId": "e4ea28d6-006e-40fc-8a79-32f290e754c3",
            "name": "Type of command",
            "type": "automated_decision",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "defaultEdgeId": "3d13e6b2-5096-450c-8ad5-ef27a0aefcfb",
              "stepControlParams": [
                {
                  "edgeId": "3d13e6b2-5096-450c-8ad5-ef27a0aefcfb",
                  "expression": {},
                  "expressionText": ""
                },
                {
                  "edgeId": "8bf59ba4-7dca-454a-b2e4-48c8ca656983",
                  "expression": {
                    "left": {
                      "name": "17ba3e71-3cbd-4995-a0d4-0c3b8974ef15.content",
                      "type": "variable"
                    },
                    "op": "=",
                    "right": {
                      "type": "literal",
                      "value": "!unblock-host"
                    },
                    "type": "binary"
                  },
                  "expressionText": "{{[17ba3e71-3cbd-4995-a0d4-0c3b8974ef15].[content]}} = \"!unblock-host\""
                }
              ]
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://us.cdn-assets.connect.insight.rapid7.com/step-type-icons/automated-decision.svg",
            "connectionType": "NONE"
          }
        },
        "tags": null,
        "humanCostSeconds": 0,
        "humanCostDisplayUnit": ""
      }
    ],
    "triggers": [
      {
        "id": "3c8308eb-b93b-400f-84fb-4365f37a9b14",
        "identifier": "new_message_received",
        "name": "Teams Trigger",
        "description": "",
        "input": {
          "channel_name": "Komand Test Channel",
          "message_content": "^!block-host.*|^!unblock-host.*",
          "team_name": "Komand-Test-Everyone"
        },
        "inputJsonSchema": {
          "properties": {
            "channel_name": {
              "description": "Channel",
              "order": 2,
              "title": "Channel Name",
              "type": "string"
            },
            "message_content": {
              "description": "Regex to match new messages against",
              "order": 3,
              "title": "Message Content",
              "type": "string"
            },
            "team_name": {
              "description": "Team name",
              "order": 1,
              "title": "Team Name",
              "type": "string"
            }
          },
          "required": [
            "team_name",
            "channel_name"
          ],
          "title": "Variables",
          "type": "object"
        },
        "outputJsonSchema": {
          "definitions": {
            "body": {
              "properties": {
                "content": {
                  "description": "Content",
                  "order": 1,
                  "title": "Content",
                  "type": "string"
                },
                "contentType": {
                  "description": "Content type",
                  "order": 2,
                  "title": "Content Type",
                  "type": "string"
                }
              },
              "title": "Body",
              "type": "object"
            },
            "from": {
              "properties": {
                "user": {
                  "$ref": "#/definitions/user",
                  "description": "User",
                  "order": 1,
                  "title": "User"
                }
              },
              "title": "From",
              "type": "object"
            },
            "message": {
              "properties": {
                "body": {
                  "$ref": "#/definitions/body",
                  "description": "Body",
                  "order": 1,
                  "title": "Body"
                },
                "createdDateTime": {
                  "description": "Created date time",
                  "order": 3,
                  "title": "Created Date Time",
                  "type": "string"
                },
                "from": {
                  "$ref": "#/definitions/from",
                  "description": "From",
                  "order": 2,
                  "title": "From"
                },
                "id": {
                  "description": "ID",
                  "order": 8,
                  "title": "ID",
                  "type": "string"
                },
                "importance": {
                  "description": "Importance",
                  "order": 5,
                  "title": "Importance",
                  "type": "string"
                },
                "locale": {
                  "description": "Locale",
                  "order": 7,
                  "title": "Locale",
                  "type": "string"
                },
                "messageType": {
                  "description": "Message type",
                  "order": 6,
                  "title": "Message Type",
                  "type": "string"
                },
                "webUrl": {
                  "description": "Web URL",
                  "order": 4,
                  "title": "Web URL",
                  "type": "string"
                }
              },
              "title": "Message",
              "type": "object"
            },
            "user": {
              "properties": {
                "displayName": {
                  "description": "Display name",
                  "order": 1,
                  "title": "Display name",
                  "type": "string"
                },
                "id": {
                  "description": "ID",
                  "order": 2,
                  "title": "ID",
                  "type": "string"
                }
              },
              "title": "User",
              "type": "object"
            }
          },
          "properties": {
            "message": {
              "$ref": "#/definitions/message",
              "description": "The message object that was created",
              "order": 1,
              "title": "Message"
            }
          },
          "title": "Variables",
          "type": "object"
        },
        "tags": [],
        "type": "trigger_plugin",
        "plugin": {
          "name": "Microsoft Teams",
          "slugVendor": "rapid7",
          "slugName": "microsoft_teams",
          "slugVersion": "2.0.2",
          "imageData": "https://us.cdn-assets.connect.insight.rapid7.com/icons/rapid7/microsoft_teams/2.0.2/icon.png"
        }
      }
    ]
  }
}