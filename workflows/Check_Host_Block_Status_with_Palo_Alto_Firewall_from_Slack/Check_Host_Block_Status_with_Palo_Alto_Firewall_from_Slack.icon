{
  "kom": {
    "komandVersion": "1.51.0-0-ge64bd",
    "komFileVersion": "2.0.0",
    "exportedAt": "2020-05-27T19:54:56.436630513Z",
    "workflowVersions": [
      {
        "name": "Check Host Block Status with Palo Alto Firewall from Slack",
        "type": "runnable",
        "version": "",
        "description": "This workflow accepts a Slack command containing an IP address. This IP address will be checked against a pre-defined address group in a Palo Alto firewall to determine if the IP address is present or not. It is assumed that this address group will be used to store IP addresses for a block policy. A message with the results will be returned.",
        "graph": {
          "edges": {
            "766efd98-7cb1-40ad-a45e-ad0e3fd49485": {
              "id": "766efd98-7cb1-40ad-a45e-ad0e3fd49485",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "4d650a86-639d-4f34-8920-52d3c954152b",
              "toNodeId": "8e677411-1893-4f08-88cc-f78c783de218"
            },
            "8a364fc8-a042-41e6-93b5-f32a659d6bb3": {
              "id": "8a364fc8-a042-41e6-93b5-f32a659d6bb3",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "b5baf6db-0d7d-4fd7-b146-00925635c7f2",
              "toNodeId": "316875c8-7bcf-42da-a0d9-ae1bd8071c67"
            },
            "96191069-39d3-47c6-84fd-e5655dcc9d95": {
              "id": "96191069-39d3-47c6-84fd-e5655dcc9d95",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "96d8e3ba-7d16-47a0-9b5a-c05fe1a7684b",
              "toNodeId": ""
            },
            "b5909a47-f97e-4ca1-93b7-7750509a046a": {
              "id": "b5909a47-f97e-4ca1-93b7-7750509a046a",
              "name": "No",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "95c927b8-9dba-4fb0-9c4c-882501926cea",
              "toNodeId": "96d8e3ba-7d16-47a0-9b5a-c05fe1a7684b"
            },
            "e1d845ed-6ad1-493a-9275-a822cb4e6ba2": {
              "id": "e1d845ed-6ad1-493a-9275-a822cb4e6ba2",
              "name": "Yes",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "95c927b8-9dba-4fb0-9c4c-882501926cea",
              "toNodeId": "7fdf4c84-5150-461b-89f7-72495c55f9a8"
            },
            "edf8af0b-8b05-4284-9d01-d32f451ae5e0": {
              "id": "edf8af0b-8b05-4284-9d01-d32f451ae5e0",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "8c18b523-d755-46d0-a37d-a3caf41e4b78",
              "toNodeId": "95c927b8-9dba-4fb0-9c4c-882501926cea"
            },
            "f33fb385-16d8-46f8-9a1f-0ea5046a1898": {
              "id": "f33fb385-16d8-46f8-9a1f-0ea5046a1898",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "83782ee6-5362-4b81-8902-9d4904c8ecd8",
              "toNodeId": "8c18b523-d755-46d0-a37d-a3caf41e4b78"
            },
            "f77621d0-158e-4581-8a0e-48376fe2837e": {
              "id": "f77621d0-158e-4581-8a0e-48376fe2837e",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "8e677411-1893-4f08-88cc-f78c783de218",
              "toNodeId": "b5baf6db-0d7d-4fd7-b146-00925635c7f2"
            },
            "fab8b1da-4a64-4322-972c-eb3deb8e610d": {
              "id": "fab8b1da-4a64-4322-972c-eb3deb8e610d",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "316875c8-7bcf-42da-a0d9-ae1bd8071c67",
              "toNodeId": "83782ee6-5362-4b81-8902-9d4904c8ecd8"
            },
            "fcb0149e-b149-49c9-9efa-9e486e6a2462": {
              "id": "fcb0149e-b149-49c9-9efa-9e486e6a2462",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "7fdf4c84-5150-461b-89f7-72495c55f9a8",
              "toNodeId": ""
            }
          },
          "nodes": {
            "316875c8-7bcf-42da-a0d9-ae1bd8071c67": {
              "id": "316875c8-7bcf-42da-a0d9-ae1bd8071c67",
              "parentNodeId": ""
            },
            "4d650a86-639d-4f34-8920-52d3c954152b": {
              "id": "4d650a86-639d-4f34-8920-52d3c954152b",
              "parentNodeId": ""
            },
            "7fdf4c84-5150-461b-89f7-72495c55f9a8": {
              "id": "7fdf4c84-5150-461b-89f7-72495c55f9a8",
              "parentNodeId": ""
            },
            "83782ee6-5362-4b81-8902-9d4904c8ecd8": {
              "id": "83782ee6-5362-4b81-8902-9d4904c8ecd8",
              "parentNodeId": ""
            },
            "8c18b523-d755-46d0-a37d-a3caf41e4b78": {
              "id": "8c18b523-d755-46d0-a37d-a3caf41e4b78",
              "parentNodeId": ""
            },
            "8e677411-1893-4f08-88cc-f78c783de218": {
              "id": "8e677411-1893-4f08-88cc-f78c783de218",
              "parentNodeId": ""
            },
            "95c927b8-9dba-4fb0-9c4c-882501926cea": {
              "id": "95c927b8-9dba-4fb0-9c4c-882501926cea",
              "parentNodeId": ""
            },
            "96d8e3ba-7d16-47a0-9b5a-c05fe1a7684b": {
              "id": "96d8e3ba-7d16-47a0-9b5a-c05fe1a7684b",
              "parentNodeId": ""
            },
            "b5baf6db-0d7d-4fd7-b146-00925635c7f2": {
              "id": "b5baf6db-0d7d-4fd7-b146-00925635c7f2",
              "parentNodeId": ""
            }
          }
        },
        "steps": {
          "316875c8-7bcf-42da-a0d9-ae1bd8071c67": {
            "nodeId": "316875c8-7bcf-42da-a0d9-ae1bd8071c67",
            "name": "Parse Args",
            "type": "action",
            "plugin": {
              "name": "Python 3 Script",
              "slugVendor": "rapid7",
              "slugName": "python_3_script",
              "slugVersion": "2.0.2",
              "imageData": "https://us.cdn-assets.connect.insight.rapid7.com/icons/rapid7/python_3_script/2.0.2/icon.png"
            },
            "identifier": "run",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "function": "def run(params={}):\n\n    # Sometimes Slack will give us email in their linked form:\n    # <mailto:user@example.com>\n    # or\n    # <http://www.exmaple.com|example.com>\n    def parse_slack_tags(email):\n\n        if email.startswith(\"<\"):\n            # mailto link\n            if \"mailto:\" in email:\n                split_email = email.split(\":\")[1]\n                if \"|\" in split_email:\n                    return split_email.split(\"|\")[0]\n                return split_email\n\n            # http link\n            if \"http:\" in email:\n                split_email = email.split(\"|\")[1]\n                split_email = split_email.rstrip(\">\")\n                return split_email\n\n        return email\n\n    import shlex\n    input = params.get(\"input\")\n\n    # Sometimes slack gives us unicode spaces\n    input = input.replace(u'\\xa0', u' ')\n\n    # split our args\n    args = shlex.split(input)\n\n    # if you @ the bot, you will get the bot ID first in the message\n    # example: <asdfasdf> check_host 1.1.1.1\n    # a direct message will look like this\n    # check_host 1.1.1.1\n    args_count = len(args)\n    if args_count == 2:\n        host = parse_slack_tags(args[1])\n        command = parse_slack_tags(args[0])\n    else:\n        host = parse_slack_tags(args[2])\n        command = parse_slack_tags(args[1])\n\n\n    args_for_check_host = {\n        \"host\": host,\n        \"command\": command\n    }\n\n    return(args_for_check_host)",
                "input": {
                  "input": "{{[4d650a86-639d-4f34-8920-52d3c954152b].[message].[text]}}"
                }
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "function": {
                  "default": "def run(params={}):\\n    return {}",
                  "description": "Function definition. Must be named `run`. Accepts the `input` object as params. Returns the dict as output",
                  "displayType": "python",
                  "format": "python",
                  "order": 1,
                  "title": "Function",
                  "type": "string"
                },
                "input": {
                  "description": "Input object to be passed as `params={}` to the `run` function",
                  "order": 2,
                  "title": "Input",
                  "type": "object"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "result1": {
                  "description": "Sample output result1 (delete or edit)",
                  "order": 1,
                  "title": "Result1",
                  "type": "string"
                },
                "result2": {
                  "description": "Sample output result2 (delete or edit)",
                  "order": 2,
                  "title": "Result2",
                  "type": "string"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": {
              "definitions": {},
              "properties": {
                "command": {
                  "type": "string"
                },
                "host": {
                  "description": "Sample output result2 (delete or edit)",
                  "order": 2,
                  "title": "Result2",
                  "type": "string"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          },
          "4d650a86-639d-4f34-8920-52d3c954152b": {
            "nodeId": "4d650a86-639d-4f34-8920-52d3c954152b",
            "name": "Slack Trigger",
            "type": "trigger",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "matchChannel": "",
                "matchText": "block-status.*",
                "type": "any"
              }
            },
            "triggerId": "5341f0a0-adb1-481b-be8b-b54f60daf5e6",
            "defaultInputJSONSchema": {
              "properties": {
                "matchChannel": {
                  "description": "Regex to match for channel name",
                  "order": 1,
                  "title": "Match Channel",
                  "type": "string"
                },
                "matchText": {
                  "description": "Regex to match for Slack message content",
                  "order": 2,
                  "title": "Match Text",
                  "type": "string"
                },
                "type": {
                  "default": "any",
                  "description": "Desired Slack channel type: direct message to Slack app, group chats, or all channels",
                  "enum": [
                    "any",
                    "direct",
                    "group"
                  ],
                  "order": 3,
                  "title": "Type",
                  "type": "string"
                }
              },
              "required": [
                "type"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "definitions": {
                "message": {
                  "properties": {
                    "channel": {
                      "description": "Channel name",
                      "order": 3,
                      "title": "Channel",
                      "type": "string"
                    },
                    "channel_id": {
                      "description": "Slack channel ID",
                      "order": 4,
                      "title": "Channel ID",
                      "type": "string"
                    },
                    "text": {
                      "description": "Text",
                      "order": 5,
                      "title": "Text",
                      "type": "string"
                    },
                    "ts": {
                      "description": "Timestamp",
                      "order": 6,
                      "title": "Ts",
                      "type": "string"
                    },
                    "user": {
                      "description": "User name",
                      "order": 1,
                      "title": "User",
                      "type": "string"
                    },
                    "user_id": {
                      "description": "Slack User ID",
                      "order": 2,
                      "title": "User ID",
                      "type": "string"
                    }
                  },
                  "title": "Message",
                  "type": "object"
                }
              },
              "properties": {
                "display_name": {
                  "description": "User display name",
                  "order": 4,
                  "title": "Display Name",
                  "type": "string"
                },
                "message": {
                  "$ref": "#/definitions/message",
                  "description": "Message",
                  "order": 1,
                  "title": "Message"
                },
                "timestamp": {
                  "description": "Timestamp",
                  "order": 3,
                  "title": "Timestamp",
                  "type": "string"
                },
                "type": {
                  "description": "Message Type",
                  "order": 2,
                  "title": "Type",
                  "type": "string"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "https://us.cdn-assets.connect.insight.rapid7.com/step-type-icons/chatops.svg",
            "connectionType": "NONE",
            "chatOpsAppName": "slack",
            "chatOpsIdentifier": "message"
          },
          "7fdf4c84-5150-461b-89f7-72495c55f9a8": {
            "nodeId": "7fdf4c84-5150-461b-89f7-72495c55f9a8",
            "name": "Host Found Message",
            "type": "action_chatops",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "attachments": [],
                "message": "🔍  *Host Found*  🔍\n\n{{[83782ee6-5362-4b81-8902-9d4904c8ecd8].[content]}} was found in the following address objects:\n\n{{#each [8c18b523-d755-46d0-a37d-a3caf41e4b78].[address_objects]}}\n{{this}}\n{{/each}}\n\n*Workflow Complete*  ✅",
                "recipient": "{{[4d650a86-639d-4f34-8920-52d3c954152b].[message].[channel_id]}}",
                "thread_ts": "{{[4d650a86-639d-4f34-8920-52d3c954152b].[message].[ts]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "attachments": {
                  "description": "JSON array of attachments - see https://api.slack.com/docs/message-attachments (Advanced)",
                  "items": {
                    "type": "object"
                  },
                  "order": 4,
                  "title": "Attachments",
                  "type": "array"
                },
                "message": {
                  "description": "Message to send",
                  "order": 3,
                  "title": "Message",
                  "type": "string"
                },
                "recipient": {
                  "description": "Channels begin with # (e.g. #channel) and usernames begin with @ (e.g. @username)",
                  "order": 1,
                  "title": "Enter #channel or @username",
                  "type": "string"
                },
                "thread_ts": {
                  "description": "Select timestamp output variable from parent message step",
                  "order": 2,
                  "title": "To post in a thread, select parent message timestamp",
                  "type": "string"
                }
              },
              "required": [
                "recipient"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "channel_id": {
                  "description": "ChannelID of successful message",
                  "order": 1,
                  "title": "Channel ID",
                  "type": "string"
                },
                "timestamp": {
                  "description": "Timestamp of successful message",
                  "order": 2,
                  "title": "Timestamp",
                  "type": "string"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "NONE",
            "chatOpsAppName": "slack",
            "chatOpsIdentifier": "post_message"
          },
          "83782ee6-5362-4b81-8902-9d4904c8ecd8": {
            "nodeId": "83782ee6-5362-4b81-8902-9d4904c8ecd8",
            "name": "Host",
            "type": "artifact",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "content": "{{[316875c8-7bcf-42da-a0d9-ae1bd8071c67].[host]}}"
              },
              "type": "markdown"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://us.cdn-assets.connect.insight.rapid7.com/step-type-icons/artifact.svg",
            "connectionType": "NONE"
          },
          "8c18b523-d755-46d0-a37d-a3caf41e4b78": {
            "nodeId": "8c18b523-d755-46d0-a37d-a3caf41e4b78",
            "name": "Check if IP in Group",
            "type": "action",
            "plugin": {
              "name": "Palo Alto Firewall",
              "slugVendor": "rapid7",
              "slugName": "palo_alto_pan_os",
              "slugVersion": "5.1.1",
              "imageData": "https://us.cdn-assets.connect.insight.rapid7.com/icons/rapid7/palo_alto_pan_os/5.1.1/icon.png"
            },
            "identifier": "check_if_address_object_in_group",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "address": "{{[83782ee6-5362-4b81-8902-9d4904c8ecd8].[content]}}",
                "device_name": "localhost.localdomain",
                "enable_search": true,
                "group": "ICON Block List",
                "virtual_system": "vsys1"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "address": {
                  "description": "The Address Object name to check. If Enable Search is set to true then we search the addresses (IP, CIDR, doman) within the address object instead of matching the name",
                  "order": 2,
                  "title": "Address",
                  "type": "string"
                },
                "device_name": {
                  "default": "localhost.localdomain",
                  "description": "Device name",
                  "order": 4,
                  "title": "Device Name",
                  "type": "string"
                },
                "enable_search": {
                  "default": false,
                  "description": "When enabled, the Address input will accept a IP, CIDR, or domain name to search across the available Address Objects in the system. This is useful when you don’t know the Address Object by its name",
                  "order": 3,
                  "title": "Enable Search",
                  "type": "boolean"
                },
                "group": {
                  "description": "Group name",
                  "order": 1,
                  "title": "Group",
                  "type": "string"
                },
                "virtual_system": {
                  "default": "vsys1",
                  "description": "Virtual system name",
                  "order": 5,
                  "title": "Virtual System Name",
                  "type": "string"
                }
              },
              "required": [
                "enable_search",
                "device_name",
                "virtual_system",
                "group",
                "address"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "address_objects": {
                  "description": "The names of the address objects that match or contain address",
                  "items": {
                    "type": "string"
                  },
                  "order": 2,
                  "title": "Address Objects",
                  "type": "array"
                },
                "found": {
                  "description": "Was address found in group",
                  "order": 1,
                  "title": "Found",
                  "type": "boolean"
                }
              },
              "required": [
                "found"
              ],
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          },
          "8e677411-1893-4f08-88cc-f78c783de218": {
            "nodeId": "8e677411-1893-4f08-88cc-f78c783de218",
            "name": "Workflow Starting",
            "type": "action_chatops",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "attachments": [],
                "message": "*Workflow Starting*",
                "recipient": "{{[4d650a86-639d-4f34-8920-52d3c954152b].[message].[channel_id]}}",
                "thread_ts": "{{[4d650a86-639d-4f34-8920-52d3c954152b].[message].[ts]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "attachments": {
                  "description": "JSON array of attachments - see https://api.slack.com/docs/message-attachments (Advanced)",
                  "items": {
                    "type": "object"
                  },
                  "order": 4,
                  "title": "Attachments",
                  "type": "array"
                },
                "message": {
                  "description": "Message to send",
                  "order": 3,
                  "title": "Message",
                  "type": "string"
                },
                "recipient": {
                  "description": "Channels begin with # (e.g. #channel) and usernames begin with @ (e.g. @username)",
                  "order": 1,
                  "title": "Enter #channel or @username",
                  "type": "string"
                },
                "thread_ts": {
                  "description": "Select timestamp output variable from parent message step",
                  "order": 2,
                  "title": "To post in a thread, select parent message timestamp",
                  "type": "string"
                }
              },
              "required": [
                "recipient"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "channel_id": {
                  "description": "ChannelID of successful message",
                  "order": 1,
                  "title": "Channel ID",
                  "type": "string"
                },
                "timestamp": {
                  "description": "Timestamp of successful message",
                  "order": 2,
                  "title": "Timestamp",
                  "type": "string"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "NONE",
            "chatOpsAppName": "slack",
            "chatOpsIdentifier": "post_message"
          },
          "95c927b8-9dba-4fb0-9c4c-882501926cea": {
            "nodeId": "95c927b8-9dba-4fb0-9c4c-882501926cea",
            "name": "Is IP in Group",
            "type": "automated_decision",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "defaultEdgeId": "b5909a47-f97e-4ca1-93b7-7750509a046a",
              "stepControlParams": [
                {
                  "edgeId": "e1d845ed-6ad1-493a-9275-a822cb4e6ba2",
                  "expression": {
                    "name": "8c18b523-d755-46d0-a37d-a3caf41e4b78.found",
                    "type": "variable"
                  },
                  "expressionText": "{{[8c18b523-d755-46d0-a37d-a3caf41e4b78].[found]}}"
                },
                {
                  "edgeId": "b5909a47-f97e-4ca1-93b7-7750509a046a",
                  "expression": {},
                  "expressionText": ""
                }
              ]
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://us.cdn-assets.connect.insight.rapid7.com/step-type-icons/automated-decision.svg",
            "connectionType": "NONE"
          },
          "96d8e3ba-7d16-47a0-9b5a-c05fe1a7684b": {
            "nodeId": "96d8e3ba-7d16-47a0-9b5a-c05fe1a7684b",
            "name": "Host Not Found",
            "type": "action_chatops",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "attachments": [],
                "message": "🔍   *Host Not Found*  🔍 \n\nCould not find host: {{[83782ee6-5362-4b81-8902-9d4904c8ecd8].[content]}}\n\n*Workflow Complete*  ❗",
                "recipient": "{{[4d650a86-639d-4f34-8920-52d3c954152b].[message].[channel_id]}}",
                "thread_ts": "{{[4d650a86-639d-4f34-8920-52d3c954152b].[message].[ts]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "attachments": {
                  "description": "JSON array of attachments - see https://api.slack.com/docs/message-attachments (Advanced)",
                  "items": {
                    "type": "object"
                  },
                  "order": 4,
                  "title": "Attachments",
                  "type": "array"
                },
                "message": {
                  "description": "Message to send",
                  "order": 3,
                  "title": "Message",
                  "type": "string"
                },
                "recipient": {
                  "description": "Channels begin with # (e.g. #channel) and usernames begin with @ (e.g. @username)",
                  "order": 1,
                  "title": "Enter #channel or @username",
                  "type": "string"
                },
                "thread_ts": {
                  "description": "Select timestamp output variable from parent message step",
                  "order": 2,
                  "title": "To post in a thread, select parent message timestamp",
                  "type": "string"
                }
              },
              "required": [
                "recipient"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "channel_id": {
                  "description": "ChannelID of successful message",
                  "order": 1,
                  "title": "Channel ID",
                  "type": "string"
                },
                "timestamp": {
                  "description": "Timestamp of successful message",
                  "order": 2,
                  "title": "Timestamp",
                  "type": "string"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "NONE",
            "chatOpsAppName": "slack",
            "chatOpsIdentifier": "post_message"
          },
          "b5baf6db-0d7d-4fd7-b146-00925635c7f2": {
            "nodeId": "b5baf6db-0d7d-4fd7-b146-00925635c7f2",
            "name": "Command Received",
            "type": "artifact",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "content": "{{[4d650a86-639d-4f34-8920-52d3c954152b].[message].[text]}}"
              },
              "type": "markdown"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://us.cdn-assets.connect.insight.rapid7.com/step-type-icons/artifact.svg",
            "connectionType": "NONE"
          }
        },
        "tags": null,
        "humanCostSeconds": 0,
        "humanCostDisplayUnit": ""
      }
    ],
    "triggers": [
      {
        "id": "5341f0a0-adb1-481b-be8b-b54f60daf5e6",
        "name": "Slack Trigger",
        "description": "",
        "input": {
          "matchChannel": "",
          "matchText": "block-status.*",
          "type": "any"
        },
        "inputJsonSchema": {
          "properties": {
            "matchChannel": {
              "description": "Regex to match for channel name",
              "order": 1,
              "title": "Match Channel",
              "type": "string"
            },
            "matchText": {
              "description": "Regex to match for Slack message content",
              "order": 2,
              "title": "Match Text",
              "type": "string"
            },
            "type": {
              "default": "any",
              "description": "Desired Slack channel type: direct message to Slack app, group chats, or all channels",
              "enum": [
                "any",
                "direct",
                "group"
              ],
              "order": 3,
              "title": "Type",
              "type": "string"
            }
          },
          "required": [
            "type"
          ],
          "title": "Variables",
          "type": "object"
        },
        "outputJsonSchema": {
          "definitions": {
            "message": {
              "properties": {
                "channel": {
                  "description": "Channel name",
                  "order": 3,
                  "title": "Channel",
                  "type": "string"
                },
                "channel_id": {
                  "description": "Slack channel ID",
                  "order": 4,
                  "title": "Channel ID",
                  "type": "string"
                },
                "text": {
                  "description": "Text",
                  "order": 5,
                  "title": "Text",
                  "type": "string"
                },
                "ts": {
                  "description": "Timestamp",
                  "order": 6,
                  "title": "Ts",
                  "type": "string"
                },
                "user": {
                  "description": "User name",
                  "order": 1,
                  "title": "User",
                  "type": "string"
                },
                "user_id": {
                  "description": "Slack User ID",
                  "order": 2,
                  "title": "User ID",
                  "type": "string"
                }
              },
              "title": "Message",
              "type": "object"
            }
          },
          "properties": {
            "display_name": {
              "description": "User display name",
              "order": 4,
              "title": "Display Name",
              "type": "string"
            },
            "message": {
              "$ref": "#/definitions/message",
              "description": "Message",
              "order": 1,
              "title": "Message"
            },
            "timestamp": {
              "description": "Timestamp",
              "order": 3,
              "title": "Timestamp",
              "type": "string"
            },
            "type": {
              "description": "Message Type",
              "order": 2,
              "title": "Type",
              "type": "string"
            }
          },
          "title": "Variables",
          "type": "object"
        },
        "tags": [],
        "type": "trigger_chatops",
        "chatOpsAppName": "slack",
        "chatOpsIdentifier": "message"
      }
    ]
  }
}