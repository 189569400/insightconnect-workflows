{
  "kom": {
    "komandVersion": "1.36.2-0-g46dcf",
    "komFileVersion": "2.0.0",
    "exportedAt": "2019-09-05T03:11:32.987605168Z",
    "workflowVersions": [
      {
        "id": "cd992181-8c90-449b-8062-9771d6009c8b",
        "workflowId": "22de512a-c8c2-4c21-aefa-67a46f4bfdd4",
        "name": "Unsuspend User in Okta",
        "type": "runnable",
        "version": "1.0.0",
        "description": "This workflow removes a user from suspension in Okta from an event in InsightIDR.",
        "tags": [
          "insightidr",
          "okta",
          "containment",
          "deprovision",
          "user",
          "remove suspension"
        ],
        "meta": {
          "idrValidationMode": "ALL",
          "idrWorkflowCategory": "CONTAINMENT",
          "idrOriginalTemplateName": "Unsuspend User in Okta"
        },
        "graph": {
          "edges": {
            "269d8e4f-22b8-1c80-a5fb-a2f702b2a3d8": {
              "id": "269d8e4f-22b8-1c80-a5fb-a2f702b2a3d8",
              "name": "",
              "description": "",
              "parentNodeId": "33a691fc-78cd-8968-ba3b-d85ac545aac9",
              "fromNodeId": "8562557a-2cda-5960-3330-d7c483e5290a",
              "toNodeId": ""
            },
            "29feccfe-bde6-6092-9397-bd1aa6c39ea9": {
              "id": "29feccfe-bde6-6092-9397-bd1aa6c39ea9",
              "name": "",
              "description": "",
              "parentNodeId": "33a691fc-78cd-8968-ba3b-d85ac545aac9",
              "fromNodeId": "7524bf40-4e27-5a37-7b2e-779c381b9cc6",
              "toNodeId": "d2f132b6-a141-6782-cd69-19599b4875bc"
            },
            "2fec671b-c1d5-2a19-76b9-f1f01dc381f5": {
              "id": "2fec671b-c1d5-2a19-76b9-f1f01dc381f5",
              "name": "No",
              "description": "",
              "parentNodeId": "33a691fc-78cd-8968-ba3b-d85ac545aac9",
              "fromNodeId": "ef8fccde-20d8-aa7e-03c7-f23d78a6bdb8",
              "toNodeId": "8562557a-2cda-5960-3330-d7c483e5290a"
            },
            "302d07ba-aa1c-a997-8acd-fc498f6414a7": {
              "id": "302d07ba-aa1c-a997-8acd-fc498f6414a7",
              "name": "Yes",
              "description": "",
              "parentNodeId": "33a691fc-78cd-8968-ba3b-d85ac545aac9",
              "fromNodeId": "2403f824-be05-7776-9432-3f8c0927d3b1",
              "toNodeId": "c67e000a-f334-84b4-cf9b-74c0ad43e322"
            },
            "45d56a02-3176-56bc-87c3-25778da351f2": {
              "id": "45d56a02-3176-56bc-87c3-25778da351f2",
              "name": "",
              "description": "",
              "parentNodeId": "33a691fc-78cd-8968-ba3b-d85ac545aac9",
              "fromNodeId": "bccf7b6c-5fa0-7d56-c37a-2a14709e7001",
              "toNodeId": ""
            },
            "52b6e54a-f6f3-7b57-8844-cbbce3f3f0dc": {
              "id": "52b6e54a-f6f3-7b57-8844-cbbce3f3f0dc",
              "name": "",
              "description": "",
              "parentNodeId": "33a691fc-78cd-8968-ba3b-d85ac545aac9",
              "fromNodeId": "d2f132b6-a141-6782-cd69-19599b4875bc",
              "toNodeId": ""
            },
            "6b145662-af31-3585-63e8-1996269d16e1": {
              "id": "6b145662-af31-3585-63e8-1996269d16e1",
              "name": "",
              "description": "",
              "parentNodeId": "33a691fc-78cd-8968-ba3b-d85ac545aac9",
              "fromNodeId": "33a691fc-78cd-8968-ba3b-d85ac545aac9",
              "toNodeId": "a929f0a1-8e38-fdcb-7322-1164503c5d4d"
            },
            "7e012681-c2f4-01ca-7dea-7f2dbeee8eaa": {
              "id": "7e012681-c2f4-01ca-7dea-7f2dbeee8eaa",
              "name": "No",
              "description": "",
              "parentNodeId": "33a691fc-78cd-8968-ba3b-d85ac545aac9",
              "fromNodeId": "c67e000a-f334-84b4-cf9b-74c0ad43e322",
              "toNodeId": "bccf7b6c-5fa0-7d56-c37a-2a14709e7001"
            },
            "8040b672-8778-be49-c720-97874bbd4d6b": {
              "id": "8040b672-8778-be49-c720-97874bbd4d6b",
              "name": "Yes",
              "description": "",
              "parentNodeId": "33a691fc-78cd-8968-ba3b-d85ac545aac9",
              "fromNodeId": "c67e000a-f334-84b4-cf9b-74c0ad43e322",
              "toNodeId": "7524bf40-4e27-5a37-7b2e-779c381b9cc6"
            },
            "968d84fd-9bf2-a67f-e64c-65db6812062c": {
              "id": "968d84fd-9bf2-a67f-e64c-65db6812062c",
              "name": "",
              "description": "",
              "parentNodeId": "33a691fc-78cd-8968-ba3b-d85ac545aac9",
              "fromNodeId": "bd08165c-bef7-de3f-53ef-34be30330605",
              "toNodeId": ""
            },
            "a813e110-5f7e-9d68-cd59-4f1d492abffd": {
              "id": "a813e110-5f7e-9d68-cd59-4f1d492abffd",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "f8a8dc19-b3c3-4ea5-9291-e6c79806d75e",
              "toNodeId": ""
            },
            "ae7c5b91-16c1-f5ed-afd1-19cffd60bb17": {
              "id": "ae7c5b91-16c1-f5ed-afd1-19cffd60bb17",
              "name": "",
              "description": "",
              "parentNodeId": "33a691fc-78cd-8968-ba3b-d85ac545aac9",
              "fromNodeId": "a929f0a1-8e38-fdcb-7322-1164503c5d4d",
              "toNodeId": "f790f70b-fa52-e5d1-72e4-dd8042ad80b7"
            },
            "ae8831d1-a8fe-00ec-460c-d1688b21dce7": {
              "id": "ae8831d1-a8fe-00ec-460c-d1688b21dce7",
              "name": "",
              "description": "",
              "parentNodeId": "f8a8dc19-b3c3-4ea5-9291-e6c79806d75e",
              "fromNodeId": "f8a8dc19-b3c3-4ea5-9291-e6c79806d75e",
              "toNodeId": "33a691fc-78cd-8968-ba3b-d85ac545aac9"
            },
            "b38e88e4-914e-3c60-2403-552d5cf889e6": {
              "id": "b38e88e4-914e-3c60-2403-552d5cf889e6",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "853275ad-6db4-2391-a787-c4dfa1f3cde4",
              "toNodeId": "f8a8dc19-b3c3-4ea5-9291-e6c79806d75e"
            },
            "bdd98eb6-89e7-554f-83fc-d19686f90c86": {
              "id": "bdd98eb6-89e7-554f-83fc-d19686f90c86",
              "name": "Yes",
              "description": "",
              "parentNodeId": "33a691fc-78cd-8968-ba3b-d85ac545aac9",
              "fromNodeId": "ef8fccde-20d8-aa7e-03c7-f23d78a6bdb8",
              "toNodeId": "2403f824-be05-7776-9432-3f8c0927d3b1"
            },
            "bf8d844c-be5d-4d36-6048-0b4cd930a06f": {
              "id": "bf8d844c-be5d-4d36-6048-0b4cd930a06f",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "776ee69b-a660-c621-e622-d531a26502a7",
              "toNodeId": "853275ad-6db4-2391-a787-c4dfa1f3cde4"
            },
            "e68b5487-c850-9c14-d6a4-14e4e65011d5": {
              "id": "e68b5487-c850-9c14-d6a4-14e4e65011d5",
              "name": "",
              "description": "",
              "parentNodeId": "33a691fc-78cd-8968-ba3b-d85ac545aac9",
              "fromNodeId": "f790f70b-fa52-e5d1-72e4-dd8042ad80b7",
              "toNodeId": "ef8fccde-20d8-aa7e-03c7-f23d78a6bdb8"
            },
            "f01ac7df-3e8a-ffae-5444-928861371e87": {
              "id": "f01ac7df-3e8a-ffae-5444-928861371e87",
              "name": "",
              "description": "",
              "parentNodeId": "f8a8dc19-b3c3-4ea5-9291-e6c79806d75e",
              "fromNodeId": "33a691fc-78cd-8968-ba3b-d85ac545aac9",
              "toNodeId": ""
            },
            "f82f7e63-e6e1-c52b-9ba9-a808ed34c1fb": {
              "id": "f82f7e63-e6e1-c52b-9ba9-a808ed34c1fb",
              "name": "No",
              "description": "",
              "parentNodeId": "33a691fc-78cd-8968-ba3b-d85ac545aac9",
              "fromNodeId": "2403f824-be05-7776-9432-3f8c0927d3b1",
              "toNodeId": "bd08165c-bef7-de3f-53ef-34be30330605"
            }
          },
          "nodes": {
            "2403f824-be05-7776-9432-3f8c0927d3b1": {
              "id": "2403f824-be05-7776-9432-3f8c0927d3b1",
              "parentNodeId": "33a691fc-78cd-8968-ba3b-d85ac545aac9"
            },
            "33a691fc-78cd-8968-ba3b-d85ac545aac9": {
              "id": "33a691fc-78cd-8968-ba3b-d85ac545aac9",
              "parentNodeId": "f8a8dc19-b3c3-4ea5-9291-e6c79806d75e"
            },
            "7524bf40-4e27-5a37-7b2e-779c381b9cc6": {
              "id": "7524bf40-4e27-5a37-7b2e-779c381b9cc6",
              "parentNodeId": "33a691fc-78cd-8968-ba3b-d85ac545aac9"
            },
            "776ee69b-a660-c621-e622-d531a26502a7": {
              "id": "776ee69b-a660-c621-e622-d531a26502a7",
              "parentNodeId": ""
            },
            "853275ad-6db4-2391-a787-c4dfa1f3cde4": {
              "id": "853275ad-6db4-2391-a787-c4dfa1f3cde4",
              "parentNodeId": ""
            },
            "8562557a-2cda-5960-3330-d7c483e5290a": {
              "id": "8562557a-2cda-5960-3330-d7c483e5290a",
              "parentNodeId": "33a691fc-78cd-8968-ba3b-d85ac545aac9"
            },
            "a929f0a1-8e38-fdcb-7322-1164503c5d4d": {
              "id": "a929f0a1-8e38-fdcb-7322-1164503c5d4d",
              "parentNodeId": "33a691fc-78cd-8968-ba3b-d85ac545aac9"
            },
            "bccf7b6c-5fa0-7d56-c37a-2a14709e7001": {
              "id": "bccf7b6c-5fa0-7d56-c37a-2a14709e7001",
              "parentNodeId": "33a691fc-78cd-8968-ba3b-d85ac545aac9"
            },
            "bd08165c-bef7-de3f-53ef-34be30330605": {
              "id": "bd08165c-bef7-de3f-53ef-34be30330605",
              "parentNodeId": "33a691fc-78cd-8968-ba3b-d85ac545aac9"
            },
            "c67e000a-f334-84b4-cf9b-74c0ad43e322": {
              "id": "c67e000a-f334-84b4-cf9b-74c0ad43e322",
              "parentNodeId": "33a691fc-78cd-8968-ba3b-d85ac545aac9"
            },
            "d2f132b6-a141-6782-cd69-19599b4875bc": {
              "id": "d2f132b6-a141-6782-cd69-19599b4875bc",
              "parentNodeId": "33a691fc-78cd-8968-ba3b-d85ac545aac9"
            },
            "ef8fccde-20d8-aa7e-03c7-f23d78a6bdb8": {
              "id": "ef8fccde-20d8-aa7e-03c7-f23d78a6bdb8",
              "parentNodeId": "33a691fc-78cd-8968-ba3b-d85ac545aac9"
            },
            "f790f70b-fa52-e5d1-72e4-dd8042ad80b7": {
              "id": "f790f70b-fa52-e5d1-72e4-dd8042ad80b7",
              "parentNodeId": "33a691fc-78cd-8968-ba3b-d85ac545aac9"
            },
            "f8a8dc19-b3c3-4ea5-9291-e6c79806d75e": {
              "id": "f8a8dc19-b3c3-4ea5-9291-e6c79806d75e",
              "parentNodeId": ""
            }
          }
        },
        "steps": {
          "2403f824-be05-7776-9432-3f8c0927d3b1": {
            "nodeId": "2403f824-be05-7776-9432-3f8c0927d3b1",
            "name": "Is User Suspended?",
            "type": "automated_decision",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "defaultEdgeId": "f82f7e63-e6e1-c52b-9ba9-a808ed34c1fb",
              "stepControlParams": [
                {
                  "description": "Yes",
                  "edgeId": "302d07ba-aa1c-a997-8acd-fc498f6414a7",
                  "expression": {
                    "left": {
                      "name": "a929f0a1-8e38-fdcb-7322-1164503c5d4d.status",
                      "type": "variable"
                    },
                    "op": "=",
                    "right": {
                      "type": "literal",
                      "value": "SUSPENDED"
                    },
                    "type": "binary"
                  },
                  "expressionText": "({{[a929f0a1-8e38-fdcb-7322-1164503c5d4d].[status]}} = \"SUSPENDED\")",
                  "name": "Yes",
                  "nodeId": "c67e000a-f334-84b4-cf9b-74c0ad43e322"
                },
                {
                  "description": "No",
                  "edgeId": "f82f7e63-e6e1-c52b-9ba9-a808ed34c1fb",
                  "expression": {},
                  "expressionText": "",
                  "name": "No",
                  "nodeId": "bd08165c-bef7-de3f-53ef-34be30330605"
                }
              ]
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "defaultImageData": "https://us.cdn-assets.connect.insight.rapid7.com/step-type-icons/automated-decision.svg",
            "connectionType": "NONE"
          },
          "33a691fc-78cd-8968-ba3b-d85ac545aac9": {
            "nodeId": "33a691fc-78cd-8968-ba3b-d85ac545aac9",
            "name": "Email Loop",
            "type": "loop",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "innerEdgeId": "6b145662-af31-3585-63e8-1996269d16e1",
              "nextEdgeId": "f01ac7df-3e8a-ffae-5444-928861371e87",
              "repeatCount": 0,
              "repeatDelay": 0,
              "repeatVariable": "[f8a8dc19-b3c3-4ea5-9291-e6c79806d75e].[$item].[emails]"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "defaultImageData": "https://us.cdn-assets.connect.insight.rapid7.com/step-type-icons/loop.svg",
            "connectionType": "NONE"
          },
          "7524bf40-4e27-5a37-7b2e-779c381b9cc6": {
            "nodeId": "7524bf40-4e27-5a37-7b2e-779c381b9cc6",
            "name": "Unsuspend User",
            "type": "action",
            "plugin": {
              "name": "Okta",
              "slugVendor": "rapid7",
              "slugName": "okta",
              "slugVersion": "3.2.0",
              "imageData": "https://us.cdn-assets.connect.insight.rapid7.com/icons/rapid7/okta/3.2.0/icon.png"
            },
            "identifier": "unsuspend_user",
            "continueOnFailure": true,
            "isDisabled": false,
            "parameters": {
              "input": {
                "email": "{{[33a691fc-78cd-8968-ba3b-d85ac545aac9].[$item]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "email": {
                  "description": "The email of the Okta user",
                  "order": 1,
                  "title": "Okta User Email",
                  "type": "string"
                }
              },
              "required": [
                "email"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "email": {
                  "description": "The email of the Okta user",
                  "order": 1,
                  "title": "Okta User Email",
                  "type": "string"
                },
                "success": {
                  "description": "Whether unsuspension was successful",
                  "order": 3,
                  "title": "Success",
                  "type": "boolean"
                },
                "user_id": {
                  "description": "The user ID of the Okta user",
                  "order": 2,
                  "title": "Okta User ID",
                  "type": "string"
                }
              },
              "required": [
                "success"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          },
          "776ee69b-a660-c621-e622-d531a26502a7": {
            "nodeId": "776ee69b-a660-c621-e622-d531a26502a7",
            "name": "InsightIDR Event",
            "type": "trigger",
            "continueOnFailure": false,
            "isDisabled": false,
            "triggerId": "9b1faa6a-1e2e-49ed-8beb-da95d6bef905",
            "defaultInputJSONSchema": {
              "definitions": {
                "actor": {
                  "properties": {
                    "assets": {
                      "description": "The assets that are part of the investigation",
                      "items": {
                        "$ref": "#/definitions/asset"
                      },
                      "order": 2,
                      "title": "Assets",
                      "type": "array"
                    },
                    "users": {
                      "description": "The users that are part of the investigation",
                      "items": {
                        "$ref": "#/definitions/user"
                      },
                      "order": 1,
                      "title": "Users",
                      "type": "array"
                    }
                  },
                  "title": "Actor",
                  "type": "object"
                },
                "asset": {
                  "properties": {
                    "fqdn": {
                      "description": "The fully qualified domain name",
                      "order": 2,
                      "title": "Fqdn",
                      "type": "string"
                    },
                    "shortname": {
                      "description": "shortname of the asset",
                      "order": 1,
                      "title": "Shortname",
                      "type": "string"
                    }
                  },
                  "required": [
                    "shortname"
                  ],
                  "title": "Asset",
                  "type": "object"
                },
                "user": {
                  "properties": {
                    "distinguishedName": {
                      "description": "The Active Directory distinguished name of the user",
                      "order": 2,
                      "title": "DistinguishedName",
                      "type": "string"
                    },
                    "emails": {
                      "description": "The email addresses associated with the user",
                      "items": {
                        "type": "string"
                      },
                      "order": 3,
                      "title": "Emails",
                      "type": "array"
                    },
                    "name": {
                      "description": "The name of the user, as '<firstname> <lastname>' if available, or account name otherwise",
                      "order": 1,
                      "title": "Name",
                      "type": "string"
                    }
                  },
                  "required": [
                    "name",
                    "emails"
                  ],
                  "title": "User",
                  "type": "object"
                }
              },
              "properties": {
                "actors": {
                  "$ref": "#/definitions/actor",
                  "description": "The insightIDR actors that are part of the investigation",
                  "order": 6,
                  "title": "Actors"
                },
                "description": {
                  "description": "The description of the alert",
                  "order": 4,
                  "title": "Description",
                  "type": "string"
                },
                "investigationId": {
                  "description": "The unique identifier of the investigation",
                  "order": 7,
                  "title": "Investigation ID",
                  "type": "string"
                },
                "link": {
                  "description": "The deep link to the investigation in insightIDR",
                  "order": 5,
                  "title": "Link",
                  "type": "string"
                },
                "name": {
                  "description": "The human-readable name of the alert",
                  "order": 3,
                  "title": "Name",
                  "type": "string"
                },
                "timestamp": {
                  "description": "The time the alert was triggered in ISO 8601 extended timestamp format",
                  "order": 1,
                  "title": "Timestamp",
                  "type": "string"
                },
                "type": {
                  "description": "The type of alert",
                  "order": 2,
                  "title": "Type",
                  "type": "string"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "definitions": {
                "actor": {
                  "properties": {
                    "assets": {
                      "description": "The assets that are part of the investigation",
                      "items": {
                        "$ref": "#/definitions/asset"
                      },
                      "order": 2,
                      "title": "Assets",
                      "type": "array"
                    },
                    "users": {
                      "description": "The users that are part of the investigation",
                      "items": {
                        "$ref": "#/definitions/user"
                      },
                      "order": 1,
                      "title": "Users",
                      "type": "array"
                    }
                  },
                  "title": "Actor",
                  "type": "object"
                },
                "asset": {
                  "properties": {
                    "fqdn": {
                      "description": "The fully qualified domain name",
                      "order": 2,
                      "title": "Fqdn",
                      "type": "string"
                    },
                    "shortname": {
                      "description": "shortname of the asset",
                      "order": 1,
                      "title": "Shortname",
                      "type": "string"
                    }
                  },
                  "required": [
                    "shortname"
                  ],
                  "title": "Asset",
                  "type": "object"
                },
                "user": {
                  "properties": {
                    "distinguishedName": {
                      "description": "The Active Directory distinguished name of the user",
                      "order": 2,
                      "title": "DistinguishedName",
                      "type": "string"
                    },
                    "emails": {
                      "description": "The email addresses associated with the user",
                      "items": {
                        "type": "string"
                      },
                      "order": 3,
                      "title": "Emails",
                      "type": "array"
                    },
                    "name": {
                      "description": "The name of the user, as '<firstname> <lastname>' if available, or account name otherwise",
                      "order": 1,
                      "title": "Name",
                      "type": "string"
                    }
                  },
                  "required": [
                    "name",
                    "emails"
                  ],
                  "title": "User",
                  "type": "object"
                }
              },
              "properties": {
                "actors": {
                  "$ref": "#/definitions/actor",
                  "description": "The insightIDR actors that are part of the investigation",
                  "order": 6,
                  "title": "Actors"
                },
                "description": {
                  "description": "The description of the alert",
                  "order": 4,
                  "title": "Description",
                  "type": "string"
                },
                "investigationId": {
                  "description": "The unique identifier of the investigation",
                  "order": 7,
                  "title": "Investigation ID",
                  "type": "string"
                },
                "link": {
                  "description": "The deep link to the investigation in insightIDR",
                  "order": 5,
                  "title": "Link",
                  "type": "string"
                },
                "name": {
                  "description": "The human-readable name of the alert",
                  "order": 3,
                  "title": "Name",
                  "type": "string"
                },
                "timestamp": {
                  "description": "The time the alert was triggered in ISO 8601 extended timestamp format",
                  "order": 1,
                  "title": "Timestamp",
                  "type": "string"
                },
                "type": {
                  "description": "The type of alert",
                  "order": 2,
                  "title": "Type",
                  "type": "string"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "defaultImageData": "https://us.cdn-assets.connect.insight.rapid7.com/step-type-icons/trigger-api-idr.svg",
            "connectionType": "NONE"
          },
          "853275ad-6db4-2391-a787-c4dfa1f3cde4": {
            "nodeId": "853275ad-6db4-2391-a787-c4dfa1f3cde4",
            "name": "Alert Artifact",
            "type": "artifact",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "content": "",
              "input": {
                "content": "## Alert\n{{#if [776ee69b-a660-c621-e622-d531a26502a7].[description]}}\nDescription: {{[776ee69b-a660-c621-e622-d531a26502a7].[description]}}\n{{/if}}\n{{#if [776ee69b-a660-c621-e622-d531a26502a7].[investigationId]}}\nInvestigation ID: {{[776ee69b-a660-c621-e622-d531a26502a7].[investigationId]}}\n{{/if}}\n{{#if [776ee69b-a660-c621-e622-d531a26502a7].[name]}}\nName: {{[776ee69b-a660-c621-e622-d531a26502a7].[name]}}\n{{/if}}\n{{#if [776ee69b-a660-c621-e622-d531a26502a7].[link]}}\nLink: [{{[776ee69b-a660-c621-e622-d531a26502a7].[link]}}]({{[776ee69b-a660-c621-e622-d531a26502a7].[link]}})\n{{/if}}\n{{#if [776ee69b-a660-c621-e622-d531a26502a7].[timestamp]}}\nTimestamp: {{[776ee69b-a660-c621-e622-d531a26502a7].[timestamp]}}\n{{/if}}\n{{#if [776ee69b-a660-c621-e622-d531a26502a7].[type]}}\nType: {{[776ee69b-a660-c621-e622-d531a26502a7].[type]}}\n{{/if}}\n{{#if [776ee69b-a660-c621-e622-d531a26502a7].[actors].[users]}}\n{{#each [776ee69b-a660-c621-e622-d531a26502a7].[actors].[users]}}\n{{#if emails}}\nActor Users: {{emails}}\n{{/if}}\n{{/each}}\n{{/if}}\n"
              },
              "type": "markdown"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "defaultImageData": "https://us.cdn-assets.connect.insight.rapid7.com/step-type-icons/artifact.svg",
            "connectionType": "NONE"
          },
          "8562557a-2cda-5960-3330-d7c483e5290a": {
            "nodeId": "8562557a-2cda-5960-3330-d7c483e5290a",
            "name": "No User Artifact",
            "type": "artifact",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "content": "",
              "input": {
                "content": "## Result\n\nThe unsuspend a user action was skipped because the user did not exist in Okta during the job's execution.\n\n{{#if [33a691fc-78cd-8968-ba3b-d85ac545aac9].[$item]}}\nEmail: {{[33a691fc-78cd-8968-ba3b-d85ac545aac9].[$item]}}\n{{/if}}\n{{#if [f8a8dc19-b3c3-4ea5-9291-e6c79806d75e].[$item].[name]}}\nName: {{[f8a8dc19-b3c3-4ea5-9291-e6c79806d75e].[$item].[name]}}\n{{/if}}"
              },
              "type": "markdown"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "defaultImageData": "https://us.cdn-assets.connect.insight.rapid7.com/step-type-icons/artifact.svg",
            "connectionType": "NONE"
          },
          "a929f0a1-8e38-fdcb-7322-1164503c5d4d": {
            "nodeId": "a929f0a1-8e38-fdcb-7322-1164503c5d4d",
            "name": "Get User",
            "type": "action",
            "plugin": {
              "name": "Okta",
              "slugVendor": "rapid7",
              "slugName": "okta",
              "slugVersion": "3.2.0",
              "imageData": "https://us.cdn-assets.connect.insight.rapid7.com/icons/rapid7/okta/3.2.0/icon.png"
            },
            "identifier": "get_user",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "email": "{{[33a691fc-78cd-8968-ba3b-d85ac545aac9].[$item]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "email": {
                  "description": "The email of the user to obtain information about",
                  "order": 1,
                  "title": "Okta User Email",
                  "type": "string"
                }
              },
              "required": [
                "email"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "definitions": {
                "_links": {
                  "properties": {
                    "changePassword": {
                      "$ref": "#/definitions/changePassword",
                      "order": 1,
                      "title": "ChangePassword"
                    },
                    "changeRecoveryQuestion": {
                      "$ref": "#/definitions/changePassword",
                      "order": 2,
                      "title": "ChangeRecoveryQuestion"
                    },
                    "deactivate": {
                      "$ref": "#/definitions/changePassword",
                      "order": 3,
                      "title": "Deactivate"
                    },
                    "expirePassword": {
                      "$ref": "#/definitions/changePassword",
                      "order": 4,
                      "title": "ExpirePassword"
                    },
                    "forgotPassword": {
                      "$ref": "#/definitions/changePassword",
                      "order": 5,
                      "title": "ForgotPassword"
                    },
                    "resetFactors": {
                      "$ref": "#/definitions/changePassword",
                      "order": 6,
                      "title": "ResetFactors"
                    },
                    "resetPassword": {
                      "$ref": "#/definitions/changePassword",
                      "order": 7,
                      "title": "ResetPassword"
                    }
                  },
                  "title": "Links",
                  "type": "object"
                },
                "changePassword": {
                  "properties": {
                    "href": {
                      "order": 1,
                      "title": "Href",
                      "type": "string"
                    }
                  },
                  "title": "ChangePassword",
                  "type": "object"
                },
                "credentials": {
                  "properties": {
                    "password": {
                      "order": 1,
                      "title": "Password",
                      "type": "object"
                    },
                    "provider": {
                      "$ref": "#/definitions/provider",
                      "order": 2,
                      "title": "Provider"
                    },
                    "recovery_question": {
                      "$ref": "#/definitions/recovery_question",
                      "order": 3,
                      "title": "Recovery Question"
                    }
                  },
                  "title": "Credentials",
                  "type": "object"
                },
                "profile": {
                  "properties": {
                    "email": {
                      "order": 1,
                      "title": "Email",
                      "type": "string"
                    },
                    "firstName": {
                      "order": 2,
                      "title": "FirstName",
                      "type": "string"
                    },
                    "lastName": {
                      "order": 3,
                      "title": "LastName",
                      "type": "string"
                    },
                    "login": {
                      "order": 4,
                      "title": "Login",
                      "type": "string"
                    },
                    "mobilePhone": {
                      "order": 5,
                      "title": "MobilePhone",
                      "type": "string"
                    }
                  },
                  "title": "Profile",
                  "type": "object"
                },
                "provider": {
                  "properties": {
                    "name": {
                      "description": "Provider name e.g. OKTA",
                      "order": 2,
                      "title": "Name",
                      "type": "string"
                    },
                    "type": {
                      "description": "Provider type e.g. OKTA",
                      "order": 1,
                      "title": "Type",
                      "type": "string"
                    }
                  },
                  "title": "Provider",
                  "type": "object"
                },
                "recovery_question": {
                  "properties": {
                    "answer": {
                      "description": "Recovery answer e.g. Annie Oakley",
                      "order": 2,
                      "title": "Answer",
                      "type": "string"
                    },
                    "question": {
                      "description": "Recovery question e.g. Who's a major player in the cowboy scene?",
                      "order": 1,
                      "title": "Question",
                      "type": "string"
                    }
                  },
                  "title": "Recovery Question",
                  "type": "object"
                }
              },
              "properties": {
                "_links": {
                  "$ref": "#/definitions/_links",
                  "description": "Links",
                  "order": 7,
                  "title": "Links"
                },
                "activated": {
                  "description": "Activated",
                  "order": 5,
                  "title": "Activated",
                  "type": "string"
                },
                "created": {
                  "description": "Created",
                  "order": 4,
                  "title": "Created",
                  "type": "string"
                },
                "credentials": {
                  "$ref": "#/definitions/credentials",
                  "description": "Credentials",
                  "order": 9,
                  "title": "Credentials"
                },
                "found": {
                  "description": "Whether user was found",
                  "order": 12,
                  "title": "Found User",
                  "type": "boolean"
                },
                "id": {
                  "description": "ID",
                  "order": 10,
                  "title": "ID",
                  "type": "string"
                },
                "lastLogin": {
                  "description": "Last Login",
                  "order": 8,
                  "title": "Last Login",
                  "type": "string"
                },
                "lastUpdated": {
                  "description": "Last Updated",
                  "order": 6,
                  "title": "Last Updated",
                  "type": "string"
                },
                "passwordChanged": {
                  "description": "Password Changed",
                  "order": 3,
                  "title": "Password Changed",
                  "type": "string"
                },
                "profile": {
                  "$ref": "#/definitions/profile",
                  "description": "Profile",
                  "order": 2,
                  "title": "Profile"
                },
                "status": {
                  "description": "Status",
                  "order": 1,
                  "title": "Status",
                  "type": "string"
                },
                "statusChanged": {
                  "description": "Status Changed",
                  "order": 11,
                  "title": "Status Changed",
                  "type": "string"
                }
              },
              "required": [
                "found"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          },
          "bccf7b6c-5fa0-7d56-c37a-2a14709e7001": {
            "nodeId": "bccf7b6c-5fa0-7d56-c37a-2a14709e7001",
            "name": "No Unsuspend Artifact",
            "type": "artifact",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "content": "",
              "input": {
                "content": "## Result\n\nThe unsuspend a user action was skipped by a human decision during the job's execution.\n\n{{#if [33a691fc-78cd-8968-ba3b-d85ac545aac9].[$item]}}\nEmail: {{[33a691fc-78cd-8968-ba3b-d85ac545aac9].[$item]}}\n{{/if}}\n{{#if [f8a8dc19-b3c3-4ea5-9291-e6c79806d75e].[$item].[name]}}\nName: {{[f8a8dc19-b3c3-4ea5-9291-e6c79806d75e].[$item].[name]}}\n{{/if}}"
              },
              "type": "markdown"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "defaultImageData": "https://us.cdn-assets.connect.insight.rapid7.com/step-type-icons/artifact.svg",
            "connectionType": "NONE"
          },
          "bd08165c-bef7-de3f-53ef-34be30330605": {
            "nodeId": "bd08165c-bef7-de3f-53ef-34be30330605",
            "name": "User Status Artifact",
            "type": "artifact",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "content": "",
              "input": {
                "content": "##  Result\n\nUser: {{[f8a8dc19-b3c3-4ea5-9291-e6c79806d75e].[$item].[name]}}\n{{#if [33a691fc-78cd-8968-ba3b-d85ac545aac9].[$item]}}\nEmail: {{[33a691fc-78cd-8968-ba3b-d85ac545aac9].[$item]}}\n{{/if}}\nAccount Status: {{[a929f0a1-8e38-fdcb-7322-1164503c5d4d].[status]}}\n\nSkipping user because Okta reported that they were not suspended at the time of this job's execution."
              },
              "type": "markdown"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "defaultImageData": "https://us.cdn-assets.connect.insight.rapid7.com/step-type-icons/artifact.svg",
            "connectionType": "NONE"
          },
          "c67e000a-f334-84b4-cf9b-74c0ad43e322": {
            "nodeId": "c67e000a-f334-84b4-cf9b-74c0ad43e322",
            "name": "Unsuspend User?",
            "type": "human_decision",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "defaultEdgeId": "",
              "stepControlParams": [
                {
                  "description": "Yes",
                  "edgeId": "8040b672-8778-be49-c720-97874bbd4d6b",
                  "expression": {},
                  "expressionText": "",
                  "name": "Yes",
                  "nodeId": "7524bf40-4e27-5a37-7b2e-779c381b9cc6"
                },
                {
                  "description": "No",
                  "edgeId": "7e012681-c2f4-01ca-7dea-7f2dbeee8eaa",
                  "expression": {},
                  "expressionText": "",
                  "name": "No",
                  "nodeId": "bccf7b6c-5fa0-7d56-c37a-2a14709e7001"
                }
              ]
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "defaultImageData": "https://us.cdn-assets.connect.insight.rapid7.com/step-type-icons/human-decision.svg",
            "connectionType": "NONE"
          },
          "d2f132b6-a141-6782-cd69-19599b4875bc": {
            "nodeId": "d2f132b6-a141-6782-cd69-19599b4875bc",
            "name": "Unsuspend User Artifact",
            "type": "artifact",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "content": "",
              "input": {
                "content": "###  Result\n{{#if [7524bf40-4e27-5a37-7b2e-779c381b9cc6].[success]}}\nUnsuspension of user *succeeded*.\n{{else}}\nUnsuspension of user *failed*. Check the action's output and the account in Okta.\n{{/if}}\n\nUser: {{[f8a8dc19-b3c3-4ea5-9291-e6c79806d75e].[$item].[name]}}\nEmail: {{[33a691fc-78cd-8968-ba3b-d85ac545aac9].[$item]}}"
              },
              "type": "markdown"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "defaultImageData": "https://us.cdn-assets.connect.insight.rapid7.com/step-type-icons/artifact.svg",
            "connectionType": "NONE"
          },
          "ef8fccde-20d8-aa7e-03c7-f23d78a6bdb8": {
            "nodeId": "ef8fccde-20d8-aa7e-03c7-f23d78a6bdb8",
            "name": "Does User Exist?",
            "type": "automated_decision",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "defaultEdgeId": "2fec671b-c1d5-2a19-76b9-f1f01dc381f5",
              "stepControlParams": [
                {
                  "description": "Yes",
                  "edgeId": "bdd98eb6-89e7-554f-83fc-d19686f90c86",
                  "expression": {
                    "left": {
                      "name": "a929f0a1-8e38-fdcb-7322-1164503c5d4d.found",
                      "type": "variable"
                    },
                    "op": "=",
                    "right": {
                      "type": "literal",
                      "value": true
                    },
                    "type": "binary"
                  },
                  "expressionText": "({{[a929f0a1-8e38-fdcb-7322-1164503c5d4d].[found]}} = true)",
                  "name": "Yes",
                  "nodeId": "2403f824-be05-7776-9432-3f8c0927d3b1"
                },
                {
                  "description": "No",
                  "edgeId": "2fec671b-c1d5-2a19-76b9-f1f01dc381f5",
                  "expression": {},
                  "expressionText": "",
                  "name": "No",
                  "nodeId": "8562557a-2cda-5960-3330-d7c483e5290a"
                }
              ]
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "defaultImageData": "https://us.cdn-assets.connect.insight.rapid7.com/step-type-icons/automated-decision.svg",
            "connectionType": "NONE"
          },
          "f790f70b-fa52-e5d1-72e4-dd8042ad80b7": {
            "nodeId": "f790f70b-fa52-e5d1-72e4-dd8042ad80b7",
            "name": "Get User Artifact",
            "type": "artifact",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "content": "",
              "input": {
                "content": "## User Information\nUser: {{[f8a8dc19-b3c3-4ea5-9291-e6c79806d75e].[$item].[name]}} \nEmail: {{[33a691fc-78cd-8968-ba3b-d85ac545aac9].[$item]}}\n\n## Okta Information for User\nFound User: {{[a929f0a1-8e38-fdcb-7322-1164503c5d4d].[found]}}\n{{#if [a929f0a1-8e38-fdcb-7322-1164503c5d4d].[found]}}\n{{#if [a929f0a1-8e38-fdcb-7322-1164503c5d4d].[activated]}}\nActivation Timestamp: {{[a929f0a1-8e38-fdcb-7322-1164503c5d4d].[activated]}}\n{{else}}\nActivation Status: Not available\n{{/if}}\n{{#if [a929f0a1-8e38-fdcb-7322-1164503c5d4d].[created]}}\nCreation Timestamp: {{[a929f0a1-8e38-fdcb-7322-1164503c5d4d].[created]}}\n{{else}}\nCreation Timestamp: Not available\n{{/if}}\n{{#if [a929f0a1-8e38-fdcb-7322-1164503c5d4d].[lastLogin]}}\nLast Login Timestamp: {{[a929f0a1-8e38-fdcb-7322-1164503c5d4d].[lastLogin]}}\n{{else}}\nLast Login Timestamp: Not available\n{{/if}}\n{{#if [a929f0a1-8e38-fdcb-7322-1164503c5d4d].[lastUpdated]}}\nLast Updated Timestamp: {{[a929f0a1-8e38-fdcb-7322-1164503c5d4d].[lastUpdated]}}\n{{else}}\nLast Updated Timestamp: Not available\n{{/if}}\n{{else}}\n{{/if}}"
              },
              "type": "markdown"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "defaultImageData": "https://us.cdn-assets.connect.insight.rapid7.com/step-type-icons/artifact.svg",
            "connectionType": "NONE"
          },
          "f8a8dc19-b3c3-4ea5-9291-e6c79806d75e": {
            "nodeId": "f8a8dc19-b3c3-4ea5-9291-e6c79806d75e",
            "name": "User Loop",
            "type": "loop",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "innerEdgeId": "ae8831d1-a8fe-00ec-460c-d1688b21dce7",
              "nextEdgeId": "a813e110-5f7e-9d68-cd59-4f1d492abffd",
              "repeatCount": 0,
              "repeatDelay": 0,
              "repeatVariable": "[776ee69b-a660-c621-e622-d531a26502a7].[actors].[users]"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "defaultImageData": "https://us.cdn-assets.connect.insight.rapid7.com/step-type-icons/loop.svg",
            "connectionType": "NONE"
          }
        },
        "tags": null,
        "humanCostSeconds": 0,
        "humanCostDisplayUnit": ""
      }
    ],
    "triggers": [
      {
        "id": "9b1faa6a-1e2e-49ed-8beb-da95d6bef905",
        "name": "InsightIDR Event",
        "description": "",
        "input": null,
        "inputJsonSchema": {
          "definitions": {
            "actor": {
              "properties": {
                "assets": {
                  "description": "The assets that are part of the investigation",
                  "items": {
                    "$ref": "#/definitions/asset"
                  },
                  "order": 2,
                  "title": "Assets",
                  "type": "array"
                },
                "users": {
                  "description": "The users that are part of the investigation",
                  "items": {
                    "$ref": "#/definitions/user"
                  },
                  "order": 1,
                  "title": "Users",
                  "type": "array"
                }
              },
              "title": "Actor",
              "type": "object"
            },
            "asset": {
              "properties": {
                "fqdn": {
                  "description": "The fully qualified domain name",
                  "order": 2,
                  "title": "Fqdn",
                  "type": "string"
                },
                "shortname": {
                  "description": "shortname of the asset",
                  "order": 1,
                  "title": "Shortname",
                  "type": "string"
                }
              },
              "required": [
                "shortname"
              ],
              "title": "Asset",
              "type": "object"
            },
            "user": {
              "properties": {
                "distinguishedName": {
                  "description": "The Active Directory distinguished name of the user",
                  "order": 2,
                  "title": "DistinguishedName",
                  "type": "string"
                },
                "emails": {
                  "description": "The email addresses associated with the user",
                  "items": {
                    "type": "string"
                  },
                  "order": 3,
                  "title": "Emails",
                  "type": "array"
                },
                "name": {
                  "description": "The name of the user, as '<firstname> <lastname>' if available, or account name otherwise",
                  "order": 1,
                  "title": "Name",
                  "type": "string"
                }
              },
              "required": [
                "name",
                "emails"
              ],
              "title": "User",
              "type": "object"
            }
          },
          "properties": {
            "actors": {
              "$ref": "#/definitions/actor",
              "description": "The insightIDR actors that are part of the investigation",
              "order": 6,
              "title": "Actors"
            },
            "description": {
              "description": "The description of the alert",
              "order": 4,
              "title": "Description",
              "type": "string"
            },
            "investigationId": {
              "description": "The unique identifier of the investigation",
              "order": 7,
              "title": "Investigation ID",
              "type": "string"
            },
            "link": {
              "description": "The deep link to the investigation in insightIDR",
              "order": 5,
              "title": "Link",
              "type": "string"
            },
            "name": {
              "description": "The human-readable name of the alert",
              "order": 3,
              "title": "Name",
              "type": "string"
            },
            "timestamp": {
              "description": "The time the alert was triggered in ISO 8601 extended timestamp format",
              "order": 1,
              "title": "Timestamp",
              "type": "string"
            },
            "type": {
              "description": "The type of alert",
              "order": 2,
              "title": "Type",
              "type": "string"
            }
          },
          "title": "Variables",
          "type": "object"
        },
        "outputJsonSchema": {
          "definitions": {
            "actor": {
              "properties": {
                "assets": {
                  "description": "The assets that are part of the investigation",
                  "items": {
                    "$ref": "#/definitions/asset"
                  },
                  "order": 2,
                  "title": "Assets",
                  "type": "array"
                },
                "users": {
                  "description": "The users that are part of the investigation",
                  "items": {
                    "$ref": "#/definitions/user"
                  },
                  "order": 1,
                  "title": "Users",
                  "type": "array"
                }
              },
              "title": "Actor",
              "type": "object"
            },
            "asset": {
              "properties": {
                "fqdn": {
                  "description": "The fully qualified domain name",
                  "order": 2,
                  "title": "Fqdn",
                  "type": "string"
                },
                "shortname": {
                  "description": "shortname of the asset",
                  "order": 1,
                  "title": "Shortname",
                  "type": "string"
                }
              },
              "required": [
                "shortname"
              ],
              "title": "Asset",
              "type": "object"
            },
            "user": {
              "properties": {
                "distinguishedName": {
                  "description": "The Active Directory distinguished name of the user",
                  "order": 2,
                  "title": "DistinguishedName",
                  "type": "string"
                },
                "emails": {
                  "description": "The email addresses associated with the user",
                  "items": {
                    "type": "string"
                  },
                  "order": 3,
                  "title": "Emails",
                  "type": "array"
                },
                "name": {
                  "description": "The name of the user, as '<firstname> <lastname>' if available, or account name otherwise",
                  "order": 1,
                  "title": "Name",
                  "type": "string"
                }
              },
              "required": [
                "name",
                "emails"
              ],
              "title": "User",
              "type": "object"
            }
          },
          "properties": {
            "actors": {
              "$ref": "#/definitions/actor",
              "description": "The insightIDR actors that are part of the investigation",
              "order": 6,
              "title": "Actors"
            },
            "description": {
              "description": "The description of the alert",
              "order": 4,
              "title": "Description",
              "type": "string"
            },
            "investigationId": {
              "description": "The unique identifier of the investigation",
              "order": 7,
              "title": "Investigation ID",
              "type": "string"
            },
            "link": {
              "description": "The deep link to the investigation in insightIDR",
              "order": 5,
              "title": "Link",
              "type": "string"
            },
            "name": {
              "description": "The human-readable name of the alert",
              "order": 3,
              "title": "Name",
              "type": "string"
            },
            "timestamp": {
              "description": "The time the alert was triggered in ISO 8601 extended timestamp format",
              "order": 1,
              "title": "Timestamp",
              "type": "string"
            },
            "type": {
              "description": "The type of alert",
              "order": 2,
              "title": "Type",
              "type": "string"
            }
          },
          "title": "Variables",
          "type": "object"
        },
        "tags": [],
        "type": "trigger_api_idr"
      }
    ]
  }
}