{
  "kom": {
    "komandVersion": "1.50.1-0-gaec79",
    "komFileVersion": "2.0.0",
    "exportedAt": "2020-05-22T17:07:57.565345899Z",
    "workflowVersions": [
      {
        "name": "Block Host with Palo Alto Firewall from Slack",
        "type": "runnable",
        "version": "",
        "description": "Use the simplicity of a chat command in Slack to block or unblock a host in your Palo Alto Firewall.",
        "graph": {
          "edges": {
            "08ec65ca-0094-48f7-ab18-1034c59ccbc8": {
              "id": "08ec65ca-0094-48f7-ab18-1034c59ccbc8",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "983495e5-68d4-4145-949c-51c509e0d6c4",
              "toNodeId": "8d029a16-4df5-48a4-a2b1-3ca98ccb4cef"
            },
            "3d13e6b2-5096-450c-8ad5-ef27a0aefcfb": {
              "id": "3d13e6b2-5096-450c-8ad5-ef27a0aefcfb",
              "name": "Block Host",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "e4ea28d6-006e-40fc-8a79-32f290e754c3",
              "toNodeId": "7b2bd280-4565-4095-af97-de154b4426bf"
            },
            "4cb51ec4-138a-4d6c-a025-cebac2b390ed": {
              "id": "4cb51ec4-138a-4d6c-a025-cebac2b390ed",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "c4a76c43-bac4-45ae-8ec3-65cec21fef13",
              "toNodeId": "c89587c8-1f87-4f0c-9c45-4b1916a3c678"
            },
            "512cb87a-c70c-4ca9-ac04-d0197157f035": {
              "id": "512cb87a-c70c-4ca9-ac04-d0197157f035",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "b4c8d5a0-88b7-480c-b8ca-f436d2df722d",
              "toNodeId": "e4ea28d6-006e-40fc-8a79-32f290e754c3"
            },
            "67ef154f-cf25-4f17-8f4e-92d0e92d89e7": {
              "id": "67ef154f-cf25-4f17-8f4e-92d0e92d89e7",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "40cadabe-71fa-4e45-8edb-3d375ae8c7bf",
              "toNodeId": ""
            },
            "6c6b3ba0-6394-4401-a8c7-3ac2416be977": {
              "id": "6c6b3ba0-6394-4401-a8c7-3ac2416be977",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "786cbab2-9f35-44f1-b2e9-a2c236cb5a37",
              "toNodeId": "40cadabe-71fa-4e45-8edb-3d375ae8c7bf"
            },
            "766efd98-7cb1-40ad-a45e-ad0e3fd49485": {
              "id": "766efd98-7cb1-40ad-a45e-ad0e3fd49485",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "4d650a86-639d-4f34-8920-52d3c954152b",
              "toNodeId": "c4a76c43-bac4-45ae-8ec3-65cec21fef13"
            },
            "8935f832-644a-432f-85d7-992b0061c594": {
              "id": "8935f832-644a-432f-85d7-992b0061c594",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "17ba3e71-3cbd-4995-a0d4-0c3b8974ef15",
              "toNodeId": "b4c8d5a0-88b7-480c-b8ca-f436d2df722d"
            },
            "8bf59ba4-7dca-454a-b2e4-48c8ca656983": {
              "id": "8bf59ba4-7dca-454a-b2e4-48c8ca656983",
              "name": "Unblock Host",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "e4ea28d6-006e-40fc-8a79-32f290e754c3",
              "toNodeId": "13b66114-3d09-471f-b6f1-c4f996bbfc31"
            },
            "9b9c2746-b900-4847-b980-086d0e2521f6": {
              "id": "9b9c2746-b900-4847-b980-086d0e2521f6",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "85241969-7636-4ddf-ab00-6bd220c28e51",
              "toNodeId": "983495e5-68d4-4145-949c-51c509e0d6c4"
            },
            "a2040f8d-48bb-4a86-88c6-125a64d1a787": {
              "id": "a2040f8d-48bb-4a86-88c6-125a64d1a787",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "c89587c8-1f87-4f0c-9c45-4b1916a3c678",
              "toNodeId": "83782ee6-5362-4b81-8902-9d4904c8ecd8"
            },
            "abb87f31-e4e6-4120-bae7-5dceb3621d7e": {
              "id": "abb87f31-e4e6-4120-bae7-5dceb3621d7e",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "13b66114-3d09-471f-b6f1-c4f996bbfc31",
              "toNodeId": "8c18b523-d755-46d0-a37d-a3caf41e4b78"
            },
            "b5909a47-f97e-4ca1-93b7-7750509a046a": {
              "id": "b5909a47-f97e-4ca1-93b7-7750509a046a",
              "name": "No",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "95c927b8-9dba-4fb0-9c4c-882501926cea",
              "toNodeId": "6dcb8377-8bd3-4e33-ba92-49e4cf101baa"
            },
            "cbf5ab61-fc89-4b4f-ab8e-842903c212a6": {
              "id": "cbf5ab61-fc89-4b4f-ab8e-842903c212a6",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "8d029a16-4df5-48a4-a2b1-3ca98ccb4cef",
              "toNodeId": ""
            },
            "d21dee55-5783-4574-996b-56c86d5745ec": {
              "id": "d21dee55-5783-4574-996b-56c86d5745ec",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "6dcb8377-8bd3-4e33-ba92-49e4cf101baa",
              "toNodeId": ""
            },
            "e1d845ed-6ad1-493a-9275-a822cb4e6ba2": {
              "id": "e1d845ed-6ad1-493a-9275-a822cb4e6ba2",
              "name": "Yes",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "95c927b8-9dba-4fb0-9c4c-882501926cea",
              "toNodeId": "786cbab2-9f35-44f1-b2e9-a2c236cb5a37"
            },
            "eb01ead8-58c2-4064-b44c-9cbd5700ba3c": {
              "id": "eb01ead8-58c2-4064-b44c-9cbd5700ba3c",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "7b2bd280-4565-4095-af97-de154b4426bf",
              "toNodeId": "85241969-7636-4ddf-ab00-6bd220c28e51"
            },
            "edf8af0b-8b05-4284-9d01-d32f451ae5e0": {
              "id": "edf8af0b-8b05-4284-9d01-d32f451ae5e0",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "8c18b523-d755-46d0-a37d-a3caf41e4b78",
              "toNodeId": "95c927b8-9dba-4fb0-9c4c-882501926cea"
            },
            "f33fb385-16d8-46f8-9a1f-0ea5046a1898": {
              "id": "f33fb385-16d8-46f8-9a1f-0ea5046a1898",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "83782ee6-5362-4b81-8902-9d4904c8ecd8",
              "toNodeId": "17ba3e71-3cbd-4995-a0d4-0c3b8974ef15"
            }
          },
          "nodes": {
            "13b66114-3d09-471f-b6f1-c4f996bbfc31": {
              "id": "13b66114-3d09-471f-b6f1-c4f996bbfc31",
              "parentNodeId": ""
            },
            "17ba3e71-3cbd-4995-a0d4-0c3b8974ef15": {
              "id": "17ba3e71-3cbd-4995-a0d4-0c3b8974ef15",
              "parentNodeId": ""
            },
            "40cadabe-71fa-4e45-8edb-3d375ae8c7bf": {
              "id": "40cadabe-71fa-4e45-8edb-3d375ae8c7bf",
              "parentNodeId": ""
            },
            "4d650a86-639d-4f34-8920-52d3c954152b": {
              "id": "4d650a86-639d-4f34-8920-52d3c954152b",
              "parentNodeId": ""
            },
            "6dcb8377-8bd3-4e33-ba92-49e4cf101baa": {
              "id": "6dcb8377-8bd3-4e33-ba92-49e4cf101baa",
              "parentNodeId": ""
            },
            "786cbab2-9f35-44f1-b2e9-a2c236cb5a37": {
              "id": "786cbab2-9f35-44f1-b2e9-a2c236cb5a37",
              "parentNodeId": ""
            },
            "7b2bd280-4565-4095-af97-de154b4426bf": {
              "id": "7b2bd280-4565-4095-af97-de154b4426bf",
              "parentNodeId": ""
            },
            "83782ee6-5362-4b81-8902-9d4904c8ecd8": {
              "id": "83782ee6-5362-4b81-8902-9d4904c8ecd8",
              "parentNodeId": ""
            },
            "85241969-7636-4ddf-ab00-6bd220c28e51": {
              "id": "85241969-7636-4ddf-ab00-6bd220c28e51",
              "parentNodeId": ""
            },
            "8c18b523-d755-46d0-a37d-a3caf41e4b78": {
              "id": "8c18b523-d755-46d0-a37d-a3caf41e4b78",
              "parentNodeId": ""
            },
            "8d029a16-4df5-48a4-a2b1-3ca98ccb4cef": {
              "id": "8d029a16-4df5-48a4-a2b1-3ca98ccb4cef",
              "parentNodeId": ""
            },
            "95c927b8-9dba-4fb0-9c4c-882501926cea": {
              "id": "95c927b8-9dba-4fb0-9c4c-882501926cea",
              "parentNodeId": ""
            },
            "983495e5-68d4-4145-949c-51c509e0d6c4": {
              "id": "983495e5-68d4-4145-949c-51c509e0d6c4",
              "parentNodeId": ""
            },
            "b4c8d5a0-88b7-480c-b8ca-f436d2df722d": {
              "id": "b4c8d5a0-88b7-480c-b8ca-f436d2df722d",
              "parentNodeId": ""
            },
            "c4a76c43-bac4-45ae-8ec3-65cec21fef13": {
              "id": "c4a76c43-bac4-45ae-8ec3-65cec21fef13",
              "parentNodeId": ""
            },
            "c89587c8-1f87-4f0c-9c45-4b1916a3c678": {
              "id": "c89587c8-1f87-4f0c-9c45-4b1916a3c678",
              "parentNodeId": ""
            },
            "e4ea28d6-006e-40fc-8a79-32f290e754c3": {
              "id": "e4ea28d6-006e-40fc-8a79-32f290e754c3",
              "parentNodeId": ""
            }
          }
        },
        "steps": {
          "13b66114-3d09-471f-b6f1-c4f996bbfc31": {
            "nodeId": "13b66114-3d09-471f-b6f1-c4f996bbfc31",
            "name": "Unblock Host Artifact",
            "type": "artifact",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "content": "Unblock Host Command Received"
              },
              "type": "markdown"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://us.cdn-assets.connect.insight.rapid7.com/step-type-icons/artifact.svg",
            "connectionType": "NONE"
          },
          "17ba3e71-3cbd-4995-a0d4-0c3b8974ef15": {
            "nodeId": "17ba3e71-3cbd-4995-a0d4-0c3b8974ef15",
            "name": "Command",
            "type": "artifact",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "content": "{{[c89587c8-1f87-4f0c-9c45-4b1916a3c678].[command]}}"
              },
              "type": "markdown"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://us.cdn-assets.connect.insight.rapid7.com/step-type-icons/artifact.svg",
            "connectionType": "NONE"
          },
          "40cadabe-71fa-4e45-8edb-3d375ae8c7bf": {
            "nodeId": "40cadabe-71fa-4e45-8edb-3d375ae8c7bf",
            "name": "Workflow Success Message Unblock ",
            "type": "action_chatops",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "attachments": [],
                "message": "🚨  *Workflow Success*  🚨\n\nUnblocked: {{[83782ee6-5362-4b81-8902-9d4904c8ecd8].[content]}}\n\n*Workflow Complete*  ✅\n",
                "recipient": "@{{[4d650a86-639d-4f34-8920-52d3c954152b].[message].[user]}}",
                "thread_ts": "{{[4d650a86-639d-4f34-8920-52d3c954152b].[message].[ts]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "attachments": {
                  "description": "JSON array of attachments - see https://api.slack.com/docs/message-attachments (Advanced)",
                  "items": {
                    "type": "object"
                  },
                  "order": 4,
                  "title": "Attachments",
                  "type": "array"
                },
                "message": {
                  "description": "Message to send",
                  "order": 3,
                  "title": "Message",
                  "type": "string"
                },
                "recipient": {
                  "description": "Channels begin with # (e.g. #channel) and usernames begin with @ (e.g. @username)",
                  "order": 1,
                  "title": "Enter #channel or @username",
                  "type": "string"
                },
                "thread_ts": {
                  "description": "Select timestamp output variable from parent message step",
                  "order": 2,
                  "title": "To post in a thread, select parent message timestamp",
                  "type": "string"
                }
              },
              "required": [
                "recipient"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "channel_id": {
                  "description": "ChannelID of successful message",
                  "order": 1,
                  "title": "Channel ID",
                  "type": "string"
                },
                "timestamp": {
                  "description": "Timestamp of successful message",
                  "order": 2,
                  "title": "Timestamp",
                  "type": "string"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "NONE",
            "chatOpsAppName": "slack",
            "chatOpsIdentifier": "post_message"
          },
          "4d650a86-639d-4f34-8920-52d3c954152b": {
            "nodeId": "4d650a86-639d-4f34-8920-52d3c954152b",
            "name": "Slack Trigger",
            "type": "trigger",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "matchChannel": "",
                "matchText": "^block-host.*|^unblock-host.*",
                "type": "any"
              }
            },
            "triggerId": "5a971cde-b970-479b-8cec-34699ad761af",
            "defaultInputJSONSchema": {
              "properties": {
                "matchChannel": {
                  "description": "Regex to match for channel name",
                  "order": 1,
                  "title": "Match Channel",
                  "type": "string"
                },
                "matchText": {
                  "description": "Regex to match for Slack message content",
                  "order": 2,
                  "title": "Match Text",
                  "type": "string"
                },
                "type": {
                  "default": "any",
                  "description": "Desired Slack channel type: direct message to Slack app, group chats, or all channels",
                  "enum": [
                    "any",
                    "direct",
                    "group"
                  ],
                  "order": 3,
                  "title": "Type",
                  "type": "string"
                }
              },
              "required": [
                "type"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "definitions": {
                "message": {
                  "properties": {
                    "channel": {
                      "description": "Channel name",
                      "order": 3,
                      "title": "Channel",
                      "type": "string"
                    },
                    "channel_id": {
                      "description": "Slack channel ID",
                      "order": 4,
                      "title": "Channel ID",
                      "type": "string"
                    },
                    "text": {
                      "description": "Text",
                      "order": 5,
                      "title": "Text",
                      "type": "string"
                    },
                    "ts": {
                      "description": "Timestamp",
                      "order": 6,
                      "title": "Ts",
                      "type": "string"
                    },
                    "user": {
                      "description": "User name",
                      "order": 1,
                      "title": "User",
                      "type": "string"
                    },
                    "user_id": {
                      "description": "Slack User ID",
                      "order": 2,
                      "title": "User ID",
                      "type": "string"
                    }
                  },
                  "title": "Message",
                  "type": "object"
                }
              },
              "properties": {
                "display_name": {
                  "description": "User display name",
                  "order": 4,
                  "title": "Display Name",
                  "type": "string"
                },
                "message": {
                  "$ref": "#/definitions/message",
                  "description": "Message",
                  "order": 1,
                  "title": "Message"
                },
                "timestamp": {
                  "description": "Timestamp",
                  "order": 3,
                  "title": "Timestamp",
                  "type": "string"
                },
                "type": {
                  "description": "Message Type",
                  "order": 2,
                  "title": "Type",
                  "type": "string"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "https://us.cdn-assets.connect.insight.rapid7.com/step-type-icons/chatops.svg",
            "connectionType": "NONE",
            "chatOpsAppName": "slack",
            "chatOpsIdentifier": "message"
          },
          "6dcb8377-8bd3-4e33-ba92-49e4cf101baa": {
            "nodeId": "6dcb8377-8bd3-4e33-ba92-49e4cf101baa",
            "name": "Workflow Failed Message",
            "type": "action_chatops",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "attachments": [],
                "message": "*Workflow Failed*\n\nCould not find host \"{{[83782ee6-5362-4b81-8902-9d4904c8ecd8].[content]}}\" in block list\n\nMore information can be found here: \n{{[$job].[URL]}}\n\n*Workflow Failed* ❗",
                "recipient": "@{{[4d650a86-639d-4f34-8920-52d3c954152b].[message].[user]}}",
                "thread_ts": "{{[4d650a86-639d-4f34-8920-52d3c954152b].[message].[ts]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "attachments": {
                  "description": "JSON array of attachments - see https://api.slack.com/docs/message-attachments (Advanced)",
                  "items": {
                    "type": "object"
                  },
                  "order": 4,
                  "title": "Attachments",
                  "type": "array"
                },
                "message": {
                  "description": "Message to send",
                  "order": 3,
                  "title": "Message",
                  "type": "string"
                },
                "recipient": {
                  "description": "Channels begin with # (e.g. #channel) and usernames begin with @ (e.g. @username)",
                  "order": 1,
                  "title": "Enter #channel or @username",
                  "type": "string"
                },
                "thread_ts": {
                  "description": "Select timestamp output variable from parent message step",
                  "order": 2,
                  "title": "To post in a thread, select parent message timestamp",
                  "type": "string"
                }
              },
              "required": [
                "recipient"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "channel_id": {
                  "description": "ChannelID of successful message",
                  "order": 1,
                  "title": "Channel ID",
                  "type": "string"
                },
                "timestamp": {
                  "description": "Timestamp of successful message",
                  "order": 2,
                  "title": "Timestamp",
                  "type": "string"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "NONE",
            "chatOpsAppName": "slack",
            "chatOpsIdentifier": "post_message"
          },
          "786cbab2-9f35-44f1-b2e9-a2c236cb5a37": {
            "nodeId": "786cbab2-9f35-44f1-b2e9-a2c236cb5a37",
            "name": "Remove Address Object from Group",
            "type": "action",
            "plugin": {
              "name": "Palo Alto Firewall",
              "slugVendor": "rapid7",
              "slugName": "palo_alto_pan_os",
              "slugVersion": "5.1.1",
              "imageData": "https://us.cdn-assets.connect.insight.rapid7.com/icons/rapid7/palo_alto_pan_os/5.1.1/icon.png"
            },
            "identifier": "remove_address_object_from_group",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "address_object": "{{[8c18b523-d755-46d0-a37d-a3caf41e4b78].[address_objects].[0]}}",
                "device_name": "localhost.localdomain",
                "group": "ICON Block List",
                "virtual_system": "vsys1"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "address_object": {
                  "description": "The name of the address object to remove",
                  "order": 1,
                  "title": "Address Object",
                  "type": "string"
                },
                "device_name": {
                  "default": "localhost.localdomain",
                  "description": "Device name",
                  "order": 3,
                  "title": "Device Name",
                  "type": "string"
                },
                "group": {
                  "description": "Group name",
                  "order": 2,
                  "title": "Group",
                  "type": "string"
                },
                "virtual_system": {
                  "default": "vsys1",
                  "description": "Virtual system name",
                  "order": 4,
                  "title": "Virtual System Name",
                  "type": "string"
                }
              },
              "required": [
                "group",
                "device_name",
                "virtual_system",
                "address_object"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "success": {
                  "description": "Was operation successful",
                  "order": 1,
                  "title": "Success",
                  "type": "boolean"
                }
              },
              "required": [
                "success"
              ],
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          },
          "7b2bd280-4565-4095-af97-de154b4426bf": {
            "nodeId": "7b2bd280-4565-4095-af97-de154b4426bf",
            "name": "Block Host Command Received",
            "type": "artifact",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "content": "Block Host Command Received"
              },
              "type": "markdown"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://us.cdn-assets.connect.insight.rapid7.com/step-type-icons/artifact.svg",
            "connectionType": "NONE"
          },
          "83782ee6-5362-4b81-8902-9d4904c8ecd8": {
            "nodeId": "83782ee6-5362-4b81-8902-9d4904c8ecd8",
            "name": "Host",
            "type": "artifact",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "content": "{{[c89587c8-1f87-4f0c-9c45-4b1916a3c678].[host]}}"
              },
              "type": "markdown"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://us.cdn-assets.connect.insight.rapid7.com/step-type-icons/artifact.svg",
            "connectionType": "NONE"
          },
          "85241969-7636-4ddf-ab00-6bd220c28e51": {
            "nodeId": "85241969-7636-4ddf-ab00-6bd220c28e51",
            "name": "Create Network Object",
            "type": "action",
            "plugin": {
              "name": "Palo Alto Firewall",
              "slugVendor": "rapid7",
              "slugName": "palo_alto_pan_os",
              "slugVersion": "5.1.1",
              "imageData": "https://us.cdn-assets.connect.insight.rapid7.com/icons/rapid7/palo_alto_pan_os/5.1.1/icon.png"
            },
            "identifier": "set_address_object",
            "continueOnFailure": true,
            "isDisabled": false,
            "parameters": {
              "input": {
                "address": "{{[83782ee6-5362-4b81-8902-9d4904c8ecd8].[content]}}",
                "address_object": "{{[83782ee6-5362-4b81-8902-9d4904c8ecd8].[content]}}",
                "description": "InsightConnect Created Address Object",
                "tags": "",
                "whitelist": []
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "address": {
                  "description": "The IP address, network CIDR, or FQDN e.g. 192.168.1.1, 192.168.1.0/24, google.com google.com",
                  "order": 1,
                  "title": "Address",
                  "type": "string"
                },
                "address_object": {
                  "description": "The name of the address object",
                  "order": 2,
                  "title": "Address Object",
                  "type": "string"
                },
                "description": {
                  "description": "A description for the address object",
                  "order": 3,
                  "title": "Description",
                  "type": "string"
                },
                "tags": {
                  "description": "Tags for the address object. Use commas to separate multiple tags",
                  "order": 4,
                  "title": "Tags",
                  "type": "string"
                },
                "whitelist": {
                  "description": "This list contains a set of network objects that should not be blocked. This can include IPs, CIDR notation, or domains. It can not include an IP range (such as 10.0.0.0-10.0.0.10)",
                  "items": {
                    "type": "string"
                  },
                  "order": 5,
                  "title": "Whitelist",
                  "type": "array"
                }
              },
              "required": [
                "address",
                "address_object"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "code": {
                  "description": "Response code from the firewall",
                  "order": 2,
                  "title": "Code",
                  "type": "string"
                },
                "message": {
                  "description": "A message with more detail about the status",
                  "order": 3,
                  "title": "Message",
                  "type": "string"
                },
                "status": {
                  "description": "The status of the requested operation e.g. success, error, etc",
                  "order": 1,
                  "title": "Status",
                  "type": "string"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          },
          "8c18b523-d755-46d0-a37d-a3caf41e4b78": {
            "nodeId": "8c18b523-d755-46d0-a37d-a3caf41e4b78",
            "name": "Check if IP in Group",
            "type": "action",
            "plugin": {
              "name": "Palo Alto Firewall",
              "slugVendor": "rapid7",
              "slugName": "palo_alto_pan_os",
              "slugVersion": "5.1.1",
              "imageData": "https://us.cdn-assets.connect.insight.rapid7.com/icons/rapid7/palo_alto_pan_os/5.1.1/icon.png"
            },
            "identifier": "check_if_address_object_in_group",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "address": "{{[83782ee6-5362-4b81-8902-9d4904c8ecd8].[content]}}",
                "device_name": "localhost.localdomain",
                "enable_search": true,
                "group": "ICON Block List",
                "virtual_system": "vsys1"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "address": {
                  "description": "The Address Object name to check. If Enable Search is set to true then we search the addresses (IP, CIDR, doman) within the address object instead of matching the name",
                  "order": 2,
                  "title": "Address",
                  "type": "string"
                },
                "device_name": {
                  "default": "localhost.localdomain",
                  "description": "Device name",
                  "order": 4,
                  "title": "Device Name",
                  "type": "string"
                },
                "enable_search": {
                  "default": false,
                  "description": "When enabled, the Address input will accept a IP, CIDR, or domain name to search across the available Address Objects in the system. This is useful when you don’t know the Address Object by its name",
                  "order": 3,
                  "title": "Enable Search",
                  "type": "boolean"
                },
                "group": {
                  "description": "Group name",
                  "order": 1,
                  "title": "Group",
                  "type": "string"
                },
                "virtual_system": {
                  "default": "vsys1",
                  "description": "Virtual system name",
                  "order": 5,
                  "title": "Virtual System Name",
                  "type": "string"
                }
              },
              "required": [
                "enable_search",
                "device_name",
                "virtual_system",
                "group",
                "address"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "address_objects": {
                  "description": "The names of the address objects that match or contain address",
                  "items": {
                    "type": "string"
                  },
                  "order": 2,
                  "title": "Address Objects",
                  "type": "array"
                },
                "found": {
                  "description": "Was address found in group",
                  "order": 1,
                  "title": "Found",
                  "type": "boolean"
                }
              },
              "required": [
                "found"
              ],
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          },
          "8d029a16-4df5-48a4-a2b1-3ca98ccb4cef": {
            "nodeId": "8d029a16-4df5-48a4-a2b1-3ca98ccb4cef",
            "name": "Workflow Success Message Block",
            "type": "action_chatops",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "attachments": [],
                "message": "🚨  *Workflow Success* 🚨\n\nBlocked: {{[83782ee6-5362-4b81-8902-9d4904c8ecd8].[content]}}\n\n*Workflow Complete*  ✅\n\n",
                "recipient": "@{{[4d650a86-639d-4f34-8920-52d3c954152b].[message].[user]}}",
                "thread_ts": "{{[4d650a86-639d-4f34-8920-52d3c954152b].[message].[ts]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "attachments": {
                  "description": "JSON array of attachments - see https://api.slack.com/docs/message-attachments (Advanced)",
                  "items": {
                    "type": "object"
                  },
                  "order": 4,
                  "title": "Attachments",
                  "type": "array"
                },
                "message": {
                  "description": "Message to send",
                  "order": 3,
                  "title": "Message",
                  "type": "string"
                },
                "recipient": {
                  "description": "Channels begin with # (e.g. #channel) and usernames begin with @ (e.g. @username)",
                  "order": 1,
                  "title": "Enter #channel or @username",
                  "type": "string"
                },
                "thread_ts": {
                  "description": "Select timestamp output variable from parent message step",
                  "order": 2,
                  "title": "To post in a thread, select parent message timestamp",
                  "type": "string"
                }
              },
              "required": [
                "recipient"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "channel_id": {
                  "description": "ChannelID of successful message",
                  "order": 1,
                  "title": "Channel ID",
                  "type": "string"
                },
                "timestamp": {
                  "description": "Timestamp of successful message",
                  "order": 2,
                  "title": "Timestamp",
                  "type": "string"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "NONE",
            "chatOpsAppName": "slack",
            "chatOpsIdentifier": "post_message"
          },
          "95c927b8-9dba-4fb0-9c4c-882501926cea": {
            "nodeId": "95c927b8-9dba-4fb0-9c4c-882501926cea",
            "name": "Is IP in Group",
            "type": "automated_decision",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "defaultEdgeId": "b5909a47-f97e-4ca1-93b7-7750509a046a",
              "stepControlParams": [
                {
                  "edgeId": "e1d845ed-6ad1-493a-9275-a822cb4e6ba2",
                  "expression": {
                    "name": "8c18b523-d755-46d0-a37d-a3caf41e4b78.found",
                    "type": "variable"
                  },
                  "expressionText": "{{[8c18b523-d755-46d0-a37d-a3caf41e4b78].[found]}}"
                },
                {
                  "edgeId": "b5909a47-f97e-4ca1-93b7-7750509a046a",
                  "expression": {},
                  "expressionText": ""
                }
              ]
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://us.cdn-assets.connect.insight.rapid7.com/step-type-icons/automated-decision.svg",
            "connectionType": "NONE"
          },
          "983495e5-68d4-4145-949c-51c509e0d6c4": {
            "nodeId": "983495e5-68d4-4145-949c-51c509e0d6c4",
            "name": "Add Object to Group",
            "type": "action",
            "plugin": {
              "name": "Palo Alto Firewall",
              "slugVendor": "rapid7",
              "slugName": "palo_alto_pan_os",
              "slugVersion": "5.1.1",
              "imageData": "https://us.cdn-assets.connect.insight.rapid7.com/icons/rapid7/palo_alto_pan_os/5.1.1/icon.png"
            },
            "identifier": "add_address_object_to_group",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "address_object": "{{[83782ee6-5362-4b81-8902-9d4904c8ecd8].[content]}}",
                "device_name": "localhost.localdomain",
                "group": "ICON Block List",
                "virtual_system": "vsys1"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "address_object": {
                  "description": "The name of the address object to add",
                  "order": 1,
                  "title": "Address Object",
                  "type": "string"
                },
                "device_name": {
                  "default": "localhost.localdomain",
                  "description": "Device name",
                  "order": 3,
                  "title": "Device Name",
                  "type": "string"
                },
                "group": {
                  "description": "Group name",
                  "order": 2,
                  "title": "Group",
                  "type": "string"
                },
                "virtual_system": {
                  "default": "vsys1",
                  "description": "Virtual system name",
                  "order": 4,
                  "title": "Virtual System Name",
                  "type": "string"
                }
              },
              "required": [
                "device_name",
                "virtual_system",
                "address_object",
                "group"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "address_objects": {
                  "description": "Address objects currently in group",
                  "items": {
                    "type": "string"
                  },
                  "order": 2,
                  "title": "Address Objects",
                  "type": "array"
                },
                "success": {
                  "description": "Was operation successful",
                  "order": 1,
                  "title": "Success",
                  "type": "boolean"
                }
              },
              "required": [
                "success",
                "address_objects"
              ],
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          },
          "b4c8d5a0-88b7-480c-b8ca-f436d2df722d": {
            "nodeId": "b4c8d5a0-88b7-480c-b8ca-f436d2df722d",
            "name": "Workflow Starting Message",
            "type": "action_chatops",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "attachments": [],
                "message": "*Workflow Starting*\n\nCommand: {{[17ba3e71-3cbd-4995-a0d4-0c3b8974ef15].[content]}}\nHost: {{[83782ee6-5362-4b81-8902-9d4904c8ecd8].[content]}}\n\n",
                "recipient": "@{{[4d650a86-639d-4f34-8920-52d3c954152b].[message].[user]}}",
                "thread_ts": "{{[4d650a86-639d-4f34-8920-52d3c954152b].[message].[ts]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "attachments": {
                  "description": "JSON array of attachments - see https://api.slack.com/docs/message-attachments (Advanced)",
                  "items": {
                    "type": "object"
                  },
                  "order": 4,
                  "title": "Attachments",
                  "type": "array"
                },
                "message": {
                  "description": "Message to send",
                  "order": 3,
                  "title": "Message",
                  "type": "string"
                },
                "recipient": {
                  "description": "Channels begin with # (e.g. #channel) and usernames begin with @ (e.g. @username)",
                  "order": 1,
                  "title": "Enter #channel or @username",
                  "type": "string"
                },
                "thread_ts": {
                  "description": "Select timestamp output variable from parent message step",
                  "order": 2,
                  "title": "To post in a thread, select parent message timestamp",
                  "type": "string"
                }
              },
              "required": [
                "recipient"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "channel_id": {
                  "description": "ChannelID of successful message",
                  "order": 1,
                  "title": "Channel ID",
                  "type": "string"
                },
                "timestamp": {
                  "description": "Timestamp of successful message",
                  "order": 2,
                  "title": "Timestamp",
                  "type": "string"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "NONE",
            "chatOpsAppName": "slack",
            "chatOpsIdentifier": "post_message"
          },
          "c4a76c43-bac4-45ae-8ec3-65cec21fef13": {
            "nodeId": "c4a76c43-bac4-45ae-8ec3-65cec21fef13",
            "name": "Message Received",
            "type": "artifact",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "content": "{{[4d650a86-639d-4f34-8920-52d3c954152b].[message]}}"
              },
              "type": "markdown"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://us.cdn-assets.connect.insight.rapid7.com/step-type-icons/artifact.svg",
            "connectionType": "NONE"
          },
          "c89587c8-1f87-4f0c-9c45-4b1916a3c678": {
            "nodeId": "c89587c8-1f87-4f0c-9c45-4b1916a3c678",
            "name": "Parse Slack Command",
            "type": "action",
            "plugin": {
              "name": "Python 3 Script",
              "slugVendor": "rapid7",
              "slugName": "python_3_script",
              "slugVersion": "2.0.1",
              "imageData": "https://us.cdn-assets.connect.insight.rapid7.com/icons/rapid7/python_3_script/2.0.1/icon.png"
            },
            "identifier": "run",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "function": "def run(params={}):\n\n    # Sometimes Slack will give us email in their linked form:\n    # <mailto:user@example.com>\n    # or\n    # <http://www.exmaple.com|example.com>\n    def parse_slack_tags(email):\n\n        if email.startswith(\"<\"):\n            # mailto link\n            if \"mailto:\" in email:\n                split_email = email.split(\":\")[1]\n                if \"|\" in split_email:\n                    return split_email.split(\"|\")[0]\n                return split_email\n\n            # http link\n            if \"http:\" in email:\n                split_email = email.split(\"|\")[1]\n                split_email = split_email.rstrip(\">\")\n                return split_email\n\n        return email\n\n    import shlex\n    input = params.get(\"input\")\n\n    # Sometimes slack gives us unicode spaces\n    input = input.replace(u'\\xa0', u' ')\n\n    # split our args\n    args = shlex.split(input)\n\n    # if you @ the bot, you will get the bot ID first in the message\n    # example: <asdfasdf> block_host 1.1.1.1\n    # a direct message will look like this\n    # block_host 1.1.1.1\n    args_count = len(args)\n    if args_count == 2:\n        host = parse_slack_tags(args[1])\n        command = parse_slack_tags(args[0])\n    else:\n        host = parse_slack_tags(args[2])\n        command = parse_slack_tags(args[1])\n\n\n    args_for_block_host = {\n        \"host\": host,\n        \"command\": command\n    }\n\n    return(args_for_block_host)",
                "input": {
                  "input": "{{[4d650a86-639d-4f34-8920-52d3c954152b].[message].[text]}}"
                }
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "function": {
                  "default": "def run(params={}):\\n    return {}",
                  "description": "Function definition. Must be named `run`. Accepts the `input` object as params. Returns the dict as output",
                  "displayType": "python",
                  "format": "python",
                  "order": 1,
                  "title": "Function",
                  "type": "string"
                },
                "input": {
                  "description": "Input object to be passed as `params={}` to the `run` function",
                  "order": 2,
                  "title": "Input",
                  "type": "object"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "result1": {
                  "description": "Sample output result1 (delete or edit)",
                  "order": 1,
                  "title": "Result1",
                  "type": "string"
                },
                "result2": {
                  "description": "Sample output result2 (delete or edit)",
                  "order": 2,
                  "title": "Result2",
                  "type": "string"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": {
              "definitions": {},
              "properties": {
                "command": {
                  "type": "string"
                },
                "host": {
                  "type": "string"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          },
          "e4ea28d6-006e-40fc-8a79-32f290e754c3": {
            "nodeId": "e4ea28d6-006e-40fc-8a79-32f290e754c3",
            "name": "Type of command",
            "type": "automated_decision",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "defaultEdgeId": "3d13e6b2-5096-450c-8ad5-ef27a0aefcfb",
              "stepControlParams": [
                {
                  "edgeId": "3d13e6b2-5096-450c-8ad5-ef27a0aefcfb",
                  "expression": {},
                  "expressionText": ""
                },
                {
                  "edgeId": "8bf59ba4-7dca-454a-b2e4-48c8ca656983",
                  "expression": {
                    "left": {
                      "name": "17ba3e71-3cbd-4995-a0d4-0c3b8974ef15.content",
                      "type": "variable"
                    },
                    "op": "=",
                    "right": {
                      "type": "literal",
                      "value": "unblock-host"
                    },
                    "type": "binary"
                  },
                  "expressionText": "{{[17ba3e71-3cbd-4995-a0d4-0c3b8974ef15].[content]}} = \"unblock-host\""
                }
              ]
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://us.cdn-assets.connect.insight.rapid7.com/step-type-icons/automated-decision.svg",
            "connectionType": "NONE"
          }
        },
        "tags": null,
        "humanCostSeconds": 0,
        "humanCostDisplayUnit": ""
      }
    ],
    "triggers": [
      {
        "id": "5a971cde-b970-479b-8cec-34699ad761af",
        "name": "Slack Trigger",
        "description": "",
        "input": {
          "matchChannel": "",
          "matchText": "^block-host.*|^unblock-host.*",
          "type": "any"
        },
        "inputJsonSchema": {
          "properties": {
            "matchChannel": {
              "description": "Regex to match for channel name",
              "order": 1,
              "title": "Match Channel",
              "type": "string"
            },
            "matchText": {
              "description": "Regex to match for Slack message content",
              "order": 2,
              "title": "Match Text",
              "type": "string"
            },
            "type": {
              "default": "any",
              "description": "Desired Slack channel type: direct message to Slack app, group chats, or all channels",
              "enum": [
                "any",
                "direct",
                "group"
              ],
              "order": 3,
              "title": "Type",
              "type": "string"
            }
          },
          "required": [
            "type"
          ],
          "title": "Variables",
          "type": "object"
        },
        "outputJsonSchema": {
          "definitions": {
            "message": {
              "properties": {
                "channel": {
                  "description": "Channel name",
                  "order": 3,
                  "title": "Channel",
                  "type": "string"
                },
                "channel_id": {
                  "description": "Slack channel ID",
                  "order": 4,
                  "title": "Channel ID",
                  "type": "string"
                },
                "text": {
                  "description": "Text",
                  "order": 5,
                  "title": "Text",
                  "type": "string"
                },
                "ts": {
                  "description": "Timestamp",
                  "order": 6,
                  "title": "Ts",
                  "type": "string"
                },
                "user": {
                  "description": "User name",
                  "order": 1,
                  "title": "User",
                  "type": "string"
                },
                "user_id": {
                  "description": "Slack User ID",
                  "order": 2,
                  "title": "User ID",
                  "type": "string"
                }
              },
              "title": "Message",
              "type": "object"
            }
          },
          "properties": {
            "display_name": {
              "description": "User display name",
              "order": 4,
              "title": "Display Name",
              "type": "string"
            },
            "message": {
              "$ref": "#/definitions/message",
              "description": "Message",
              "order": 1,
              "title": "Message"
            },
            "timestamp": {
              "description": "Timestamp",
              "order": 3,
              "title": "Timestamp",
              "type": "string"
            },
            "type": {
              "description": "Message Type",
              "order": 2,
              "title": "Type",
              "type": "string"
            }
          },
          "title": "Variables",
          "type": "object"
        },
        "tags": [],
        "type": "trigger_chatops",
        "chatOpsAppName": "slack",
        "chatOpsIdentifier": "message"
      }
    ]
  }
}