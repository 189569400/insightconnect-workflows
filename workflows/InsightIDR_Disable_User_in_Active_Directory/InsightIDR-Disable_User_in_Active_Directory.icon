{
  "kom": {
    "komandVersion": "1.36.2-0-g46dcf",
    "komFileVersion": "2.0.0",
    "exportedAt": "2019-09-05T03:11:37.219789386Z",
    "workflowVersions": [
      {
        "id": "6962c2ed-021a-4f64-9859-f008950c5333",
        "workflowId": "441150e4-23e0-4300-b3a2-6cb591549a30",
        "name": "Disable User in Active Directory",
        "type": "runnable",
        "version": "1.0.0",
        "description": "",
        "tags": [
          "insightidr",
          "ldap",
          "ad",
          "activedirectory",
          "user",
          "disable",
          "deprovision"
        ],
        "state": "",
        "meta": {
          "idrValidationMode": "ALL",
          "idrWorkflowCategory": "CONTAINMENT",
          "idrOriginalTemplateName": "Disable User in Active Directory"
        },
        "graph": {
          "edges": {
            "019ef001-3980-d9d5-8c65-d828bef63886": {
              "id": "019ef001-3980-d9d5-8c65-d828bef63886",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "d03147c3-addb-ef93-5e6c-50f6543883dd",
              "toNodeId": ""
            },
            "0ac43670-3f54-7e16-a6b3-29c85f806bc6": {
              "id": "0ac43670-3f54-7e16-a6b3-29c85f806bc6",
              "name": "No",
              "description": "No",
              "parentNodeId": "d03147c3-addb-ef93-5e6c-50f6543883dd",
              "fromNodeId": "d3260ada-19b3-9439-7c5d-df470e40e029",
              "toNodeId": ""
            },
            "27342530-0443-2146-e645-8c948e2be01c": {
              "id": "27342530-0443-2146-e645-8c948e2be01c",
              "name": "Yes",
              "description": "Yes",
              "parentNodeId": "d03147c3-addb-ef93-5e6c-50f6543883dd",
              "fromNodeId": "480b4c67-001b-b55d-6256-c53ba5a9c11d",
              "toNodeId": "62a0c7c3-5501-0f07-afec-777b927b6ee4"
            },
            "4a05caef-af2f-defe-4a37-1b5105214ae3": {
              "id": "4a05caef-af2f-defe-4a37-1b5105214ae3",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "3e895203-7cc2-65fe-2973-3f8e4cafcc0e",
              "toNodeId": "d03147c3-addb-ef93-5e6c-50f6543883dd"
            },
            "4c8eaaa0-001a-510a-c5ee-c33eba26a2c6": {
              "id": "4c8eaaa0-001a-510a-c5ee-c33eba26a2c6",
              "name": "No",
              "description": "No",
              "parentNodeId": "d03147c3-addb-ef93-5e6c-50f6543883dd",
              "fromNodeId": "2b1a2862-37c0-752f-9518-1018649cb536",
              "toNodeId": "1d2d6abf-cd20-823c-a9f4-76317247e00a"
            },
            "5d442586-fa84-c407-3408-d13405ca25cb": {
              "id": "5d442586-fa84-c407-3408-d13405ca25cb",
              "name": "",
              "description": "",
              "parentNodeId": "d03147c3-addb-ef93-5e6c-50f6543883dd",
              "fromNodeId": "de3e0af3-3d88-a62d-88c1-aa6496a9e134",
              "toNodeId": ""
            },
            "6669f7fd-58a7-1a16-29fa-56d607a0f84a": {
              "id": "6669f7fd-58a7-1a16-29fa-56d607a0f84a",
              "name": "",
              "description": "",
              "parentNodeId": "d03147c3-addb-ef93-5e6c-50f6543883dd",
              "fromNodeId": "d03147c3-addb-ef93-5e6c-50f6543883dd",
              "toNodeId": "480b4c67-001b-b55d-6256-c53ba5a9c11d"
            },
            "79675511-f40d-bd2b-1bea-5828c752c810": {
              "id": "79675511-f40d-bd2b-1bea-5828c752c810",
              "name": "",
              "description": "",
              "parentNodeId": "d03147c3-addb-ef93-5e6c-50f6543883dd",
              "fromNodeId": "558dc7c5-4d7d-0916-ea82-ec5cb2808710",
              "toNodeId": "d3260ada-19b3-9439-7c5d-df470e40e029"
            },
            "7dac49c9-e681-51c5-9c1c-3bb05183730f": {
              "id": "7dac49c9-e681-51c5-9c1c-3bb05183730f",
              "name": "",
              "description": "",
              "parentNodeId": "d03147c3-addb-ef93-5e6c-50f6543883dd",
              "fromNodeId": "62a0c7c3-5501-0f07-afec-777b927b6ee4",
              "toNodeId": "9ccef593-56cd-4438-9e55-bade67c10c54"
            },
            "9335864d-7223-8e58-ece1-544be3524ed0": {
              "id": "9335864d-7223-8e58-ece1-544be3524ed0",
              "name": "Yes",
              "description": "Yes",
              "parentNodeId": "d03147c3-addb-ef93-5e6c-50f6543883dd",
              "fromNodeId": "d3260ada-19b3-9439-7c5d-df470e40e029",
              "toNodeId": "c5111401-f1a6-8217-c72a-ca17479870c5"
            },
            "aec2c439-a088-d565-6b20-9d66df45be9e": {
              "id": "aec2c439-a088-d565-6b20-9d66df45be9e",
              "name": "Yes",
              "description": "Exactly one entry is returned from the distinguished name query.",
              "parentNodeId": "d03147c3-addb-ef93-5e6c-50f6543883dd",
              "fromNodeId": "2b1a2862-37c0-752f-9518-1018649cb536",
              "toNodeId": "558dc7c5-4d7d-0916-ea82-ec5cb2808710"
            },
            "af092418-ac63-d4c8-e6fb-bba7967dcbf7": {
              "id": "af092418-ac63-d4c8-e6fb-bba7967dcbf7",
              "name": "",
              "description": "",
              "parentNodeId": "d03147c3-addb-ef93-5e6c-50f6543883dd",
              "fromNodeId": "c5111401-f1a6-8217-c72a-ca17479870c5",
              "toNodeId": "de3e0af3-3d88-a62d-88c1-aa6496a9e134"
            },
            "af0baea9-6b64-c0a1-ee3a-781b2db4cac4": {
              "id": "af0baea9-6b64-c0a1-ee3a-781b2db4cac4",
              "name": "No",
              "description": "No",
              "parentNodeId": "d03147c3-addb-ef93-5e6c-50f6543883dd",
              "fromNodeId": "480b4c67-001b-b55d-6256-c53ba5a9c11d",
              "toNodeId": "e5e2a6f3-311b-e617-055e-f0f169802720"
            },
            "c427e7ed-1928-3264-302a-9acaad3ba532": {
              "id": "c427e7ed-1928-3264-302a-9acaad3ba532",
              "name": "",
              "description": "",
              "parentNodeId": "d03147c3-addb-ef93-5e6c-50f6543883dd",
              "fromNodeId": "9ccef593-56cd-4438-9e55-bade67c10c54",
              "toNodeId": "2b1a2862-37c0-752f-9518-1018649cb536"
            },
            "d2954014-5f75-0a6f-b90c-52aa216915b5": {
              "id": "d2954014-5f75-0a6f-b90c-52aa216915b5",
              "name": "",
              "description": "",
              "parentNodeId": "d03147c3-addb-ef93-5e6c-50f6543883dd",
              "fromNodeId": "e5e2a6f3-311b-e617-055e-f0f169802720",
              "toNodeId": ""
            },
            "d653322f-ecbf-76b6-4023-20f0b7022444": {
              "id": "d653322f-ecbf-76b6-4023-20f0b7022444",
              "name": "",
              "description": "",
              "parentNodeId": "d03147c3-addb-ef93-5e6c-50f6543883dd",
              "fromNodeId": "1d2d6abf-cd20-823c-a9f4-76317247e00a",
              "toNodeId": ""
            },
            "e6b048d5-de12-62b5-6ab4-dc47beb99c2c": {
              "id": "e6b048d5-de12-62b5-6ab4-dc47beb99c2c",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "83aea8d8-a1e6-0a0b-2b19-be815fc36e27",
              "toNodeId": "3e895203-7cc2-65fe-2973-3f8e4cafcc0e"
            }
          },
          "nodes": {
            "1d2d6abf-cd20-823c-a9f4-76317247e00a": {
              "id": "1d2d6abf-cd20-823c-a9f4-76317247e00a",
              "parentNodeId": "d03147c3-addb-ef93-5e6c-50f6543883dd"
            },
            "2b1a2862-37c0-752f-9518-1018649cb536": {
              "id": "2b1a2862-37c0-752f-9518-1018649cb536",
              "parentNodeId": "d03147c3-addb-ef93-5e6c-50f6543883dd"
            },
            "3e895203-7cc2-65fe-2973-3f8e4cafcc0e": {
              "id": "3e895203-7cc2-65fe-2973-3f8e4cafcc0e",
              "parentNodeId": ""
            },
            "480b4c67-001b-b55d-6256-c53ba5a9c11d": {
              "id": "480b4c67-001b-b55d-6256-c53ba5a9c11d",
              "parentNodeId": "d03147c3-addb-ef93-5e6c-50f6543883dd"
            },
            "558dc7c5-4d7d-0916-ea82-ec5cb2808710": {
              "id": "558dc7c5-4d7d-0916-ea82-ec5cb2808710",
              "parentNodeId": "d03147c3-addb-ef93-5e6c-50f6543883dd"
            },
            "62a0c7c3-5501-0f07-afec-777b927b6ee4": {
              "id": "62a0c7c3-5501-0f07-afec-777b927b6ee4",
              "parentNodeId": "d03147c3-addb-ef93-5e6c-50f6543883dd"
            },
            "83aea8d8-a1e6-0a0b-2b19-be815fc36e27": {
              "id": "83aea8d8-a1e6-0a0b-2b19-be815fc36e27",
              "parentNodeId": ""
            },
            "9ccef593-56cd-4438-9e55-bade67c10c54": {
              "id": "9ccef593-56cd-4438-9e55-bade67c10c54",
              "parentNodeId": "d03147c3-addb-ef93-5e6c-50f6543883dd"
            },
            "c5111401-f1a6-8217-c72a-ca17479870c5": {
              "id": "c5111401-f1a6-8217-c72a-ca17479870c5",
              "parentNodeId": "d03147c3-addb-ef93-5e6c-50f6543883dd"
            },
            "d03147c3-addb-ef93-5e6c-50f6543883dd": {
              "id": "d03147c3-addb-ef93-5e6c-50f6543883dd",
              "parentNodeId": ""
            },
            "d3260ada-19b3-9439-7c5d-df470e40e029": {
              "id": "d3260ada-19b3-9439-7c5d-df470e40e029",
              "parentNodeId": "d03147c3-addb-ef93-5e6c-50f6543883dd"
            },
            "de3e0af3-3d88-a62d-88c1-aa6496a9e134": {
              "id": "de3e0af3-3d88-a62d-88c1-aa6496a9e134",
              "parentNodeId": "d03147c3-addb-ef93-5e6c-50f6543883dd"
            },
            "e5e2a6f3-311b-e617-055e-f0f169802720": {
              "id": "e5e2a6f3-311b-e617-055e-f0f169802720",
              "parentNodeId": "d03147c3-addb-ef93-5e6c-50f6543883dd"
            }
          }
        },
        "steps": {
          "1d2d6abf-cd20-823c-a9f4-76317247e00a": {
            "nodeId": "1d2d6abf-cd20-823c-a9f4-76317247e00a",
            "name": "No User Artifact",
            "type": "artifact",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "content": "",
              "input": {
                "content": "## Result\n\nThe disable user action was skipped because the user did not exist in Active Directory/LDAP during the job's execution.\n\n{{#if [d03147c3-addb-ef93-5e6c-50f6543883dd].[$item].[distinguishedName]}}\nDN: {{[d03147c3-addb-ef93-5e6c-50f6543883dd].[$item].[distinguishedName]}}\n{{/if}}\n{{#if [d03147c3-addb-ef93-5e6c-50f6543883dd].[$item].[name]}}\nName: {{[d03147c3-addb-ef93-5e6c-50f6543883dd].[$item].[name]}}\n{{/if}}"
              },
              "type": "markdown"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "defaultImageData": "https://us.cdn-assets.connect.insight.rapid7.com/step-type-icons/artifact.svg",
            "connectionType": "NONE"
          },
          "2b1a2862-37c0-752f-9518-1018649cb536": {
            "nodeId": "2b1a2862-37c0-752f-9518-1018649cb536",
            "name": "Distinguished Name Found in AD?",
            "type": "automated_decision",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "defaultEdgeId": "4c8eaaa0-001a-510a-c5ee-c33eba26a2c6",
              "stepControlParams": [
                {
                  "description": "Exactly one entry is returned from the distinguished name query.",
                  "edgeId": "aec2c439-a088-d565-6b20-9d66df45be9e",
                  "expression": {
                    "left": {
                      "args": [
                        {
                          "name": "9ccef593-56cd-4438-9e55-bade67c10c54.results",
                          "type": "variable"
                        }
                      ],
                      "name": "length",
                      "type": "function"
                    },
                    "op": "==",
                    "right": {
                      "type": "literal",
                      "value": 1
                    },
                    "type": "binary"
                  },
                  "expressionText": "length({{[9ccef593-56cd-4438-9e55-bade67c10c54].[results]}}) == 1",
                  "name": "Yes",
                  "nodeId": "558dc7c5-4d7d-0916-ea82-ec5cb2808710"
                },
                {
                  "description": "No",
                  "edgeId": "4c8eaaa0-001a-510a-c5ee-c33eba26a2c6",
                  "expression": {},
                  "expressionText": "",
                  "name": "No",
                  "nodeId": "1d2d6abf-cd20-823c-a9f4-76317247e00a"
                }
              ]
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "defaultImageData": "https://us.cdn-assets.connect.insight.rapid7.com/step-type-icons/automated-decision.svg",
            "connectionType": "NONE"
          },
          "3e895203-7cc2-65fe-2973-3f8e4cafcc0e": {
            "nodeId": "3e895203-7cc2-65fe-2973-3f8e4cafcc0e",
            "name": "Alert Artifact",
            "type": "artifact",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "content": "",
              "input": {
                "content": "## Alert\n{{#if [83aea8d8-a1e6-0a0b-2b19-be815fc36e27].[description]}}\nDescription: {{[83aea8d8-a1e6-0a0b-2b19-be815fc36e27].[description]}}\n{{/if}}\n{{#if [83aea8d8-a1e6-0a0b-2b19-be815fc36e27].[investigationId]}}\nInvestigation ID: {{[83aea8d8-a1e6-0a0b-2b19-be815fc36e27].[investigationId]}}\n{{/if}}\n{{#if [83aea8d8-a1e6-0a0b-2b19-be815fc36e27].[name]}}\nName: {{[83aea8d8-a1e6-0a0b-2b19-be815fc36e27].[name]}}\n{{/if}}\n{{#if [83aea8d8-a1e6-0a0b-2b19-be815fc36e27].[link]}}\nLink: [{{[83aea8d8-a1e6-0a0b-2b19-be815fc36e27].[link]}}]({{[83aea8d8-a1e6-0a0b-2b19-be815fc36e27].[link]}})\n{{/if}}\n{{#if [83aea8d8-a1e6-0a0b-2b19-be815fc36e27].[timestamp]}}\nTimestamp: {{[83aea8d8-a1e6-0a0b-2b19-be815fc36e27].[timestamp]}}\n{{/if}}\n{{#if [83aea8d8-a1e6-0a0b-2b19-be815fc36e27].[type]}}\nType: {{[83aea8d8-a1e6-0a0b-2b19-be815fc36e27].[type]}}\n{{/if}}\n{{#if [83aea8d8-a1e6-0a0b-2b19-be815fc36e27].[actors].[users]}}\n{{#each [83aea8d8-a1e6-0a0b-2b19-be815fc36e27].[actors].[users]}}\n{{#if distinguishedName}}\nActor Users: {{distinguishedName}}\n{{/if}}\n{{/each}}\n{{/if}}"
              },
              "type": "markdown"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "defaultImageData": "https://us.cdn-assets.connect.insight.rapid7.com/step-type-icons/artifact.svg",
            "connectionType": "NONE"
          },
          "480b4c67-001b-b55d-6256-c53ba5a9c11d": {
            "nodeId": "480b4c67-001b-b55d-6256-c53ba5a9c11d",
            "name": "Distinguished Name Exists?",
            "type": "automated_decision",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "defaultEdgeId": "27342530-0443-2146-e645-8c948e2be01c",
              "stepControlParams": [
                {
                  "description": "Yes",
                  "edgeId": "27342530-0443-2146-e645-8c948e2be01c",
                  "expression": {},
                  "expressionText": "",
                  "name": "Yes",
                  "nodeId": "62a0c7c3-5501-0f07-afec-777b927b6ee4"
                },
                {
                  "description": "No",
                  "edgeId": "af0baea9-6b64-c0a1-ee3a-781b2db4cac4",
                  "expression": {
                    "left": {
                      "args": [
                        {
                          "name": "d03147c3-addb-ef93-5e6c-50f6543883dd.$item.distinguishedName",
                          "type": "variable"
                        }
                      ],
                      "name": "length",
                      "type": "function"
                    },
                    "op": "=",
                    "right": {
                      "type": "literal",
                      "value": 0
                    },
                    "type": "binary"
                  },
                  "expressionText": "length({{[d03147c3-addb-ef93-5e6c-50f6543883dd].[$item].[distinguishedName]}}) = 0",
                  "name": "No",
                  "nodeId": "e5e2a6f3-311b-e617-055e-f0f169802720"
                }
              ]
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "defaultImageData": "https://us.cdn-assets.connect.insight.rapid7.com/step-type-icons/automated-decision.svg",
            "connectionType": "NONE"
          },
          "558dc7c5-4d7d-0916-ea82-ec5cb2808710": {
            "nodeId": "558dc7c5-4d7d-0916-ea82-ec5cb2808710",
            "name": "Disable User Artifact?",
            "type": "artifact",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "content": "",
              "input": {
                "content": "Disable User: {{[d03147c3-addb-ef93-5e6c-50f6543883dd].[$item].[distinguishedName]}}"
              },
              "type": "markdown"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "defaultImageData": "https://us.cdn-assets.connect.insight.rapid7.com/step-type-icons/artifact.svg",
            "connectionType": "NONE"
          },
          "62a0c7c3-5501-0f07-afec-777b927b6ee4": {
            "nodeId": "62a0c7c3-5501-0f07-afec-777b927b6ee4",
            "name": "Match Search Base",
            "type": "pattern_match",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "captureAll": false,
              "expressionText": "{{search_base:/dc=.*/}}",
              "expressions": [
                {
                  "type": "variable",
                  "value": {
                    "ident": "search_base",
                    "regex": "dc=.*"
                  }
                }
              ],
              "ignoreCase": true,
              "input": "{{[d03147c3-addb-ef93-5e6c-50f6543883dd].[$item].[distinguishedName]}}"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "defaultImageData": "https://us.cdn-assets.connect.insight.rapid7.com/step-type-icons/pattern-match.svg",
            "connectionType": "NONE"
          },
          "83aea8d8-a1e6-0a0b-2b19-be815fc36e27": {
            "nodeId": "83aea8d8-a1e6-0a0b-2b19-be815fc36e27",
            "name": "InsightIDR Event",
            "type": "trigger",
            "continueOnFailure": false,
            "isDisabled": false,
            "triggerId": "9b1faa6a-1e2e-49ed-8beb-da95d6bef905",
            "defaultInputJSONSchema": {
              "definitions": {
                "actor": {
                  "properties": {
                    "assets": {
                      "description": "The assets that are part of the investigation",
                      "items": {
                        "$ref": "#/definitions/asset"
                      },
                      "order": 2,
                      "title": "Assets",
                      "type": "array"
                    },
                    "users": {
                      "description": "The users that are part of the investigation",
                      "items": {
                        "$ref": "#/definitions/user"
                      },
                      "order": 1,
                      "title": "Users",
                      "type": "array"
                    }
                  },
                  "title": "Actor",
                  "type": "object"
                },
                "asset": {
                  "properties": {
                    "fqdn": {
                      "description": "The fully qualified domain name",
                      "order": 2,
                      "title": "Fqdn",
                      "type": "string"
                    },
                    "shortname": {
                      "description": "shortname of the asset",
                      "order": 1,
                      "title": "Shortname",
                      "type": "string"
                    }
                  },
                  "required": [
                    "shortname"
                  ],
                  "title": "Asset",
                  "type": "object"
                },
                "user": {
                  "properties": {
                    "distinguishedName": {
                      "description": "The Active Directory distinguished name of the user",
                      "order": 2,
                      "title": "DistinguishedName",
                      "type": "string"
                    },
                    "emails": {
                      "description": "The email addresses associated with the user",
                      "items": {
                        "type": "string"
                      },
                      "order": 3,
                      "title": "Emails",
                      "type": "array"
                    },
                    "name": {
                      "description": "The name of the user, as '<firstname> <lastname>' if available, or account name otherwise",
                      "order": 1,
                      "title": "Name",
                      "type": "string"
                    }
                  },
                  "required": [
                    "name",
                    "emails"
                  ],
                  "title": "User",
                  "type": "object"
                }
              },
              "properties": {
                "actors": {
                  "$ref": "#/definitions/actor",
                  "description": "The insightIDR actors that are part of the investigation",
                  "order": 6,
                  "title": "Actors"
                },
                "description": {
                  "description": "The description of the alert",
                  "order": 4,
                  "title": "Description",
                  "type": "string"
                },
                "investigationId": {
                  "description": "The unique identifier of the investigation",
                  "order": 7,
                  "title": "Investigation ID",
                  "type": "string"
                },
                "link": {
                  "description": "The deep link to the investigation in insightIDR",
                  "order": 5,
                  "title": "Link",
                  "type": "string"
                },
                "name": {
                  "description": "The human-readable name of the alert",
                  "order": 3,
                  "title": "Name",
                  "type": "string"
                },
                "timestamp": {
                  "description": "The time the alert was triggered in ISO 8601 extended timestamp format",
                  "order": 1,
                  "title": "Timestamp",
                  "type": "string"
                },
                "type": {
                  "description": "The type of alert",
                  "order": 2,
                  "title": "Type",
                  "type": "string"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "definitions": {
                "actor": {
                  "properties": {
                    "assets": {
                      "description": "The assets that are part of the investigation",
                      "items": {
                        "$ref": "#/definitions/asset"
                      },
                      "order": 2,
                      "title": "Assets",
                      "type": "array"
                    },
                    "users": {
                      "description": "The users that are part of the investigation",
                      "items": {
                        "$ref": "#/definitions/user"
                      },
                      "order": 1,
                      "title": "Users",
                      "type": "array"
                    }
                  },
                  "title": "Actor",
                  "type": "object"
                },
                "asset": {
                  "properties": {
                    "fqdn": {
                      "description": "The fully qualified domain name",
                      "order": 2,
                      "title": "Fqdn",
                      "type": "string"
                    },
                    "shortname": {
                      "description": "shortname of the asset",
                      "order": 1,
                      "title": "Shortname",
                      "type": "string"
                    }
                  },
                  "required": [
                    "shortname"
                  ],
                  "title": "Asset",
                  "type": "object"
                },
                "user": {
                  "properties": {
                    "distinguishedName": {
                      "description": "The Active Directory distinguished name of the user",
                      "order": 2,
                      "title": "DistinguishedName",
                      "type": "string"
                    },
                    "emails": {
                      "description": "The email addresses associated with the user",
                      "items": {
                        "type": "string"
                      },
                      "order": 3,
                      "title": "Emails",
                      "type": "array"
                    },
                    "name": {
                      "description": "The name of the user, as '<firstname> <lastname>' if available, or account name otherwise",
                      "order": 1,
                      "title": "Name",
                      "type": "string"
                    }
                  },
                  "required": [
                    "name",
                    "emails"
                  ],
                  "title": "User",
                  "type": "object"
                }
              },
              "properties": {
                "actors": {
                  "$ref": "#/definitions/actor",
                  "description": "The insightIDR actors that are part of the investigation",
                  "order": 6,
                  "title": "Actors"
                },
                "description": {
                  "description": "The description of the alert",
                  "order": 4,
                  "title": "Description",
                  "type": "string"
                },
                "investigationId": {
                  "description": "The unique identifier of the investigation",
                  "order": 7,
                  "title": "Investigation ID",
                  "type": "string"
                },
                "link": {
                  "description": "The deep link to the investigation in insightIDR",
                  "order": 5,
                  "title": "Link",
                  "type": "string"
                },
                "name": {
                  "description": "The human-readable name of the alert",
                  "order": 3,
                  "title": "Name",
                  "type": "string"
                },
                "timestamp": {
                  "description": "The time the alert was triggered in ISO 8601 extended timestamp format",
                  "order": 1,
                  "title": "Timestamp",
                  "type": "string"
                },
                "type": {
                  "description": "The type of alert",
                  "order": 2,
                  "title": "Type",
                  "type": "string"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "defaultImageData": "https://us.cdn-assets.connect.insight.rapid7.com/step-type-icons/trigger-api-idr.svg",
            "connectionType": "NONE"
          },
          "9ccef593-56cd-4438-9e55-bade67c10c54": {
            "nodeId": "9ccef593-56cd-4438-9e55-bade67c10c54",
            "name": "Query AD",
            "type": "action",
            "plugin": {
              "name": "Active Directory LDAP",
              "slugVendor": "rapid7",
              "slugName": "active_directory_ldap",
              "slugVersion": "3.2.4",
              "imageData": "https://us.cdn-assets.connect.insight.rapid7.com/icons/rapid7/active_directory_ldap/3.2.4/icon.png"
            },
            "identifier": "query",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "search_base": "{{[62a0c7c3-5501-0f07-afec-777b927b6ee4].[search_base]}}",
                "search_filter": "(distinguishedName={{[d03147c3-addb-ef93-5e6c-50f6543883dd].[$item].[distinguishedName]}})"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "search_base": {
                  "description": "The base of the search request",
                  "order": 2,
                  "title": "Search Base",
                  "type": "string"
                },
                "search_filter": {
                  "description": "The filter of the search request. It must conform to the LDAP filter syntax specified in RFC4515. Example: (accountName=joesmith)",
                  "order": 1,
                  "title": "Search Filter",
                  "type": "string"
                }
              },
              "required": [
                "search_filter",
                "search_base"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "definitions": {
                "result": {
                  "properties": {
                    "attributes": {
                      "order": 1,
                      "title": "Attributes",
                      "type": "object"
                    },
                    "dn": {
                      "order": 2,
                      "title": "Dn",
                      "type": "string"
                    }
                  },
                  "title": "Result",
                  "type": "object"
                }
              },
              "properties": {
                "results": {
                  "description": "Results returned",
                  "items": {
                    "$ref": "#/definitions/result"
                  },
                  "order": 1,
                  "title": "Results",
                  "type": "array"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          },
          "c5111401-f1a6-8217-c72a-ca17479870c5": {
            "nodeId": "c5111401-f1a6-8217-c72a-ca17479870c5",
            "name": "Disable User",
            "type": "action",
            "plugin": {
              "name": "Active Directory LDAP",
              "slugVendor": "rapid7",
              "slugName": "active_directory_ldap",
              "slugVersion": "3.2.4",
              "imageData": "https://us.cdn-assets.connect.insight.rapid7.com/icons/rapid7/active_directory_ldap/3.2.4/icon.png"
            },
            "identifier": "disable_user",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "distinguished_name": "{{[d03147c3-addb-ef93-5e6c-50f6543883dd].[$item].[distinguishedName]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "distinguished_name": {
                  "description": "The distinguished name of the user to disable e.g. CN=user,OU=domain_users,DC=mydomain,DC=com",
                  "order": 1,
                  "title": "Distinguished Name",
                  "type": "string"
                }
              },
              "required": [
                "distinguished_name"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "success": {
                  "description": "Operation status",
                  "order": 1,
                  "title": "Success",
                  "type": "boolean"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          },
          "d03147c3-addb-ef93-5e6c-50f6543883dd": {
            "nodeId": "d03147c3-addb-ef93-5e6c-50f6543883dd",
            "name": "User Loop",
            "type": "loop",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "innerEdgeId": "6669f7fd-58a7-1a16-29fa-56d607a0f84a",
              "nextEdgeId": "019ef001-3980-d9d5-8c65-d828bef63886",
              "repeatCount": 0,
              "repeatDelay": 0,
              "repeatVariable": "[83aea8d8-a1e6-0a0b-2b19-be815fc36e27].[actors].[users]"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "defaultImageData": "https://us.cdn-assets.connect.insight.rapid7.com/step-type-icons/loop.svg",
            "connectionType": "NONE"
          },
          "d3260ada-19b3-9439-7c5d-df470e40e029": {
            "nodeId": "d3260ada-19b3-9439-7c5d-df470e40e029",
            "name": "Disable User?",
            "type": "human_decision",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "defaultEdgeId": "",
              "stepControlParams": [
                {
                  "description": "Yes",
                  "edgeId": "9335864d-7223-8e58-ece1-544be3524ed0",
                  "expression": {},
                  "expressionText": "",
                  "name": "Yes",
                  "nodeId": "c5111401-f1a6-8217-c72a-ca17479870c5"
                },
                {
                  "description": "No",
                  "edgeId": "0ac43670-3f54-7e16-a6b3-29c85f806bc6",
                  "expression": {},
                  "expressionText": "",
                  "name": "No",
                  "nodeId": ""
                }
              ]
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "defaultImageData": "https://us.cdn-assets.connect.insight.rapid7.com/step-type-icons/human-decision.svg",
            "connectionType": "NONE"
          },
          "de3e0af3-3d88-a62d-88c1-aa6496a9e134": {
            "nodeId": "de3e0af3-3d88-a62d-88c1-aa6496a9e134",
            "name": "Disable User Artifact",
            "type": "artifact",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "content": "",
              "input": {
                "content": "##  Result\n{{#if [c5111401-f1a6-8217-c72a-ca17479870c5].[success]}}\nDisabling of user *succeeded*.\n{{else}}\nDisabling of user *failed*. Check the action's output and the account in Active Directory/LDAP\n{{/if}}\n\nDN: {{[d03147c3-addb-ef93-5e6c-50f6543883dd].[$item].[distinguishedName]}}\nUser: {{[d03147c3-addb-ef93-5e6c-50f6543883dd].[$item].[name]}}"
              },
              "type": "markdown"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "defaultImageData": "https://us.cdn-assets.connect.insight.rapid7.com/step-type-icons/artifact.svg",
            "connectionType": "NONE"
          },
          "e5e2a6f3-311b-e617-055e-f0f169802720": {
            "nodeId": "e5e2a6f3-311b-e617-055e-f0f169802720",
            "name": "No Distinguished Name",
            "type": "artifact",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "content": "",
              "input": {
                "content": "## Result\n\nThe disable user action was skipped because the distinguished name did not exist in the event from IDR.\n\n{{#if [d03147c3-addb-ef93-5e6c-50f6543883dd].[$item].[distinguishedName]}}\nDN: {{[d03147c3-addb-ef93-5e6c-50f6543883dd].[$item].[distinguishedName]}}\n{{/if}}\n{{#if [d03147c3-addb-ef93-5e6c-50f6543883dd].[$item].[name]}}\nName: {{[d03147c3-addb-ef93-5e6c-50f6543883dd].[$item].[name]}}\n{{/if}}"
              },
              "type": "markdown"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "defaultImageData": "https://us.cdn-assets.connect.insight.rapid7.com/step-type-icons/artifact.svg",
            "connectionType": "NONE"
          }
        },
        "tags": null,
        "humanCostSeconds": 0,
        "humanCostDisplayUnit": ""
      }
    ],
    "triggers": [
      {
        "id": "9b1faa6a-1e2e-49ed-8beb-da95d6bef905",
        "name": "InsightIDR Event",
        "description": "",
        "input": null,
        "inputJsonSchema": {
          "definitions": {
            "actor": {
              "properties": {
                "assets": {
                  "description": "The assets that are part of the investigation",
                  "items": {
                    "$ref": "#/definitions/asset"
                  },
                  "order": 2,
                  "title": "Assets",
                  "type": "array"
                },
                "users": {
                  "description": "The users that are part of the investigation",
                  "items": {
                    "$ref": "#/definitions/user"
                  },
                  "order": 1,
                  "title": "Users",
                  "type": "array"
                }
              },
              "title": "Actor",
              "type": "object"
            },
            "asset": {
              "properties": {
                "fqdn": {
                  "description": "The fully qualified domain name",
                  "order": 2,
                  "title": "Fqdn",
                  "type": "string"
                },
                "shortname": {
                  "description": "shortname of the asset",
                  "order": 1,
                  "title": "Shortname",
                  "type": "string"
                }
              },
              "required": [
                "shortname"
              ],
              "title": "Asset",
              "type": "object"
            },
            "user": {
              "properties": {
                "distinguishedName": {
                  "description": "The Active Directory distinguished name of the user",
                  "order": 2,
                  "title": "DistinguishedName",
                  "type": "string"
                },
                "emails": {
                  "description": "The email addresses associated with the user",
                  "items": {
                    "type": "string"
                  },
                  "order": 3,
                  "title": "Emails",
                  "type": "array"
                },
                "name": {
                  "description": "The name of the user, as '<firstname> <lastname>' if available, or account name otherwise",
                  "order": 1,
                  "title": "Name",
                  "type": "string"
                }
              },
              "required": [
                "name",
                "emails"
              ],
              "title": "User",
              "type": "object"
            }
          },
          "properties": {
            "actors": {
              "$ref": "#/definitions/actor",
              "description": "The insightIDR actors that are part of the investigation",
              "order": 6,
              "title": "Actors"
            },
            "description": {
              "description": "The description of the alert",
              "order": 4,
              "title": "Description",
              "type": "string"
            },
            "investigationId": {
              "description": "The unique identifier of the investigation",
              "order": 7,
              "title": "Investigation ID",
              "type": "string"
            },
            "link": {
              "description": "The deep link to the investigation in insightIDR",
              "order": 5,
              "title": "Link",
              "type": "string"
            },
            "name": {
              "description": "The human-readable name of the alert",
              "order": 3,
              "title": "Name",
              "type": "string"
            },
            "timestamp": {
              "description": "The time the alert was triggered in ISO 8601 extended timestamp format",
              "order": 1,
              "title": "Timestamp",
              "type": "string"
            },
            "type": {
              "description": "The type of alert",
              "order": 2,
              "title": "Type",
              "type": "string"
            }
          },
          "title": "Variables",
          "type": "object"
        },
        "outputJsonSchema": {
          "definitions": {
            "actor": {
              "properties": {
                "assets": {
                  "description": "The assets that are part of the investigation",
                  "items": {
                    "$ref": "#/definitions/asset"
                  },
                  "order": 2,
                  "title": "Assets",
                  "type": "array"
                },
                "users": {
                  "description": "The users that are part of the investigation",
                  "items": {
                    "$ref": "#/definitions/user"
                  },
                  "order": 1,
                  "title": "Users",
                  "type": "array"
                }
              },
              "title": "Actor",
              "type": "object"
            },
            "asset": {
              "properties": {
                "fqdn": {
                  "description": "The fully qualified domain name",
                  "order": 2,
                  "title": "Fqdn",
                  "type": "string"
                },
                "shortname": {
                  "description": "shortname of the asset",
                  "order": 1,
                  "title": "Shortname",
                  "type": "string"
                }
              },
              "required": [
                "shortname"
              ],
              "title": "Asset",
              "type": "object"
            },
            "user": {
              "properties": {
                "distinguishedName": {
                  "description": "The Active Directory distinguished name of the user",
                  "order": 2,
                  "title": "DistinguishedName",
                  "type": "string"
                },
                "emails": {
                  "description": "The email addresses associated with the user",
                  "items": {
                    "type": "string"
                  },
                  "order": 3,
                  "title": "Emails",
                  "type": "array"
                },
                "name": {
                  "description": "The name of the user, as '<firstname> <lastname>' if available, or account name otherwise",
                  "order": 1,
                  "title": "Name",
                  "type": "string"
                }
              },
              "required": [
                "name",
                "emails"
              ],
              "title": "User",
              "type": "object"
            }
          },
          "properties": {
            "actors": {
              "$ref": "#/definitions/actor",
              "description": "The insightIDR actors that are part of the investigation",
              "order": 6,
              "title": "Actors"
            },
            "description": {
              "description": "The description of the alert",
              "order": 4,
              "title": "Description",
              "type": "string"
            },
            "investigationId": {
              "description": "The unique identifier of the investigation",
              "order": 7,
              "title": "Investigation ID",
              "type": "string"
            },
            "link": {
              "description": "The deep link to the investigation in insightIDR",
              "order": 5,
              "title": "Link",
              "type": "string"
            },
            "name": {
              "description": "The human-readable name of the alert",
              "order": 3,
              "title": "Name",
              "type": "string"
            },
            "timestamp": {
              "description": "The time the alert was triggered in ISO 8601 extended timestamp format",
              "order": 1,
              "title": "Timestamp",
              "type": "string"
            },
            "type": {
              "description": "The type of alert",
              "order": 2,
              "title": "Type",
              "type": "string"
            }
          },
          "title": "Variables",
          "type": "object"
        },
        "tags": [],
        "type": "trigger_api_idr"
      }
    ]
  }
}