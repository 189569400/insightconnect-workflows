{
  "kom": {
    "komandVersion": "1.36.2-0-g46dcf",
    "komFileVersion": "2.0.0",
    "exportedAt": "2019-09-05T03:11:25.529929658Z",
    "workflowVersions": [
      {
        "id": "4dbed955-db81-4eff-922c-9725614d77f0",
        "workflowId": "eca346bd-807c-479b-8647-80bc5ecca66b",
        "name": "Suspend User in Okta",
        "type": "runnable",
        "version": "1.0.0",
        "description": "This workflow suspends a user in Okta from an event in InsightIDR.",
        "tags": [
          "insightidr",
          "okta",
          "containment",
          "deprovision",
          "user"
        ],
        "meta": {
          "idrValidationMode": "ALL",
          "idrWorkflowCategory": "CONTAINMENT",
          "idrOriginalTemplateName": "Suspend User in Okta"
        },
        "graph": {
          "edges": {
            "0706c4ad-4114-b8d7-5c20-ece545c1e95b": {
              "id": "0706c4ad-4114-b8d7-5c20-ece545c1e95b",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "a4a52238-c706-a5a8-fe90-6c2fc7cddf40",
              "toNodeId": "5f95c22a-6fd5-6685-1920-1d009b87795c"
            },
            "1a30b4e3-71b8-7318-14b5-3d67f1365b50": {
              "id": "1a30b4e3-71b8-7318-14b5-3d67f1365b50",
              "name": "",
              "description": "",
              "parentNodeId": "12bbe3cf-7331-5469-a075-b06fd8a97b69",
              "fromNodeId": "9f167ae5-0b3f-376d-ec88-4f0176de6301",
              "toNodeId": "2316b7cc-2f4f-4449-8725-f1ac1e71909a"
            },
            "2b0b4e55-79fc-3123-f731-9fb36407ec20": {
              "id": "2b0b4e55-79fc-3123-f731-9fb36407ec20",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "5f95c22a-6fd5-6685-1920-1d009b87795c",
              "toNodeId": ""
            },
            "3fc3a308-dc5e-1279-9a5a-9e8b5c334647": {
              "id": "3fc3a308-dc5e-1279-9a5a-9e8b5c334647",
              "name": "No",
              "description": "",
              "parentNodeId": "12bbe3cf-7331-5469-a075-b06fd8a97b69",
              "fromNodeId": "bfa080ba-b3a4-fad3-3658-37b9117906d6",
              "toNodeId": "7de869a4-7770-e012-1a57-972e23081eb0"
            },
            "42a39c09-c129-9cd7-5008-49703952f059": {
              "id": "42a39c09-c129-9cd7-5008-49703952f059",
              "name": "Yes",
              "description": "",
              "parentNodeId": "12bbe3cf-7331-5469-a075-b06fd8a97b69",
              "fromNodeId": "cf503053-5132-aeda-a843-b9a6e1cb4dfe",
              "toNodeId": "bfa080ba-b3a4-fad3-3658-37b9117906d6"
            },
            "52eca8df-d844-ca23-21b4-172f5831bedc": {
              "id": "52eca8df-d844-ca23-21b4-172f5831bedc",
              "name": "",
              "description": "",
              "parentNodeId": "12bbe3cf-7331-5469-a075-b06fd8a97b69",
              "fromNodeId": "7de869a4-7770-e012-1a57-972e23081eb0",
              "toNodeId": ""
            },
            "5527aae3-97bd-ac05-99ba-19276585f615": {
              "id": "5527aae3-97bd-ac05-99ba-19276585f615",
              "name": "",
              "description": "",
              "parentNodeId": "5f95c22a-6fd5-6685-1920-1d009b87795c",
              "fromNodeId": "12bbe3cf-7331-5469-a075-b06fd8a97b69",
              "toNodeId": ""
            },
            "57351a10-2c1d-984f-e6a3-e350f1de7c88": {
              "id": "57351a10-2c1d-984f-e6a3-e350f1de7c88",
              "name": "",
              "description": "",
              "parentNodeId": "12bbe3cf-7331-5469-a075-b06fd8a97b69",
              "fromNodeId": "da400fe6-aa25-28c4-019e-1e879a8d6704",
              "toNodeId": ""
            },
            "58ae7104-e7bb-049a-bd04-9d6f8e27b069": {
              "id": "58ae7104-e7bb-049a-bd04-9d6f8e27b069",
              "name": "Yes",
              "description": "",
              "parentNodeId": "12bbe3cf-7331-5469-a075-b06fd8a97b69",
              "fromNodeId": "bfa080ba-b3a4-fad3-3658-37b9117906d6",
              "toNodeId": "9f167ae5-0b3f-376d-ec88-4f0176de6301"
            },
            "6183344a-7d50-b236-fe9b-001224668779": {
              "id": "6183344a-7d50-b236-fe9b-001224668779",
              "name": "No",
              "description": "",
              "parentNodeId": "12bbe3cf-7331-5469-a075-b06fd8a97b69",
              "fromNodeId": "cf503053-5132-aeda-a843-b9a6e1cb4dfe",
              "toNodeId": "da400fe6-aa25-28c4-019e-1e879a8d6704"
            },
            "6f27ff1d-0849-55a3-02d9-07266045e8b6": {
              "id": "6f27ff1d-0849-55a3-02d9-07266045e8b6",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "e5dbf9ae-4dd9-6262-c670-5583a7375b1e",
              "toNodeId": "a4a52238-c706-a5a8-fe90-6c2fc7cddf40"
            },
            "9fad8a53-96d9-d896-a23a-15a7cb445c8e": {
              "id": "9fad8a53-96d9-d896-a23a-15a7cb445c8e",
              "name": "",
              "description": "",
              "parentNodeId": "12bbe3cf-7331-5469-a075-b06fd8a97b69",
              "fromNodeId": "14b94289-2d90-7adc-cec5-8de3a4845b0c",
              "toNodeId": "7a146e2b-b259-a5ff-7469-32aa031f8a2d"
            },
            "b898d3ca-6188-1c1c-109f-2a15c17a3112": {
              "id": "b898d3ca-6188-1c1c-109f-2a15c17a3112",
              "name": "",
              "description": "",
              "parentNodeId": "12bbe3cf-7331-5469-a075-b06fd8a97b69",
              "fromNodeId": "2316b7cc-2f4f-4449-8725-f1ac1e71909a",
              "toNodeId": ""
            },
            "b8e58db0-5440-2255-ba66-f01145709c40": {
              "id": "b8e58db0-5440-2255-ba66-f01145709c40",
              "name": "",
              "description": "",
              "parentNodeId": "12bbe3cf-7331-5469-a075-b06fd8a97b69",
              "fromNodeId": "7a146e2b-b259-a5ff-7469-32aa031f8a2d",
              "toNodeId": "cf503053-5132-aeda-a843-b9a6e1cb4dfe"
            },
            "d11d20dc-21fa-2be5-e55c-ca4663ff5123": {
              "id": "d11d20dc-21fa-2be5-e55c-ca4663ff5123",
              "name": "",
              "description": "",
              "parentNodeId": "12bbe3cf-7331-5469-a075-b06fd8a97b69",
              "fromNodeId": "12bbe3cf-7331-5469-a075-b06fd8a97b69",
              "toNodeId": "14b94289-2d90-7adc-cec5-8de3a4845b0c"
            },
            "e928f5ed-7e5e-69ee-a95f-cc6c5e258d73": {
              "id": "e928f5ed-7e5e-69ee-a95f-cc6c5e258d73",
              "name": "",
              "description": "",
              "parentNodeId": "5f95c22a-6fd5-6685-1920-1d009b87795c",
              "fromNodeId": "5f95c22a-6fd5-6685-1920-1d009b87795c",
              "toNodeId": "12bbe3cf-7331-5469-a075-b06fd8a97b69"
            }
          },
          "nodes": {
            "12bbe3cf-7331-5469-a075-b06fd8a97b69": {
              "id": "12bbe3cf-7331-5469-a075-b06fd8a97b69",
              "parentNodeId": "5f95c22a-6fd5-6685-1920-1d009b87795c"
            },
            "14b94289-2d90-7adc-cec5-8de3a4845b0c": {
              "id": "14b94289-2d90-7adc-cec5-8de3a4845b0c",
              "parentNodeId": "12bbe3cf-7331-5469-a075-b06fd8a97b69"
            },
            "2316b7cc-2f4f-4449-8725-f1ac1e71909a": {
              "id": "2316b7cc-2f4f-4449-8725-f1ac1e71909a",
              "parentNodeId": "12bbe3cf-7331-5469-a075-b06fd8a97b69"
            },
            "5f95c22a-6fd5-6685-1920-1d009b87795c": {
              "id": "5f95c22a-6fd5-6685-1920-1d009b87795c",
              "parentNodeId": ""
            },
            "7a146e2b-b259-a5ff-7469-32aa031f8a2d": {
              "id": "7a146e2b-b259-a5ff-7469-32aa031f8a2d",
              "parentNodeId": "12bbe3cf-7331-5469-a075-b06fd8a97b69"
            },
            "7de869a4-7770-e012-1a57-972e23081eb0": {
              "id": "7de869a4-7770-e012-1a57-972e23081eb0",
              "parentNodeId": "12bbe3cf-7331-5469-a075-b06fd8a97b69"
            },
            "9f167ae5-0b3f-376d-ec88-4f0176de6301": {
              "id": "9f167ae5-0b3f-376d-ec88-4f0176de6301",
              "parentNodeId": "12bbe3cf-7331-5469-a075-b06fd8a97b69"
            },
            "a4a52238-c706-a5a8-fe90-6c2fc7cddf40": {
              "id": "a4a52238-c706-a5a8-fe90-6c2fc7cddf40",
              "parentNodeId": ""
            },
            "bfa080ba-b3a4-fad3-3658-37b9117906d6": {
              "id": "bfa080ba-b3a4-fad3-3658-37b9117906d6",
              "parentNodeId": "12bbe3cf-7331-5469-a075-b06fd8a97b69"
            },
            "cf503053-5132-aeda-a843-b9a6e1cb4dfe": {
              "id": "cf503053-5132-aeda-a843-b9a6e1cb4dfe",
              "parentNodeId": "12bbe3cf-7331-5469-a075-b06fd8a97b69"
            },
            "da400fe6-aa25-28c4-019e-1e879a8d6704": {
              "id": "da400fe6-aa25-28c4-019e-1e879a8d6704",
              "parentNodeId": "12bbe3cf-7331-5469-a075-b06fd8a97b69"
            },
            "e5dbf9ae-4dd9-6262-c670-5583a7375b1e": {
              "id": "e5dbf9ae-4dd9-6262-c670-5583a7375b1e",
              "parentNodeId": ""
            }
          }
        },
        "steps": {
          "12bbe3cf-7331-5469-a075-b06fd8a97b69": {
            "nodeId": "12bbe3cf-7331-5469-a075-b06fd8a97b69",
            "name": "Email Loop",
            "type": "loop",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "innerEdgeId": "d11d20dc-21fa-2be5-e55c-ca4663ff5123",
              "nextEdgeId": "5527aae3-97bd-ac05-99ba-19276585f615",
              "repeatCount": 0,
              "repeatDelay": 0,
              "repeatVariable": "[5f95c22a-6fd5-6685-1920-1d009b87795c].[$item].[emails]"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "defaultImageData": "https://us.cdn-assets.connect.insight.rapid7.com/step-type-icons/loop.svg",
            "connectionType": "NONE"
          },
          "14b94289-2d90-7adc-cec5-8de3a4845b0c": {
            "nodeId": "14b94289-2d90-7adc-cec5-8de3a4845b0c",
            "name": "Get User",
            "type": "action",
            "plugin": {
              "name": "Okta",
              "slugVendor": "rapid7",
              "slugName": "okta",
              "slugVersion": "3.2.0",
              "imageData": "https://us.cdn-assets.connect.insight.rapid7.com/icons/rapid7/okta/3.2.0/icon.png"
            },
            "identifier": "get_user",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "email": "{{[12bbe3cf-7331-5469-a075-b06fd8a97b69].[$item]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "email": {
                  "description": "The email of the user to obtain information about",
                  "order": 1,
                  "title": "Okta User Email",
                  "type": "string"
                }
              },
              "required": [
                "email"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "definitions": {
                "_links": {
                  "properties": {
                    "changePassword": {
                      "$ref": "#/definitions/changePassword",
                      "order": 1,
                      "title": "ChangePassword"
                    },
                    "changeRecoveryQuestion": {
                      "$ref": "#/definitions/changePassword",
                      "order": 2,
                      "title": "ChangeRecoveryQuestion"
                    },
                    "deactivate": {
                      "$ref": "#/definitions/changePassword",
                      "order": 3,
                      "title": "Deactivate"
                    },
                    "expirePassword": {
                      "$ref": "#/definitions/changePassword",
                      "order": 4,
                      "title": "ExpirePassword"
                    },
                    "forgotPassword": {
                      "$ref": "#/definitions/changePassword",
                      "order": 5,
                      "title": "ForgotPassword"
                    },
                    "resetFactors": {
                      "$ref": "#/definitions/changePassword",
                      "order": 6,
                      "title": "ResetFactors"
                    },
                    "resetPassword": {
                      "$ref": "#/definitions/changePassword",
                      "order": 7,
                      "title": "ResetPassword"
                    }
                  },
                  "title": "Links",
                  "type": "object"
                },
                "changePassword": {
                  "properties": {
                    "href": {
                      "order": 1,
                      "title": "Href",
                      "type": "string"
                    }
                  },
                  "title": "ChangePassword",
                  "type": "object"
                },
                "credentials": {
                  "properties": {
                    "password": {
                      "order": 1,
                      "title": "Password",
                      "type": "object"
                    },
                    "provider": {
                      "$ref": "#/definitions/provider",
                      "order": 2,
                      "title": "Provider"
                    },
                    "recovery_question": {
                      "$ref": "#/definitions/recovery_question",
                      "order": 3,
                      "title": "Recovery Question"
                    }
                  },
                  "title": "Credentials",
                  "type": "object"
                },
                "profile": {
                  "properties": {
                    "email": {
                      "order": 1,
                      "title": "Email",
                      "type": "string"
                    },
                    "firstName": {
                      "order": 2,
                      "title": "FirstName",
                      "type": "string"
                    },
                    "lastName": {
                      "order": 3,
                      "title": "LastName",
                      "type": "string"
                    },
                    "login": {
                      "order": 4,
                      "title": "Login",
                      "type": "string"
                    },
                    "mobilePhone": {
                      "order": 5,
                      "title": "MobilePhone",
                      "type": "string"
                    }
                  },
                  "title": "Profile",
                  "type": "object"
                },
                "provider": {
                  "properties": {
                    "name": {
                      "description": "Provider name e.g. OKTA",
                      "order": 2,
                      "title": "Name",
                      "type": "string"
                    },
                    "type": {
                      "description": "Provider type e.g. OKTA",
                      "order": 1,
                      "title": "Type",
                      "type": "string"
                    }
                  },
                  "title": "Provider",
                  "type": "object"
                },
                "recovery_question": {
                  "properties": {
                    "answer": {
                      "description": "Recovery answer e.g. Annie Oakley",
                      "order": 2,
                      "title": "Answer",
                      "type": "string"
                    },
                    "question": {
                      "description": "Recovery question e.g. Who's a major player in the cowboy scene?",
                      "order": 1,
                      "title": "Question",
                      "type": "string"
                    }
                  },
                  "title": "Recovery Question",
                  "type": "object"
                }
              },
              "properties": {
                "_links": {
                  "$ref": "#/definitions/_links",
                  "description": "Links",
                  "order": 7,
                  "title": "Links"
                },
                "activated": {
                  "description": "Activated",
                  "order": 5,
                  "title": "Activated",
                  "type": "string"
                },
                "created": {
                  "description": "Created",
                  "order": 4,
                  "title": "Created",
                  "type": "string"
                },
                "credentials": {
                  "$ref": "#/definitions/credentials",
                  "description": "Credentials",
                  "order": 9,
                  "title": "Credentials"
                },
                "found": {
                  "description": "Whether user was found",
                  "order": 12,
                  "title": "Found User",
                  "type": "boolean"
                },
                "id": {
                  "description": "ID",
                  "order": 10,
                  "title": "ID",
                  "type": "string"
                },
                "lastLogin": {
                  "description": "Last Login",
                  "order": 8,
                  "title": "Last Login",
                  "type": "string"
                },
                "lastUpdated": {
                  "description": "Last Updated",
                  "order": 6,
                  "title": "Last Updated",
                  "type": "string"
                },
                "passwordChanged": {
                  "description": "Password Changed",
                  "order": 3,
                  "title": "Password Changed",
                  "type": "string"
                },
                "profile": {
                  "$ref": "#/definitions/profile",
                  "description": "Profile",
                  "order": 2,
                  "title": "Profile"
                },
                "status": {
                  "description": "Status",
                  "order": 1,
                  "title": "Status",
                  "type": "string"
                },
                "statusChanged": {
                  "description": "Status Changed",
                  "order": 11,
                  "title": "Status Changed",
                  "type": "string"
                }
              },
              "required": [
                "found"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          },
          "2316b7cc-2f4f-4449-8725-f1ac1e71909a": {
            "nodeId": "2316b7cc-2f4f-4449-8725-f1ac1e71909a",
            "name": "Suspend User Artifact",
            "type": "artifact",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "content": "",
              "input": {
                "content": "##  Result\n{{#if [9f167ae5-0b3f-376d-ec88-4f0176de6301].[success]}}\nSuspension of user *succeeded*.\n{{else}}\nSuspension of user *failed*. Check the action's output and the account in Okta.\n{{/if}}\n\nUser: {{[5f95c22a-6fd5-6685-1920-1d009b87795c].[$item].[name]}}\nEmail: {{[12bbe3cf-7331-5469-a075-b06fd8a97b69].[$item]}}\n\n"
              },
              "type": "markdown"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "defaultImageData": "https://us.cdn-assets.connect.insight.rapid7.com/step-type-icons/artifact.svg",
            "connectionType": "NONE"
          },
          "5f95c22a-6fd5-6685-1920-1d009b87795c": {
            "nodeId": "5f95c22a-6fd5-6685-1920-1d009b87795c",
            "name": "User Loop",
            "type": "loop",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "innerEdgeId": "e928f5ed-7e5e-69ee-a95f-cc6c5e258d73",
              "nextEdgeId": "2b0b4e55-79fc-3123-f731-9fb36407ec20",
              "repeatCount": 0,
              "repeatDelay": 0,
              "repeatVariable": "[e5dbf9ae-4dd9-6262-c670-5583a7375b1e].[actors].[users]"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "defaultImageData": "https://us.cdn-assets.connect.insight.rapid7.com/step-type-icons/loop.svg",
            "connectionType": "NONE"
          },
          "7a146e2b-b259-a5ff-7469-32aa031f8a2d": {
            "nodeId": "7a146e2b-b259-a5ff-7469-32aa031f8a2d",
            "name": "Get User Artifact",
            "type": "artifact",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "content": "",
              "input": {
                "content": "## User Information\nUser: {{[5f95c22a-6fd5-6685-1920-1d009b87795c].[$item].[name]}} \nEmail: {{[12bbe3cf-7331-5469-a075-b06fd8a97b69].[$item]}}\n\n## Okta Information for User\nFound User: {{[14b94289-2d90-7adc-cec5-8de3a4845b0c].[found]}}\n{{#if [14b94289-2d90-7adc-cec5-8de3a4845b0c].[found]}}\n{{#if [14b94289-2d90-7adc-cec5-8de3a4845b0c].[activated]}}\nActivation Timestamp: {{[14b94289-2d90-7adc-cec5-8de3a4845b0c].[activated]}}\n{{else}}\nActivation Status: Not available\n{{/if}}\n{{#if [14b94289-2d90-7adc-cec5-8de3a4845b0c].[created]}}\nCreation Timestamp: {{[14b94289-2d90-7adc-cec5-8de3a4845b0c].[created]}}\n{{else}}\nCreation Timestamp: Not available\n{{/if}}\n{{#if [14b94289-2d90-7adc-cec5-8de3a4845b0c].[lastLogin]}}\nLast Login Timestamp: {{[14b94289-2d90-7adc-cec5-8de3a4845b0c].[lastLogin]}}\n{{else}}\nLast Login Timestamp: Not available\n{{/if}}\n{{#if [14b94289-2d90-7adc-cec5-8de3a4845b0c].[lastUpdated]}}\nLast Updated Timestamp: {{[14b94289-2d90-7adc-cec5-8de3a4845b0c].[lastUpdated]}}\n{{else}}\nLast Updated Timestamp: Not available\n{{/if}}\n{{else}}\n{{/if}}"
              },
              "type": "markdown"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "defaultImageData": "https://us.cdn-assets.connect.insight.rapid7.com/step-type-icons/artifact.svg",
            "connectionType": "NONE"
          },
          "7de869a4-7770-e012-1a57-972e23081eb0": {
            "nodeId": "7de869a4-7770-e012-1a57-972e23081eb0",
            "name": "No Suspension Artifact",
            "type": "artifact",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "content": "",
              "input": {
                "content": "## Result\n\nThe suspend a user action was skipped by a human decision during the job's execution.\n\n{{#if [5f95c22a-6fd5-6685-1920-1d009b87795c].[$item].[emails]}}\nEmail: {{[5f95c22a-6fd5-6685-1920-1d009b87795c].[$item].[emails]}}\n{{/if}}\n{{#if [5f95c22a-6fd5-6685-1920-1d009b87795c].[$item].[name]}}\nName: {{[5f95c22a-6fd5-6685-1920-1d009b87795c].[$item].[name]}}\n{{/if}}"
              },
              "type": "markdown"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "defaultImageData": "https://us.cdn-assets.connect.insight.rapid7.com/step-type-icons/artifact.svg",
            "connectionType": "NONE"
          },
          "9f167ae5-0b3f-376d-ec88-4f0176de6301": {
            "nodeId": "9f167ae5-0b3f-376d-ec88-4f0176de6301",
            "name": "Suspend User",
            "type": "action",
            "plugin": {
              "name": "Okta",
              "slugVendor": "rapid7",
              "slugName": "okta",
              "slugVersion": "3.2.0",
              "imageData": "https://us.cdn-assets.connect.insight.rapid7.com/icons/rapid7/okta/3.2.0/icon.png"
            },
            "identifier": "suspend_user",
            "continueOnFailure": true,
            "isDisabled": false,
            "parameters": {
              "input": {
                "email": "{{[12bbe3cf-7331-5469-a075-b06fd8a97b69].[$item]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "email": {
                  "description": "The email of the employee to suspend",
                  "order": 1,
                  "title": "Okta User Email",
                  "type": "string"
                }
              },
              "required": [
                "email"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "email": {
                  "description": "The email of the Okta user",
                  "order": 1,
                  "title": "Okta User Email",
                  "type": "string"
                },
                "success": {
                  "description": "Whether suspension was successful",
                  "order": 3,
                  "title": "Success",
                  "type": "boolean"
                },
                "user_id": {
                  "description": "The user ID of the Okta user",
                  "order": 2,
                  "title": "Okta User ID",
                  "type": "string"
                }
              },
              "required": [
                "success"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          },
          "a4a52238-c706-a5a8-fe90-6c2fc7cddf40": {
            "nodeId": "a4a52238-c706-a5a8-fe90-6c2fc7cddf40",
            "name": "Alert Artifact",
            "type": "artifact",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "content": "",
              "input": {
                "content": "## Alert\n{{#if [e5dbf9ae-4dd9-6262-c670-5583a7375b1e].[description]}}\nDescription: {{[e5dbf9ae-4dd9-6262-c670-5583a7375b1e].[description]}}\n{{/if}}\n{{#if [e5dbf9ae-4dd9-6262-c670-5583a7375b1e].[investigationId]}}\nInvestigation ID: {{[e5dbf9ae-4dd9-6262-c670-5583a7375b1e].[investigationId]}}\n{{/if}}\n{{#if [e5dbf9ae-4dd9-6262-c670-5583a7375b1e].[name]}}\nName: {{[e5dbf9ae-4dd9-6262-c670-5583a7375b1e].[name]}}\n{{/if}}\n{{#if [e5dbf9ae-4dd9-6262-c670-5583a7375b1e].[link]}}\nLink: [{{[e5dbf9ae-4dd9-6262-c670-5583a7375b1e].[link]}}]({{[e5dbf9ae-4dd9-6262-c670-5583a7375b1e].[link]}})\n{{/if}}\n{{#if [e5dbf9ae-4dd9-6262-c670-5583a7375b1e].[timestamp]}}\nTimestamp: {{[e5dbf9ae-4dd9-6262-c670-5583a7375b1e].[timestamp]}}\n{{/if}}\n{{#if [e5dbf9ae-4dd9-6262-c670-5583a7375b1e].[type]}}\nType: {{[e5dbf9ae-4dd9-6262-c670-5583a7375b1e].[type]}}\n{{/if}}\n{{#if [e5dbf9ae-4dd9-6262-c670-5583a7375b1e].[actors].[users]}}\n{{#each [e5dbf9ae-4dd9-6262-c670-5583a7375b1e].[actors].[users]}}\n{{#if emails}}\nActor Users: {{emails}}\n{{/if}}\n{{/each}}\n{{/if}}"
              },
              "type": "markdown"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "defaultImageData": "https://us.cdn-assets.connect.insight.rapid7.com/step-type-icons/artifact.svg",
            "connectionType": "NONE"
          },
          "bfa080ba-b3a4-fad3-3658-37b9117906d6": {
            "nodeId": "bfa080ba-b3a4-fad3-3658-37b9117906d6",
            "name": "Suspend User?",
            "type": "human_decision",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "defaultEdgeId": "",
              "stepControlParams": [
                {
                  "description": "Yes",
                  "edgeId": "58ae7104-e7bb-049a-bd04-9d6f8e27b069",
                  "expression": {},
                  "expressionText": "",
                  "name": "Yes",
                  "nodeId": "9f167ae5-0b3f-376d-ec88-4f0176de6301"
                },
                {
                  "description": "No",
                  "edgeId": "3fc3a308-dc5e-1279-9a5a-9e8b5c334647",
                  "expression": {},
                  "expressionText": "",
                  "name": "No",
                  "nodeId": "7de869a4-7770-e012-1a57-972e23081eb0"
                }
              ]
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "defaultImageData": "https://us.cdn-assets.connect.insight.rapid7.com/step-type-icons/human-decision.svg",
            "connectionType": "NONE"
          },
          "cf503053-5132-aeda-a843-b9a6e1cb4dfe": {
            "nodeId": "cf503053-5132-aeda-a843-b9a6e1cb4dfe",
            "name": "Does User Exist?",
            "type": "automated_decision",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "defaultEdgeId": "6183344a-7d50-b236-fe9b-001224668779",
              "stepControlParams": [
                {
                  "description": "Yes",
                  "edgeId": "42a39c09-c129-9cd7-5008-49703952f059",
                  "expression": {
                    "left": {
                      "name": "14b94289-2d90-7adc-cec5-8de3a4845b0c.found",
                      "type": "variable"
                    },
                    "op": "=",
                    "right": {
                      "type": "literal",
                      "value": true
                    },
                    "type": "binary"
                  },
                  "expressionText": "({{[14b94289-2d90-7adc-cec5-8de3a4845b0c].[found]}} = true)",
                  "name": "Yes",
                  "nodeId": "bfa080ba-b3a4-fad3-3658-37b9117906d6"
                },
                {
                  "description": "No",
                  "edgeId": "6183344a-7d50-b236-fe9b-001224668779",
                  "expression": {},
                  "expressionText": "",
                  "name": "No",
                  "nodeId": "da400fe6-aa25-28c4-019e-1e879a8d6704"
                }
              ]
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "defaultImageData": "https://us.cdn-assets.connect.insight.rapid7.com/step-type-icons/automated-decision.svg",
            "connectionType": "NONE"
          },
          "da400fe6-aa25-28c4-019e-1e879a8d6704": {
            "nodeId": "da400fe6-aa25-28c4-019e-1e879a8d6704",
            "name": "No User Artifact",
            "type": "artifact",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "content": "",
              "input": {
                "content": "## Result\n\nThe suspend a user action was skipped because the user did not exist in Okta during the job's execution.\n\n{{#if [5f95c22a-6fd5-6685-1920-1d009b87795c].[$item].[emails]}}\nEmail: {{[5f95c22a-6fd5-6685-1920-1d009b87795c].[$item].[emails]}}\n{{/if}}\n{{#if [5f95c22a-6fd5-6685-1920-1d009b87795c].[$item].[name]}}\nName: {{[5f95c22a-6fd5-6685-1920-1d009b87795c].[$item].[name]}}\n{{/if}}"
              },
              "type": "markdown"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "defaultImageData": "https://us.cdn-assets.connect.insight.rapid7.com/step-type-icons/artifact.svg",
            "connectionType": "NONE"
          },
          "e5dbf9ae-4dd9-6262-c670-5583a7375b1e": {
            "nodeId": "e5dbf9ae-4dd9-6262-c670-5583a7375b1e",
            "name": "InsightIDR Event",
            "type": "trigger",
            "continueOnFailure": false,
            "isDisabled": false,
            "triggerId": "9b1faa6a-1e2e-49ed-8beb-da95d6bef905",
            "defaultInputJSONSchema": {
              "definitions": {
                "actor": {
                  "properties": {
                    "assets": {
                      "description": "The assets that are part of the investigation",
                      "items": {
                        "$ref": "#/definitions/asset"
                      },
                      "order": 2,
                      "title": "Assets",
                      "type": "array"
                    },
                    "users": {
                      "description": "The users that are part of the investigation",
                      "items": {
                        "$ref": "#/definitions/user"
                      },
                      "order": 1,
                      "title": "Users",
                      "type": "array"
                    }
                  },
                  "title": "Actor",
                  "type": "object"
                },
                "asset": {
                  "properties": {
                    "fqdn": {
                      "description": "The fully qualified domain name",
                      "order": 2,
                      "title": "Fqdn",
                      "type": "string"
                    },
                    "shortname": {
                      "description": "shortname of the asset",
                      "order": 1,
                      "title": "Shortname",
                      "type": "string"
                    }
                  },
                  "required": [
                    "shortname"
                  ],
                  "title": "Asset",
                  "type": "object"
                },
                "user": {
                  "properties": {
                    "distinguishedName": {
                      "description": "The Active Directory distinguished name of the user",
                      "order": 2,
                      "title": "DistinguishedName",
                      "type": "string"
                    },
                    "emails": {
                      "description": "The email addresses associated with the user",
                      "items": {
                        "type": "string"
                      },
                      "order": 3,
                      "title": "Emails",
                      "type": "array"
                    },
                    "name": {
                      "description": "The name of the user, as '<firstname> <lastname>' if available, or account name otherwise",
                      "order": 1,
                      "title": "Name",
                      "type": "string"
                    }
                  },
                  "required": [
                    "name",
                    "emails"
                  ],
                  "title": "User",
                  "type": "object"
                }
              },
              "properties": {
                "actors": {
                  "$ref": "#/definitions/actor",
                  "description": "The insightIDR actors that are part of the investigation",
                  "order": 6,
                  "title": "Actors"
                },
                "description": {
                  "description": "The description of the alert",
                  "order": 4,
                  "title": "Description",
                  "type": "string"
                },
                "investigationId": {
                  "description": "The unique identifier of the investigation",
                  "order": 7,
                  "title": "Investigation ID",
                  "type": "string"
                },
                "link": {
                  "description": "The deep link to the investigation in insightIDR",
                  "order": 5,
                  "title": "Link",
                  "type": "string"
                },
                "name": {
                  "description": "The human-readable name of the alert",
                  "order": 3,
                  "title": "Name",
                  "type": "string"
                },
                "timestamp": {
                  "description": "The time the alert was triggered in ISO 8601 extended timestamp format",
                  "order": 1,
                  "title": "Timestamp",
                  "type": "string"
                },
                "type": {
                  "description": "The type of alert",
                  "order": 2,
                  "title": "Type",
                  "type": "string"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "definitions": {
                "actor": {
                  "properties": {
                    "assets": {
                      "description": "The assets that are part of the investigation",
                      "items": {
                        "$ref": "#/definitions/asset"
                      },
                      "order": 2,
                      "title": "Assets",
                      "type": "array"
                    },
                    "users": {
                      "description": "The users that are part of the investigation",
                      "items": {
                        "$ref": "#/definitions/user"
                      },
                      "order": 1,
                      "title": "Users",
                      "type": "array"
                    }
                  },
                  "title": "Actor",
                  "type": "object"
                },
                "asset": {
                  "properties": {
                    "fqdn": {
                      "description": "The fully qualified domain name",
                      "order": 2,
                      "title": "Fqdn",
                      "type": "string"
                    },
                    "shortname": {
                      "description": "shortname of the asset",
                      "order": 1,
                      "title": "Shortname",
                      "type": "string"
                    }
                  },
                  "required": [
                    "shortname"
                  ],
                  "title": "Asset",
                  "type": "object"
                },
                "user": {
                  "properties": {
                    "distinguishedName": {
                      "description": "The Active Directory distinguished name of the user",
                      "order": 2,
                      "title": "DistinguishedName",
                      "type": "string"
                    },
                    "emails": {
                      "description": "The email addresses associated with the user",
                      "items": {
                        "type": "string"
                      },
                      "order": 3,
                      "title": "Emails",
                      "type": "array"
                    },
                    "name": {
                      "description": "The name of the user, as '<firstname> <lastname>' if available, or account name otherwise",
                      "order": 1,
                      "title": "Name",
                      "type": "string"
                    }
                  },
                  "required": [
                    "name",
                    "emails"
                  ],
                  "title": "User",
                  "type": "object"
                }
              },
              "properties": {
                "actors": {
                  "$ref": "#/definitions/actor",
                  "description": "The insightIDR actors that are part of the investigation",
                  "order": 6,
                  "title": "Actors"
                },
                "description": {
                  "description": "The description of the alert",
                  "order": 4,
                  "title": "Description",
                  "type": "string"
                },
                "investigationId": {
                  "description": "The unique identifier of the investigation",
                  "order": 7,
                  "title": "Investigation ID",
                  "type": "string"
                },
                "link": {
                  "description": "The deep link to the investigation in insightIDR",
                  "order": 5,
                  "title": "Link",
                  "type": "string"
                },
                "name": {
                  "description": "The human-readable name of the alert",
                  "order": 3,
                  "title": "Name",
                  "type": "string"
                },
                "timestamp": {
                  "description": "The time the alert was triggered in ISO 8601 extended timestamp format",
                  "order": 1,
                  "title": "Timestamp",
                  "type": "string"
                },
                "type": {
                  "description": "The type of alert",
                  "order": 2,
                  "title": "Type",
                  "type": "string"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "defaultImageData": "https://us.cdn-assets.connect.insight.rapid7.com/step-type-icons/trigger-api-idr.svg",
            "connectionType": "NONE"
          }
        },
        "tags": null,
        "humanCostSeconds": 0,
        "humanCostDisplayUnit": ""
      }
    ],
    "triggers": [
      {
        "id": "9b1faa6a-1e2e-49ed-8beb-da95d6bef905",
        "name": "InsightIDR Event",
        "description": "",
        "input": null,
        "inputJsonSchema": {
          "definitions": {
            "actor": {
              "properties": {
                "assets": {
                  "description": "The assets that are part of the investigation",
                  "items": {
                    "$ref": "#/definitions/asset"
                  },
                  "order": 2,
                  "title": "Assets",
                  "type": "array"
                },
                "users": {
                  "description": "The users that are part of the investigation",
                  "items": {
                    "$ref": "#/definitions/user"
                  },
                  "order": 1,
                  "title": "Users",
                  "type": "array"
                }
              },
              "title": "Actor",
              "type": "object"
            },
            "asset": {
              "properties": {
                "fqdn": {
                  "description": "The fully qualified domain name",
                  "order": 2,
                  "title": "Fqdn",
                  "type": "string"
                },
                "shortname": {
                  "description": "shortname of the asset",
                  "order": 1,
                  "title": "Shortname",
                  "type": "string"
                }
              },
              "required": [
                "shortname"
              ],
              "title": "Asset",
              "type": "object"
            },
            "user": {
              "properties": {
                "distinguishedName": {
                  "description": "The Active Directory distinguished name of the user",
                  "order": 2,
                  "title": "DistinguishedName",
                  "type": "string"
                },
                "emails": {
                  "description": "The email addresses associated with the user",
                  "items": {
                    "type": "string"
                  },
                  "order": 3,
                  "title": "Emails",
                  "type": "array"
                },
                "name": {
                  "description": "The name of the user, as '<firstname> <lastname>' if available, or account name otherwise",
                  "order": 1,
                  "title": "Name",
                  "type": "string"
                }
              },
              "required": [
                "name",
                "emails"
              ],
              "title": "User",
              "type": "object"
            }
          },
          "properties": {
            "actors": {
              "$ref": "#/definitions/actor",
              "description": "The insightIDR actors that are part of the investigation",
              "order": 6,
              "title": "Actors"
            },
            "description": {
              "description": "The description of the alert",
              "order": 4,
              "title": "Description",
              "type": "string"
            },
            "investigationId": {
              "description": "The unique identifier of the investigation",
              "order": 7,
              "title": "Investigation ID",
              "type": "string"
            },
            "link": {
              "description": "The deep link to the investigation in insightIDR",
              "order": 5,
              "title": "Link",
              "type": "string"
            },
            "name": {
              "description": "The human-readable name of the alert",
              "order": 3,
              "title": "Name",
              "type": "string"
            },
            "timestamp": {
              "description": "The time the alert was triggered in ISO 8601 extended timestamp format",
              "order": 1,
              "title": "Timestamp",
              "type": "string"
            },
            "type": {
              "description": "The type of alert",
              "order": 2,
              "title": "Type",
              "type": "string"
            }
          },
          "title": "Variables",
          "type": "object"
        },
        "outputJsonSchema": {
          "definitions": {
            "actor": {
              "properties": {
                "assets": {
                  "description": "The assets that are part of the investigation",
                  "items": {
                    "$ref": "#/definitions/asset"
                  },
                  "order": 2,
                  "title": "Assets",
                  "type": "array"
                },
                "users": {
                  "description": "The users that are part of the investigation",
                  "items": {
                    "$ref": "#/definitions/user"
                  },
                  "order": 1,
                  "title": "Users",
                  "type": "array"
                }
              },
              "title": "Actor",
              "type": "object"
            },
            "asset": {
              "properties": {
                "fqdn": {
                  "description": "The fully qualified domain name",
                  "order": 2,
                  "title": "Fqdn",
                  "type": "string"
                },
                "shortname": {
                  "description": "shortname of the asset",
                  "order": 1,
                  "title": "Shortname",
                  "type": "string"
                }
              },
              "required": [
                "shortname"
              ],
              "title": "Asset",
              "type": "object"
            },
            "user": {
              "properties": {
                "distinguishedName": {
                  "description": "The Active Directory distinguished name of the user",
                  "order": 2,
                  "title": "DistinguishedName",
                  "type": "string"
                },
                "emails": {
                  "description": "The email addresses associated with the user",
                  "items": {
                    "type": "string"
                  },
                  "order": 3,
                  "title": "Emails",
                  "type": "array"
                },
                "name": {
                  "description": "The name of the user, as '<firstname> <lastname>' if available, or account name otherwise",
                  "order": 1,
                  "title": "Name",
                  "type": "string"
                }
              },
              "required": [
                "name",
                "emails"
              ],
              "title": "User",
              "type": "object"
            }
          },
          "properties": {
            "actors": {
              "$ref": "#/definitions/actor",
              "description": "The insightIDR actors that are part of the investigation",
              "order": 6,
              "title": "Actors"
            },
            "description": {
              "description": "The description of the alert",
              "order": 4,
              "title": "Description",
              "type": "string"
            },
            "investigationId": {
              "description": "The unique identifier of the investigation",
              "order": 7,
              "title": "Investigation ID",
              "type": "string"
            },
            "link": {
              "description": "The deep link to the investigation in insightIDR",
              "order": 5,
              "title": "Link",
              "type": "string"
            },
            "name": {
              "description": "The human-readable name of the alert",
              "order": 3,
              "title": "Name",
              "type": "string"
            },
            "timestamp": {
              "description": "The time the alert was triggered in ISO 8601 extended timestamp format",
              "order": 1,
              "title": "Timestamp",
              "type": "string"
            },
            "type": {
              "description": "The type of alert",
              "order": 2,
              "title": "Type",
              "type": "string"
            }
          },
          "title": "Variables",
          "type": "object"
        },
        "tags": [],
        "type": "trigger_api_idr"
      }
    ]
  }
}