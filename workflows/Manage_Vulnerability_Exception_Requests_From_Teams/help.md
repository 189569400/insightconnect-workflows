# Description

Push new vulnerability exception requests to a Microsoft Teams channel for expedited decision-making and response. Vulnerability risk data, exclusion submitter comments, expiration dates, and more details are included in the message to provide contextual details to the reviewer without the need to log into the InsightVM Console. This workflow can also be used to automatically approve vulnerability exception requests below a certain CVSS risk score threshold.

# Key Features

* Receive Microsoft Teams messages immediately upon a user submitting a new vulnerability exception
* Review vulnerability exception details in chat
* Link directly to approve or reject the exception request in InsightVM

# Requirements

* InsightVM or Nexpose license
* InsightConnect license
* [Microsoft Teams](https://insightconnect.help.rapid7.com/docs/microsoft-teams)

# Documentation

## Setup

Import the workflow from the Rapid7 Extension Library and proceed through the Import Workflow wizard in InsightConnect. Import plugins, create or select connections, and rename the workflow as a part of the Import Workflow wizard as necessary.

Once the workflow has been imported, **edit the Settings step to specify the Microsoft Teams team name and channel name to suit your Teams environment!** Edit the input with the preset text of `Your Team` and `Your Channel` in each Teams step in the workflow. Vulnerability exception request messages will be sent to this channel. Also adjust the `auto-threshold` variable to indicate the maximum CVSS score for which vulnerability exception requests will be automatically approved. By default, this workflow will automatically approve vulnerability exception requests for vulnerabilities with a CVSS risk score equal to 0. To ensure no exception requests are approved automatically, set this value to a negative number (eg, -1). 

Once your environmental settings have been applied, activate the workflow. It will trigger upon newly submitted vulnerability exception requests.

NOTE: This workflow will NOT trigger on *re*submitted exception requests at this time. Please rely on conventional methods, such as talking to each other, to manage resubmissions.

## Usage

This workflow will trigger automatically on new vulnerability exception requests in the InsightVM Console.

## Technical Details


|Plugin|Version|Count|
|----|----|--------|
|Rapid7 InsightVM|4.0.0|11|
|Type Converter|1.5.1|1|

## Troubleshooting

_There is no troubleshooting information at this time_

# Version History

* 1.0.0 - Initial workflow

# Links

## References

* [Microsoft Teams](https://insightconnect.help.rapid7.com/docs/microsoft-teams)

